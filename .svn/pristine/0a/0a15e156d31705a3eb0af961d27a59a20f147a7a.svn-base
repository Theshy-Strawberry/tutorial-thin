<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
            PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
            "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- SqlMap定義 -->
<sqlMap namespace="helloworld">
    <insert id="add"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        INSERT INTO TT_HOLIDAY_WRITE1 (
        STARTHOLIDAYDATE,
        ENDHOLIDAYDATE,
        HOLIDAYNAME,
        HOLIDAYID,
         UPDATETIME
        )VALUES(
        #startholidaydate#,
        #endholidaydate#,
        #name#,
        #holidayid#,
        #updatetime#
        )
    </insert>
<select id="holiMaxID"
        resultClass="java.lang.String">
select max(HOLIDAYID+1) from TT_HOLIDAY_WRITE1
    </select>
    <select id="primarykey1" resultClass="java.lang.String">
        select max(HOLIDAYID_ID) from
        (select substr(HOLIDAYID_ID,2) as HOLIDAYID_ID from HOLIDAYID_ID) order
        by HOLIDAYID_ID desc
        </select>

         <select id="getSeekSelect1"
            resultClass="java.lang.String">
         select  ENTRY_TIME as entry_time
        from TT_PERSONAL_BASIC_INFO
        where  JN_CARD=#jn_card#
     </select>
     <select id="getSeekSelect2"
            resultClass="java.lang.String">
         select  OUT_TIME as out_time
        from TT_PERSONAL_BASIC_INFO
        where  JN_CARD=#jn_card#
     </select>

     <select id="s1"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekOutput">
        select substr(c.ymd,9,2) AS dt, c.JN_CARD AS jn_card,c.START_TIME as start_time,c.END_TIME as end_time from(
        select  A.JN_CARD,A.ymd,tam.START_TIME,tam.END_TIME from(
        select * from (
        select HIDUKE as ymd ,tam.JN_CARD as JN_CARD
        from TT_ATTENCE_manager tam
        UNion
        select TLD.LEAVE_YMD as ymd,TLM.JN_CARD as JN_CARD
        from TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        )
        order by JN_CARD,ymd
        )A
        left join TT_ATTENCE_manager tam
        on A.JN_CARD  = tam.JN_CARD
        and A.ymd = tam.HIDUKE
        ) c

        <dynamic prepend="WHERE">
        C.JN_CARD=#jn_card#
        <isNotEmpty property="yymm">
                and c.ymd like
                '%$yymm$%'
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="s2" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekOutput">
        SELECT
        TTLM.JN_CARD AS jn_card ,
        TTLM.NAME AS name,
        substr(to_char(TTLM.LEAVE_STARTTIME,'yyyy/mm/dd hh24:mi:ss'),9,2) AS dt,
        substr(to_char(TTLM.LEAVE_ENDTIME,'yyyy/mm/dd hh24:mi:ss'),9,2) AS dt_end,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy/mm/dd hh24:mi:ss') AS leaveStartTime,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy/mm/dd hh24:mi:ss') AS leaveEndTime,
        TC.KJ_NAME AS leaveType
        FROM
        TT_LEAVE_MANAGER TTLM
        LEFT JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        LEFT JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE AND TC.CD_KUBUN='A5'
        LEFT JOIN TT_CODE TCW
        ON
        TTAS.EXAMINE_STATUS = TCW.CD_CODE AND TCW.CD_KUBUN='B2'
        RIGHT JOIN (SELECT DISTINCT LEAVE_ID FROM TT_LEAVE_DETAIL) TTCE ON TTCE.LEAVE_ID=TTLM.LEAVE_ID
       <dynamic prepend="WHERE">
        TTLM.JN_CARD=#jn_card#
        <isNotEmpty property="yymm">
             and(TO_CHAR(TTLM.LEAVE_STARTTIME,'YYYY/MM') &lt;=#yymm#
            and TO_CHAR(TTLM.LEAVE_ENDTIME,'YYYY/MM') &gt;=#yymm# )
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="s3" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT USER_NAME FROM TT_SYS_USER WHERE USER_ID=#jn_card#
    </select>
    <select id="s4"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekOutput">
         SELECT HOLIDAYNAME as holiday_name,
         STARTHOLIDAYDATE as holiday_start_time,
         ENDHOLIDAYDATE as holiday_end_time FROM
        TT_HOLIDAY_WRITE1
        <dynamic prepend="WHERE">
        <isNotEmpty property="yymm">
                STARTHOLIDAYDATE like
                '%$yymm$%'
        </isNotEmpty>
        <isNotEmpty property="yymm">
            or  ENDHOLIDAYDATE like
                '%$yymm$%'
        </isNotEmpty>
        </dynamic>
    </select>
        <select id="s5"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekOutput">
       SELECT
        TTLM.EXTRA_TIME AS extra_time,
        substr(to_char(TTLM.EXTRA_STARTTIME,'yyyy/mm/dd hh24:mi:ss'),9,2) AS dt,
        substr(to_char(TTLM.EXTRA_ENDTIME,'yyyy/mm/dd hh24:mi:ss'),9,2) AS dt_end,
        to_char(TTLM.EXTRA_STARTTIME,'yyyy/mm/dd hh24:mi:ss') as extra_starttime,
        to_char(TTLM.EXTRA_ENDTIME,'yyyy/mm/dd hh24:mi:ss') as extra_endtime,
        TC.KJ_NAME AS extra_type,
        CASE when (list.EXTRA_STARTTIME || "LIST".EXTRA_ENDTIME) IS NULL then 'true' ELSE 'false' END AS extra_state
        FROM
        TT_EXTRA_MANAGEMENT TTLM
                full join (SELECT
        TAMM.END_TIME AS END_time,
        TAMM.START_TIME AS START_time,
        TTLMM.EXTRA_TIME AS extra_time,
        TTLMM.EXTRA_STARTTIME as extra_starttime,
        TTLMM.EXTRA_ENDTIME as extra_endtime
        FROM
        TT_EXTRA_MANAGEMENT TTLMM
        FULL join TT_ATTENCE_MANAGER TAMM
        on TTLMM.USER_ID = TAMM.JN_CARD and to_char(TTLMM.EXTRA_STARTTIME, 'YYYY/MM/DD') = TAMM.HIDUKE
        where (TO_CHAR(TTLMM.EXTRA_STARTTIME,'YYYY/MM') like '%'||#yymm#  OR TO_CHAR(TTLMM.EXTRA_ENDTIME,'YYYY/MM') like '%'||#yymm# )
            AND TTLMM.USER_ID=#jn_card#
            AND TTLMM.EXTRA_AUDITSS='A06'
            AND ((TO_CHAR(TTLMM.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI')  &lt; substr(TAMM.START_TIME,0,16)
                OR substr(TAMM.END_TIME,0,16)  &lt; TO_CHAR(TTLMM.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI'))
                OR(TAMM.END_TIME IS NULL OR TAMM.START_TIME IS NULL)))list
           ON list.EXTRA_STARTTIME=TTLM.EXTRA_STARTTIME
        LEFT JOIN TT_CODE TC
        ON TTLM.EXTRA_TYPE=TC.CD_CODE AND TC.CD_KUBUN='B3'
        where (TO_CHAR(TTLM.EXTRA_STARTTIME,'YYYY/MM') like '%'||#yymm#  OR TO_CHAR(TTLM.EXTRA_ENDTIME,'YYYY/MM') like '%'||#yymm#  )
            AND TTLM.USER_ID=#jn_card#
            AND TTLM.EXTRA_AUDITSS='A06'
    </select>
     <select id="s6" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISeekOutput">
        SELECT
        TTLM.USER_ID AS jn_card,
        TTLM.USER_NAME AS name,
                CASE  WHEN to_char(TTLM.EVECTION_STARTTIME,'yyyy/mm')=#yymm# THEN 'TRUE' ELSE 'FALSE' END AS mm_start,
                CASE  WHEN to_char(TTLM.EVECTION_ENDTIME,'yyyy/mm')=#yymm# THEN 'TRUE' ELSE 'FALSE' END AS mm_end,
        substr(to_char(TTLM.EVECTION_STARTTIME,'yyyy/mm/dd'), 9,2) AS dt,
        substr(to_char(TTLM.EVECTION_ENDTIME,'yyyy/mm/dd '),9,2) AS dt_end,
        to_char(TTLM.EVECTION_STARTTIME,'yyyy/mm/dd ') AS evectionStarttime,
        to_char(TTLM.EVECTION_ENDTIME,'yyyy/mm/dd ') AS evectionEndtime,
        TTLM.EVECTION_DESTINATION AS evectionDestination
        FROM
        TT_EVECTION_DATA TTLM
       <dynamic prepend="WHERE">
        TTLM.USER_ID=#jn_card#
        AND EXAMINE_STATUS LIKE '%A06%'
        <isNotEmpty property="yymm">
           and(TO_CHAR(TTLM.EVECTION_STARTTIME,'YYYY/MM') &lt;=#yymm#
            and TO_CHAR(TTLM.EVECTION_ENDTIME,'YYYY/MM') &gt;=#yymm# )
            </isNotEmpty>
        </dynamic>
    </select>
    <!-- ======================================登録用============================================================== -->
    <select id="login"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginOutput">
        select
        USER_ID as userId
        ,USER_NAME as userName
        ,FL_FUNC_USE
        as flag
        from TT_SYS_USER WHERE USER_ID = #userId# AND USER_PASSWORD =
        #password#
    </select>

    <select id="loginCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput"
        resultClass="java.lang.Integer">
        select COUNT(*) from TT_SYS_USER where USER_ID = #userId#
        AND USER_PASSWORD
        = #password#
    </select>

    <select id="flagName"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput"
        resultClass="java.lang.String">
        select KJ_NAME as flagName from TT_CODE where CD_KUBUN =
        'A0' AND CD_CODE =
        #flag#
    </select>

    <update id="retCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput">
        update TT_SYS_USER
        set KOSHIN_TIMESTAMP = #time#
        ,KOSHIN_USER = #userId#
        ,KOSHIN_PGM = #userId#
        where USER_ID = #userId#
    </update>

    <select id="getPwdinfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginOutput">
        select
        USER_PASSWORD as password
        ,OFFIC_MAIL as sendTo
        from
        TT_SYS_USER TSU
        INNER JOIN TT_PERSONAL_BASIC_INFO TPBI
        ON TSU.USER_ID =
        TPBI.JN_CARD
        where TSU.USER_ID = #userId#
    </select>

    <select id="getPwdCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.LoginInput"
        resultClass="java.lang.Integer">
        select
        COUNT(*)
        from TT_SYS_USER TSU
        INNER JOIN
        TT_PERSONAL_BASIC_INFO TPBI
        ON TSU.USER_ID = TPBI.JN_CARD
        where
        TSU.USER_ID = #userId#
    </select>
    <!-- ======================================登録用============================================================== -->

    <!-- ======================================パスワード修正用============================================================== -->
    <select id="getCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIResetInput"
        resultClass="java.lang.Integer">
        select COUNT(*) from TT_SYS_USER where USER_ID = #userId#
        AND USER_PASSWORD
        = #password1#
    </select>
    <update id="resetPassword"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIResetInput">
        update TT_SYS_USER set USER_PASSWORD = #password2#
        where USER_ID = #userId#
        AND USER_PASSWORD = #password1#
    </update>
    <!-- ======================================パスワード修正用============================================================== -->
    <select id="getSetsubiCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
        resultClass="java.lang.Integer">
        select COUNT(*) from TT_SETSUBI where SETSUBI_NO =
        #setsubi_no#
    </select>
    <select id="selectMaxSetsubiNo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
        resultClass="java.lang.String">
        SELECT MAX(SETSUBI_NO) FROM TT_SETSUBI_HYOU where SETSUBI_SYURUI
        = #setsubi_kuben#
    </select>
   <!--  取得設備型番用-->
    <select id="setsubiKatabanList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectSetsubiKataban">
        SELECT DISTINCT SETSUBI_KATABAN AS setsubi_kataban_key ,
       SETSUBI_KATABAN AS setsubi_kataban_value
       FROM TT_SETSUBIKIHON
      <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="setsubi_kuben">
                and SETSUBI_KUBUN = #setsubi_kuben#
            </isNotEmpty>
        </dynamic>
        </select>
 <!--  取得購入日付用-->
    <select id="setsubiKonyuhiList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectSetsubiKonyuhi">
        SELECT    DISTINCT (to_char(SETSUBI_KONYUHI,'yyyy-mm-dd')) AS setsubi_konyuhi_key ,
                       to_char(SETSUBI_KONYUHI,'yyyy-mm-dd') AS setsubi_konyuhi_value
          FROM    TT_SETSUBIKIHON
      <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="setsubi_kuben">
                and SETSUBI_KUBUN = #setsubi_kuben#
            </isNotEmpty>
            <isNotEmpty property="setsubi_kataban">
                and SETSUBI_KATABAN = #setsubi_kataban#
            </isNotEmpty>
             ORDER BY
            setsubi_konyuhi_key DESC
        </dynamic>
        </select>

    <!-- 設備型番件数用 -->
    <select id="getKatabanCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipKatabanInput"
        resultClass="java.lang.String">
        SELECT COUNT(*) FROM TT_SETSUBIKIHON
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="setsubi_kataban">
                and SETSUBI_KATABAN = #setsubi_kataban#
            </isNotEmpty>
            <isNotEmpty property="kounyu_hiduke">
                and SETSUBI_KONYUHI= #kounyu_hiduke#
            </isNotEmpty>
        </dynamic>
        </select>
    <!-- 設備型番追加用 -->
    <insert id="insertKataban"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipKatabanInput">
        INSERT INTO TT_SETSUBIKIHON (
        SETSUBI_KATABAN,
        SETSUBI_KUBUN,
        SETSUBI_KIKAKU,
        SETSUBI_TANKA,
        SETSUBI_KONYUHI,
        SETSUBI_MAKER,
        SETSUBI_KONYUSYA,
        CPU,
        CPU_HAICHI,
        MEMORI,
        HARDDISK_TOTAL,
        HARDDISK
        )VALUES(
        #setsubi_kataban#,
        #setsubi_kuben#,
        #setsubi_kikaku#,
        #setsubi_tanka#,
        #kounyu_hiduke#,
        #setsubi_maker#,
        #kounyu_user#,
        #host_CPU#,
        #cpu_haichi#,
        #memori#,
        #harddisk_total#,
        #harddisk#
        )

    </insert>
    <!-- 設備追加用 -->
    <insert id="insertSetsubi"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput">
        INSERT INTO TT_SETSUBI_HYOU (
        SETSUBI_NO,
        SETSUBI_SHUNYUKO,
        SYUNYUKO_DATE,
        USER_ID,
        SETSUBI_SYURUI,
        SHUNYU_NO,
        HOKANSHIKI,
        HOKANBASHO,
        YOUTO,
        TANAOROSHI_NO,
        TANAOROSHI_DATE,
        TANAOROSHISYA,
        SETSUBI_JYOUTAI,
        SETSUBI_KATABAN,
        SETSUBI_KONYUHI,
        DEPT_ID,
        MAC_ADDRESS
        )VALUES(
        #setsubi_no#,
        #shunyuko#,
        #shunyuko_date#,
        #userId#,
        #setsubi_kuben#,
        #shunyuko_no#,
        #hokanhoushiki#,
        #hokanbasho#,
        #youto#,
        #setsubi_kanaoroshi_no#,
        #tanaoroshi_hiduke#,
        #tanaoroshi_user#,
        #setsubi_state#,
        #setsubi_kataban#,
        #kounyu_hiduke#,
        #deptId#,
        #mac_address#)
    </insert>
    <update id="EquipEditor"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput">
            update TT_SETSUBI_HYOU
             set
              TANAOROSHI_DATE =#tanaoroshi_hiduke#,
              TANAOROSHI_NO =#setsubi_kanaoroshi_no#,
              TANAOROSHISYA =#tanaoroshi_user#,
              SHUNYU_NO=#shunyuko_no#,
              SYUNYUKO_DATE=#shunyuko_date#,
              HOKANSHIKI=#equipLocation#,
              SETSUBI_NO=#setsubi_no#,
              YOUTO=#youto#
              where SETSUBI_NO = #before_no# and SHUNYU_NO = #before_shunyuko_no#
    </update>

 <update id="EquipEditorReturn"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput">
            update TT_SETSUBI_HYOU
             set
              HOKANSHIKI=#hokanhoushiki#,
              HOKANBASHO=#hokanbasho#,
              SETSUBI_SHUNYUKO=#shunyuko#,
              SHUNYU_NO=#shunyuko_no#,
              USER_ID=#userId#,
              DEPT_ID=#deptId#,
              SHINSEI_NO=null,
              SETSUBI_JYOUTAI='0',
              YOUTO=#youto#
              where SETSUBI_NO = #before_no#
    </update>
    <update id="updateTT_SETSUBI_SHINSEI"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput">
            update TT_SETSUBI_SHINSEI
             set
             SHINSEI_JYOUTAI='2'
              where SETSUBI_NO = #before_no# and  SHINSEI_JYOUTAI='0' and SETSUBI_JYOUTAI='1'
    </update>
<select id="selectSHINSA_NO"
 parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
                resultClass="java.lang.String">
SELECT SHINSA_NO
from
TT_SETSUBI_SHINSEI
WHERE
SETSUBI_NO = #before_no# and  SHINSEI_JYOUTAI='0'  and SETSUBI_JYOUTAI='1'

</select>
<select id="selectzhuangtai"
 parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
                resultClass="java.lang.String">
SELECT SETSUBI_JYOUTAI
from
TT_SETSUBI_HYOU
WHERE
SETSUBI_NO = #before_no# and SHUNYU_NO = #before_shunyuko_no#

</select>
<select id="JNTCIEquip06select"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SETSUBI_NO = #before_no# and  SHINSEI_JYOUTAI='0' and SETSUBI_JYOUTAI='1'
</select>

<update id="updateTT_SETSUBI_SHINSA"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipInsertInput">
 update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B01',SHINSA_HIDUKE=#xttime#,SHINSASYA=#reutrnman# where SHINSA_NO = #mark#
    </update>
    <!-- ==================JNTCIEquipList========================= -->
      <!-- 設備一覧件数用 -->
      <select id="getSetsubiListCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
       resultClass="java.lang.String">
        SELECT COUNT(*)
      FROM TT_SETSUBI_HYOU TSH
      LEFT JOIN TT_CODE TC1 ON TC1.CD_KUBUN='B7' AND TC1.CD_CODE=TSH.SETSUBI_JYOUTAI
      LEFT JOIN TT_CODE TC2 ON TC2.CD_KUBUN='A1' AND TC2.CD_CODE=TSH.DEPT_ID
    <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="code">
                and TSH.SETSUBI_JYOUTAI=#code#
            </isNotEmpty>
            <isNotEmpty property="setsubiKubun">
                and TSH.SETSUBI_SYURUI =#setsubiKubun#
            </isNotEmpty>
            <isNotEmpty property="deptId">
                and TSH.DEPT_ID=#deptId#
            </isNotEmpty>
            <isNotEmpty property="userId">
                and TSH.USER_ID = #userId#
            </isNotEmpty>
        </dynamic>
       </select>
       <!--取得設備一覧  -->
    <select id="getSetsubiList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectListOutput">
       SELECT
        TC1.KJ_NAME AS setsubiJyoutai
        , TSH.SHUNYU_NO AS shunyuNo
        , to_char(TSH.SYUNYUKO_DATE,'yyyy-mm-dd') AS shunyukoDate
        , TSH.USER_ID AS userId
        , TSU.USER_NAME AS userName
        , TSH.DEPT_ID AS deptId
        , TC6.KJ_NAME AS deptName
        , TSH.TANAOROSHI_NO AS tanaoroshiNo
        , TSH.SETSUBI_NO AS setsubiNo
        , TC2.KJ_NAME AS setsubiShurui
        , TC3.KJ_NAME AS hokanshiki
        ,TP1.POSITION_ID AS hokanbasho
        , TC5.KJ_NAME AS youto
        , to_char(TSH.TANAOROSHI_DATE,'yyyy-mm-dd') AS tanaoroshiDate
        , TSH.TANAOROSHISYA AS tanaoroshiSya
        FROM
        TT_SETSUBI_HYOU TSH
        LEFT JOIN TT_CODE TC1
        ON TC1.CD_KUBUN = 'B7'
        AND TC1.CD_CODE = TSH.SETSUBI_JYOUTAI
        LEFT JOIN TT_CODE TC2
        ON TC2.CD_KUBUN = 'B0'
        AND TC2.CD_CODE = TSH.SETSUBI_SYURUI
        LEFT JOIN TT_CODE TC3
        ON TC3.CD_KUBUN = 'B5'
        AND TC3.CD_CODE = TSH.HOKANSHIKI
         LEFT JOIN TT_POSITION TP1
         ON TP1.JN_CARD = TSH.USER_ID
        LEFT JOIN TT_CODE TC5
        ON TC5.CD_KUBUN = 'B6'
        AND TC5.CD_CODE = TSH.YOUTO
        LEFT JOIN TT_SYS_USER TSU
        ON TSU.USER_ID = TSH.USER_ID
        LEFT JOIN TT_CODE TC6
        ON TC6.CD_KUBUN = 'A1'
        AND TC6.CD_CODE = TSH.DEPT_ID
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="code">
                and TSH.SETSUBI_JYOUTAI=#code#
            </isNotEmpty>
            <isNotEmpty property="setsubiKubun">
                and TSH.SETSUBI_SYURUI =#setsubiKubun#
            </isNotEmpty>
            <isNotEmpty property="deptId">
                and TSH.DEPT_ID=#deptId#
            </isNotEmpty>
            <isNotEmpty property="userId">
                and TSH.USER_ID = #userId#
            </isNotEmpty>
        </dynamic>
        ORDER BY
     <!--    TSH.SHUNYU_NO, -->
        <!-- TSH.SYUNYUKO_DATE DESC -->
        shunyukoDate DESC
    </select>
     <!--zxp  -->
   <update id="scrapList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput">
            update TT_SETSUBI_HYOU set USER_ID = '--',SETSUBI_JYOUTAI='2' where SETSUBI_NO = #setsubiNo# AND SHUNYU_NO =#shunyuNo#
    </update>
    <select id="getSetsubiDetail"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectListOutput">
               SELECT
                             TSH.SETSUBI_NO AS setsubiNo
                            , TC2.KJ_NAME AS setsubiShurui
                            , TSH.SETSUBI_KATABAN  AS setsubiKataban
                            , to_char(TSH.SETSUBI_KONYUHI,'yyyy-mm-dd') AS setsubiKonyuhi
                            , TSK.SETSUBI_KIKAKU   AS setsubiKiKaku
                            , TSK.SETSUBI_KUBUN AS setsubiKubun
                            , TSK.SETSUBI_TANKA    AS setsubiTanka
                            , TSK.SETSUBI_MAKER    AS setsubiMaker
                            , TSK.SETSUBI_KONYUSYA AS setsubiKonYusya
                            , TSK.CPU              AS cpu
                            , TC7.KJ_NAME          AS cpuHaichi
                            , TSK.MEMORI           AS memori
                            , TSK.HARDDISK         AS hardDisk
                            , TSK.HARDDISK_TOTAL   AS hardDiskTotal
                            , TSH.MAC_ADDRESS AS mac
                            FROM
                            TT_SETSUBI_HYOU TSH
                            LEFT JOIN TT_CODE TC2
                            ON TC2.CD_KUBUN = 'B0'
                            AND TC2.CD_CODE = TSH.SETSUBI_SYURUI
                            LEFT JOIN TT_CODE TC3
                            ON TC3.CD_KUBUN = 'B5'
                            AND TC3.CD_CODE = TSH.HOKANSHIKI
                            LEFT JOIN TT_CODE TC4
                            ON TC4.CD_KUBUN = 'B5'
                            AND TC4.CD_CODE = TSH.HOKANBASHO
                            LEFT JOIN TT_CODE TC5
                            ON TC5.CD_KUBUN = 'B6'
                            AND TC5.CD_CODE = TSH.YOUTO
                            LEFT JOIN TT_SYS_USER TSU
                            ON TSU.USER_ID = TSH.USER_ID
                            LEFT JOIN TT_CODE TC6
                            ON TC6.CD_KUBUN = 'A1'
                            AND TC6.CD_CODE = TSH.DEPT_ID
                            LEFT JOIN TT_SETSUBIKIHON TSK
                            ON TSH.SETSUBI_KATABAN=TSK.SETSUBI_KATABAN
                            LEFT JOIN TT_CODE TC7
                            ON TC7.CD_KUBUN='B8' AND TC7.CD_CODE=TSK.CPU_HAICHI
                          <dynamic prepend="WHERE ">
                                1=1
                                <isNotEmpty property="setsubiNo">
                                    and TSH.SETSUBI_NO=#setsubiNo#
                                </isNotEmpty>
                                <isNotEmpty property="shunyuNo">
                                    and TSH.SHUNYU_NO =#shunyuNo#
                                </isNotEmpty>
                         </dynamic>
           </select>

    <!-- 检索件数 -->
    <select id="getListCount3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(*)
        FROM
        (
        SELECT DISTINCT
        '設備修理一覧' AS CODE,
        TSAR.APPLY_REPAIR_DEPT_ID AS APPLY_DEPT_ID,
        TSAR.APPLY_REPAIR_DEPT_NAME AS APPLY_DEPT_NAME,
        TSAR.APPLY_REPAIR_USER_ID AS APPLY_USER_ID,
        TSAR.APPLY_REPAIR_USER_NAME AS APPLY_USER_NAME,
        TC1.KJ_NAME AS
        APPLY_SETSUBI_KUBEN,
        TSAR.APPLY_REPAIR_SETSUBI_NO AS APPLY_SETSUBI_NO,
        TC.KJ_NAME AS APPLY_STATE,
        TSAR.APPLY_REPAIR_REASON AS APPLY_REASON,
        null AS KOSHIN_TIMESTAMP
        FROM
        TT_SETSUBI_APPLY_REPAIR TSAR
        LEFT JOIN
        TT_CODE TC1 ON TC1.CD_KUBUN = 'B0' AND
        TSAR.APPLY_REPAIR_SETSUBI_KUBEN
        = TC1.CD_CODE
        LEFT JOIN TT_CODE TC ON TC.CD_KUBUN = 'B4' AND
        TSAR.APPLY_REPAIR_STATE =
        TC.CD_CODE
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="APPLY_DEPT_NAME">
                and APPLY_REPAIR_DEPT_ID =
                #APPLY_DEPT_NAME#
            </isNotEmpty>
            <isNotEmpty property="APPLY_USER_ID">
                and APPLY_REPAIR_USER_ID =
                #APPLY_USER_ID#
            </isNotEmpty>
            <isNotEmpty property="APPLY_SETSUBI_NO">
                and APPLY_REPAIR_SETSUBI_NO =
                #APPLY_SETSUBI_NO#
            </isNotEmpty>
        </dynamic>
        )

    </select>

    <select id="SelectDeptNames"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectDeptName">
        SELECT
        CD_CODE as APPLY_DEPT_ID,
        KJ_NAME as APPLY_DEPT_NAME
        FROM
        TT_CODE
        WHERE CD_KUBUN='A1'
    </select>

    <select id="SelectCode"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectDeptName">
        SELECT
        KJ_NAME as CODE
        FROM
        TT_CODE
        WHERE CD_KUBUN='E0'
    </select>

    <!-- JNTCIEquip04 =============================================== -->
    <!--設備審査件数を取得 -->
    <select id="JNTCIEquip04ChangeStateCount"
               parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
                resultClass="java.lang.Integer">
SELECT FL_FUNC_USE FROM  TT_SYS_USER
WHERE

 USER_ID=#shenqingId#

</select>
<select id="JNTCIEquip04ChangeStateCount1"
               parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
                resultClass="java.lang.Integer">
SELECT FL_FUNC_USE FROM  TT_SYS_USER
WHERE

 USER_ID=#userId#

</select>
<select id="JNTCIEquip0301qufen"
               parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
                resultClass="java.lang.String">
SELECT SHINSEI_KUBUN FROM  TT_SETSUBI_SHINSEI
WHERE
 SHINSEI_NO=#apply_no#

</select>
    <select id="getEquipshinsaCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
        resultClass="java.lang.String">
        SELECT Count(TSS.SHINSA_NO) FROM TT_SETSUBI_SHINSEI TSS
        LEFT JOIN
        TT_SETSUBI_SHINSA TS ON TSS.SHINSA_NO=TS.SHINSA_NO
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="userId">
                and SHINSEI_USER =#userId#
            </isNotEmpty>
            <isNotEmpty property="deptName">
                and SHINSEI_BUMON=#deptName#
            </isNotEmpty>
            <isNotEmpty property="shinsaJyoutai">
                and SHINSA_JYOUTAI =#shinsaJyoutai#
            </isNotEmpty>
            <isNotEmpty property="shinseiStartDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &gt;= #shinseiStartDate#
            </isNotEmpty>
            <isNotEmpty property="shinseiEndDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &lt;= #shinseiEndDate#
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="getEquipshinsaCount1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
        resultClass="java.lang.String">
        SELECT Count(TSS.SHINSA_NO) FROM TT_SETSUBI_SHINSEI TSS
        LEFT JOIN
        TT_SETSUBI_SHINSA TS ON TSS.SHINSA_NO=TS.SHINSA_NO
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="shenqingId">
                and SHINSEI_USER =#shenqingId#
            </isNotEmpty>
            <isNotEmpty property="deptName">
                and SHINSEI_BUMON=#deptName#
            </isNotEmpty>
            <isNotEmpty property="shinsaJyoutai">
                and SHINSA_JYOUTAI =#shinsaJyoutai#
            </isNotEmpty>
            <isNotEmpty property="shinseiStartDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &gt;= #shinseiStartDate#
            </isNotEmpty>
            <isNotEmpty property="shinseiEndDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &lt;= #shinseiEndDate#
            </isNotEmpty>
        </dynamic>
    </select>

<delete id="deleteList0"
             parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input">
         delete from TT_SETSUBI_SHINSEI  where  SHINSEI_NO=#deleteId_card#
    </delete>
<select id="deleteListselected"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SHINSEI_USER = #shenqingId# and SHINSEI_NO=#apply_no#
</select>
    <!--設備審査Listを取得 -->
    <select id="getEquipshinsaList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectSetsubiShinsa">
       SELECT to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') AS shinseiDate,
        TSU3.FL_FUNC_USE AS power,
        TSS.SHINSEI_NO as apply_no,
        TSS.SHINSEI_BUMON AS deptId,
        TC4.KJ_NAME AS deptName,
        TSS.SHINSEI_USER AS userId,
        TSU1.USER_NAME AS userName,
        TC1.KJ_NAME AS shinseiKubun,
        TC2.KJ_NAME AS shinseiJyoutai,
        TSU2.USER_ID AS shinsasyaId,
        TSU2.USER_NAME AS shinsasyaName,
        TC3.KJ_NAME AS shinsaJyoutai,
        TC5.KJ_NAME AS shinsasyurui,
        to_char(TS.SHINSA_HIDUKE,'yyyy-mm-dd') AS shinsaHiduke
        FROM
        TT_SETSUBI_SHINSEI TSS
        LEFT JOIN TT_SETSUBI_SHINSA TS ON
        TSS.SHINSA_NO=TS.SHINSA_NO
        LEFT JOIN TT_SYS_USER TSU1 ON
        TSS.SHINSEI_USER=TSU1.USER_ID
        LEFT JOIN TT_SYS_USER TSU2 ON
        TS.SHINSASYA=TSU2.USER_ID
        LEFT JOIN TT_SYS_USER TSU3 ON
        TSS.SHINSEI_USER=TSU3.USER_ID
        LEFT JOIN TT_CODE TC1 ON TC1.CD_KUBUN='E0'
        AND
        TC1.CD_CODE=TSS.SHINSEI_KUBUN
        LEFT JOIN TT_CODE TC2 ON
        TC2.CD_KUBUN='BA' AND
        TC2.CD_CODE=TSS.SHINSEI_JYOUTAI
        LEFT JOIN TT_CODE
        TC3 ON TC3.CD_KUBUN='B9' AND
        TC3.CD_CODE=TS.SHINSA_JYOUTAI
        LEFT JOIN
        TT_CODE TC4 ON TC4.CD_KUBUN='A1' AND
        TC4.CD_CODE=TSS.SHINSEI_BUMON
        LEFT JOIN
       TT_CODE TC5 ON TC5.CD_CODE=TSS.SETSUBI_KUBUN
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="userId">
                and SHINSEI_USER =#userId#
            </isNotEmpty>
            <isNotEmpty property="deptName">
                and SHINSEI_BUMON=#deptName#
            </isNotEmpty>
            <isNotEmpty property="shinsaJyoutai">
                and SHINSA_JYOUTAI =#shinsaJyoutai#
            </isNotEmpty>
            <isNotEmpty property="shinseiStartDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &gt;= #shinseiStartDate#
            </isNotEmpty>
            <isNotEmpty property="shinseiEndDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &lt;= #shinseiEndDate#
            </isNotEmpty>
         ORDER BY TSS.SHINSEI_JYOUTAI,TSS.SHINSEI_HIDUKE DESC
        </dynamic>
    </select>
    <select id="getEquipshinsaList1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip04Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectSetsubiShinsa">
        SELECT to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') AS shinseiDate,
        TSU3.FL_FUNC_USE AS power,
        TSS.SHINSEI_NO as apply_no,
        TSS.SHINSEI_BUMON AS deptId,
        TC4.KJ_NAME AS deptName,
        TSS.SHINSEI_USER AS userId,
        TSU1.USER_NAME AS userName,
        TC1.KJ_NAME AS shinseiKubun,
        TC2.KJ_NAME AS shinseiJyoutai,
        TSU2.USER_ID AS shinsasyaId,
        TSU2.USER_NAME AS shinsasyaName,
        TC3.KJ_NAME AS shinsaJyoutai,
        TC5.KJ_NAME AS shinsasyurui,
        to_char(TS.SHINSA_HIDUKE,'yyyy-mm-dd') AS shinsaHiduke
        FROM
        TT_SETSUBI_SHINSEI TSS
        LEFT JOIN TT_SETSUBI_SHINSA TS ON
        TSS.SHINSA_NO=TS.SHINSA_NO
        LEFT JOIN TT_SYS_USER TSU1 ON
        TSS.SHINSEI_USER=TSU1.USER_ID
        LEFT JOIN TT_SYS_USER TSU2 ON
        TS.SHINSASYA=TSU2.USER_ID
        LEFT JOIN TT_SYS_USER TSU3 ON
        TSS.SHINSEI_USER=TSU3.USER_ID
        LEFT JOIN TT_CODE TC1 ON TC1.CD_KUBUN='E0'
        AND
        TC1.CD_CODE=TSS.SHINSEI_KUBUN
        LEFT JOIN TT_CODE TC2 ON
        TC2.CD_KUBUN='BA' AND
        TC2.CD_CODE=TSS.SHINSEI_JYOUTAI
        LEFT JOIN TT_CODE
        TC3 ON TC3.CD_KUBUN='B9' AND
        TC3.CD_CODE=TS.SHINSA_JYOUTAI
        LEFT JOIN
        TT_CODE TC4 ON TC4.CD_KUBUN='A1' AND
        TC4.CD_CODE=TSS.SHINSEI_BUMON
        LEFT JOIN
       TT_CODE TC5 ON TC5.CD_CODE=TSS.SETSUBI_KUBUN
        <dynamic prepend="WHERE ">
            1=1
            <isNotEmpty property="shenqingId">
                and SHINSEI_USER =#shenqingId#
            </isNotEmpty>
            <isNotEmpty property="deptName">
                and SHINSEI_BUMON=#deptName#
            </isNotEmpty>
            <isNotEmpty property="shinsaJyoutai">
                and SHINSA_JYOUTAI =#shinsaJyoutai#
            </isNotEmpty>
            <isNotEmpty property="shinseiStartDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &gt;= #shinseiStartDate#
            </isNotEmpty>
            <isNotEmpty property="shinseiEndDate">
                and
                to_char(TSS.SHINSEI_HIDUKE,'yyyy-mm-dd') &lt;= #shinseiEndDate#
            </isNotEmpty>
          ORDER BY TSS.SHINSEI_JYOUTAI,TSS.SHINSEI_HIDUKE DESC
        </dynamic>
    </select>
    <!-- JNTCIEquip04 =============================================== -->

    <select id="SelectDeptName"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectDeptName">
        SELECT
        CD_CODE as APPLY_REPAIR_DEPT_ID,
        KJ_NAME as
        APPLY_REPAIR_DEPT_NAME
        FROM
        TT_CODE
        WHERE CD_KUBUN='A1'
    </select>

    <!-- JNTCIEuip03 -->
    <select id="getEquipApply"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">

        select
        apply_user_id,
        apply_no,
        tt.kj_name as apply_dept_name,
        apply_user_name,
        tc.kj_name as apply_setsubi_kuben,
        apply_setsubi_no,
        apply_reason,
        ttc.kj_name as apply_state
        from tt_setsubi_apply sa,

        (select cd_code ,kj_name from tt_code where cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where cd_kubun='B1') ttc

        <dynamic prepend="WHERE">
            sa.APPLY_SETSUBI_KUBEN = tc.CD_CODE and sa.apply_dept_id=tt.cd_code
            and sa.apply_state=ttc.cd_code <!-- and sa.apply_state='4' -->
            <isNotEmpty property="dept">
                and sa.apply_dept_id = #dept#
            </isNotEmpty>
            <isNotEmpty property="type">
                and sa.apply_setsubi_kuben = #type#
            </isNotEmpty>
            <isNotEmpty property="cardnumber">
                and sa.apply_user_id like
                '%$cardnumber$%'
            </isNotEmpty>
            <isNotEmpty property="name">
                and sa.apply_user_name like
                '%$name$%'
            </isNotEmpty>
            <isNotEmpty property="state">
                and sa.apply_state = #state#
            </isNotEmpty>
        </dynamic>


    </select>
    <select id="getEquipapplyNoWhere"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
        select
        apply_user_id,
        apply_no,
        tt.kj_name as
        apply_dept_name,
        apply_user_name,
        tc.kj_name as apply_setsubi_kuben,
        apply_setsubi_no,
        apply_reason,
        ttc.kj_name as apply_state
        from
        tt_setsubi_apply sa,

        (select cd_code ,kj_name from tt_code where
        cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B1') ttc
        where sa.APPLY_SETSUBI_KUBEN = tc.CD_CODE and
        sa.apply_dept_id=tt.cd_code
        and sa.apply_state=ttc.cd_code and
        sa.apply_state='4'


    </select>


     <select id="getEquipapply0301"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
select
        SHINSEI_USER as apply_user_id,
         to_char(SHINSEI_HIDUKE,'yyyy-mm-dd') as apply_date,
        SHINSEI_NO as apply_no,
        tt.kj_name as
        apply_dept_name,
        tcc.KJ_NAME AS shinseiKubun,
        ta.USER_NAME AS apply_user_name,
        tc.kj_name as apply_setsubi_kuben,
        SETSUBI_NO as apply_setsubi_no,
        SHINSEI_RIYU as apply_reason,
        ttc.kj_name as apply_state
        from
        TT_SETSUBI_SHINSEI sa,

         (select USER_ID,USER_NAME from TT_SYS_USER
        ) ta ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='BA') ttc,
         (select cd_code ,kj_name from tt_code where
        cd_kubun='E0') tcc
        where sa.SETSUBI_KUBUN = tc.CD_CODE and sa.SHINSEI_USER=ta.USER_ID and
        sa.SHINSEI_BUMON=tt.cd_code and   tcc.CD_CODE=sa.SHINSEI_KUBUN and
     SHINSEI_JYOUTAI=ttc.cd_code
        and
        SHINSEI_NO=#apply_no#

    </select>

    <select id="getEquipeditor"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListOutput">
select
      tc.kj_name as setsubi_kuben,
       to_char(TANAOROSHI_DATE,'yyyy-mm-dd') as tanaoroshi_hiduke,
      TANAOROSHI_NO as setsubi_kanaoroshi_no,
      USER_ID as userpg,
       HOKANSHIKI as equipLocation,
      TANAOROSHISYA as tanaoroshi_user,
      SHUNYU_NO as shunyuko_no,
       to_char(SYUNYUKO_DATE,'yyyy-mm-dd') as shunyuko_date,
      YOUTO as youto,
       SETSUBI_KATABAN as setsubi_kataban,
        to_char(SETSUBI_KONYUHI,'yyyy-mm-dd') as kounyu_hiduke,
       MAC_ADDRESS as mac_address,
       SETSUBI_NO as setsubi_no
  from
  TT_SETSUBI_HYOU tt,
    (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc
  where  tt.SETSUBI_SYURUI = tc.CD_CODE and tt.SETSUBI_NO=#setsubiNo# and tt.SHUNYU_NO=#shunyuNo#
    </select>

    <select id="getEquipeditor2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquipListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">
      select USER_ID from TT_SETSUBI_HYOU where SETSUBI_NO=#setsubiNo# and SHUNYU_NO=#shunyuNo#
    </select>
    <select id="getEquipapplyRepair0303"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
        select
        SHINSEI_USER as apply_user_id,
         to_char(SHINSEI_HIDUKE,'yyyy-mm-dd') as apply_date,
        SHINSEI_NO as apply_no,
        tt.kj_name as
        apply_dept_name,
        tcc.KJ_NAME AS shinseiKubun,
        ta.USER_NAME AS apply_user_name,
        tc.kj_name as apply_setsubi_kuben,
        SETSUBI_NO as apply_setsubi_no,
        SHINSEI_RIYU as apply_reason,
        ttc.kj_name as apply_state,
        sa.SETSUBI_NO as apply_setsubi_no
        from
        TT_SETSUBI_SHINSEI sa,

         (select USER_ID,USER_NAME from TT_SYS_USER
        ) ta ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='BA') ttc,
         (select cd_code ,kj_name from tt_code where
        cd_kubun='E0') tcc
        where sa.SETSUBI_KUBUN = tc.CD_CODE and tcc.CD_CODE=sa.SHINSEI_KUBUN and
        sa.SHINSEI_USER=ta.USER_ID and
        sa.SHINSEI_BUMON=tt.cd_code and
     SHINSEI_JYOUTAI=ttc.cd_code
        and
        SHINSEI_NO=#apply_no#
    </select>
<select id="sendmailperson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         JN_CARD=#apply_user_id#
    </select>

    <update id="getEquipapply0302"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='2',SHINSEI_KUBUN='2',SETSUBI_JYOUTAI='0',SETSUBI_NO=null,SHINSEI_RIYU =#apply_reason#  where SHINSEI_NO = #apply_no#
    </update>
 <update id="getEquipapply03023"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_HYOU set SETSUBI_JYOUTAI='0',DEPT_ID='--',SHINSEI_NO=#apply_no#,USER_ID='--',
        HOKANBASHO='4',SYUNYUKO_DATE=#xttime#where SETSUBI_NO = #apply_setsubi_no#
    </update>
    <update id="getEquipapply03022"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B01',SHINSA_RIYUU=#investigate_reason#,SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#   where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>

<update id="getEquipapply0303"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='1',SHINSEI_KUBUN='2',SETSUBI_JYOUTAI='1',SETSUBI_NO=#apply_setsubi_no#,SHINSEI_RIYU =#apply_reason# where SHINSEI_NO = #apply_no#
    </update>
    <update id="getEquipapply03031"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_HYOU set SETSUBI_JYOUTAI='1',DEPT_ID=(select DEPT_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),SHINSEI_NO=#apply_no#,USER_ID=(select USER_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),
        HOKANBASHO='0',SETSUBI_SHUNYUKO='1',SYUNYUKO_DATE=#xttime#,SHUNYU_NO=#stockNo# where SETSUBI_NO = #apply_setsubi_no#
    </update>
     <select id="getEquipshencha0301"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
select
       SHINSA_RIYUU as investigate_reason
       from TT_SETSUBI_SHINSA
       where
       SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </select>
    <select id="getEquipshebei0301"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
select
       SHUNYU_NO as stockNo
       from TT_SETSUBI_HYOU
       where
      SETSUBI_NO = #apply_setsubi_no#
    </select>
    <update id="getEquipapply03032"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
            update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B02',SHINSA_RIYUU=#investigate_reason#,SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId# where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>
    <select id="getEquipapply0304"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEqipApplyOutput">
select
        SHINSEI_USER as apply_user_id,
         to_char(SHINSEI_HIDUKE,'yyyy-mm-dd') as apply_date,
        SHINSEI_NO as apply_no,
        tt.kj_name as
        apply_dept_name,
        tcc.KJ_NAME AS shinseiKubun,
        ta.USER_NAME AS apply_user_name,
        sa.ITEM_NAME as apply_setsubi_kuben,
        sa.ITEM_NUMBER as apply_setsubi_number,
        SETSUBI_NO as apply_setsubi_no,
        SHINSEI_RIYU as apply_reason,
        ttc.kj_name as apply_state
        from
        TT_SETSUBI_SHINSEI sa,
         (select USER_ID,USER_NAME from TT_SYS_USER
        ) ta ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='BA') ttc,
         (select cd_code ,kj_name from tt_code where
        cd_kubun='E0') tcc
        where sa.SETSUBI_KUBUN = tc.CD_CODE and sa.SHINSEI_USER=ta.USER_ID and
        sa.SHINSEI_BUMON=tt.cd_code and   tcc.CD_CODE=sa.SHINSEI_KUBUN and
     SHINSEI_JYOUTAI=ttc.cd_code
        and
        SHINSEI_NO=#apply_no#
    </select>
    <update id="getEquipapply0401"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='2',SHINSEI_RIYU =#apply_reason#  where SHINSEI_NO

= #apply_no#
    </update>

    <update id="getEquipapply04011"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSA set

SHINSA_JYOUTAI='B01',SHINSA_RIYUU=#investigate_reason#,SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#   where

SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>

    <update id="getEquipapply0402"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='1',SHINSEI_RIYU =#apply_reason#  where SHINSEI_NO

= #apply_no#
    </update>
    <update id="getEquipapply04021"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSA set

SHINSA_JYOUTAI='B02',SHINSA_RIYUU=#investigate_reason#,SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#   where

SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>
    <update id="updateEquipapplyReturn03051"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">

update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='1',SHINSEI_KUBUN='4',SETSUBI_NO=#apply_setsubi_no#  where SHINSEI_NO = #apply_no#
    </update>
    <update id="updateEquipapplyRepair0303"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">

update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='2',SHINSEI_KUBUN='3',SETSUBI_NO=#apply_setsubi_no#  where SHINSEI_NO = #apply_no#
    </update>
    <update id="updateEquipapplyRepair03031"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
update TT_SETSUBI_HYOU set SETSUBI_SHUNYUKO='0',USER_ID='--',HOKANBASHO='4',SETSUBI_JYOUTAI='2',DEPT_ID='--',SYUNYUKO_DATE=#xttime# where  SETSUBI_NO=#apply_setsubi_no#
    </update>
    <update id="updateEquipapplyRepair03032"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
    update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B01',SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#
     where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>
    <update id="updateEquipapplyReturn03053"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">

    update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B02',SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#
     where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>
    <update id="updateEquipapplyReturn0305"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
update TT_SETSUBI_HYOU set SETSUBI_SHUNYUKO='0',USER_ID='--',HOKANBASHO='4',SETSUBI_JYOUTAI='0',DEPT_ID='--',SYUNYUKO_DATE=#xttime# where     SETSUBI_NO=#apply_setsubi_no#
    </update>
    <update id="updateEquipapplyReturn03052"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='2',SHINSEI_KUBUN='4',SETSUBI_NO=#apply_setsubi_no#  where SHINSEI_NO = #apply_no#
    </update>
     <update id="updateEquipapplyReturn03054"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B01',SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#   where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>
    <update id="updateEquipapplyReturn03055"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
update TT_SETSUBI_HYOU set SETSUBI_JYOUTAI='1',DEPT_ID=(select DEPT_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),USER_ID=(select USER_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),
        HOKANBASHO='0',SETSUBI_SHUNYUKO='1',SYUNYUKO_DATE=#xttime# where SETSUBI_NO=#apply_setsubi_no#
    </update>
    <!--  -->
    <update id="updateEquipapplyRepair03033"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
update TT_SETSUBI_SHINSEI set SHINSEI_JYOUTAI='1',SHINSEI_KUBUN='3',SETSUBI_NO=#apply_setsubi_no#  where SHINSEI_NO = #apply_no#
    </update>
    <update id="updateEquipapplyRepair03034"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
 update TT_SETSUBI_HYOU set SETSUBI_JYOUTAI='1',DEPT_ID=(select DEPT_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),USER_ID=(select USER_ID from TT_SYS_USER WHERE USER_NAME=#apply_user_name#),
        HOKANBASHO='0',SETSUBI_SHUNYUKO='1',SYUNYUKO_DATE=#xttime# where SETSUBI_NO=#apply_setsubi_no#
    </update>

    <update id="updateEquip0303"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput">
        update TT_SETSUBI_SHINSA set SHINSA_JYOUTAI='B02',SHINSA_HIDUKE=#xttime#,SHINSASYA=#userId#   where SHINSA_NO = (select SHINSA_NO from TT_SETSUBI_SHINSEI where SHINSEI_NO =  #apply_no#)
    </update>


<select id="getEquipapplynumber1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">
        <!-- SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND C.CD_KUBUN='B0' and s.SETSUBI_JYOUTAI='0'  and    C.KJ_NAME=#apply_setsubi_kuben# -->
        SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND C.CD_KUBUN='B0' and s.SETSUBI_JYOUTAI='0'and C.KJ_NAME=#apply_setsubi_kuben#
    </select>
    <select id="getEquipapplynumber2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">

        SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND C.CD_KUBUN='B0' and s.SETSUBI_JYOUTAI='1'and C.CD_CODE=#equipType# and s.USER_ID=#id#
    </select>
<select id="JNTCIEquip02ChangeStateCountm"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.String">
SELECT KJ_NAME FROM  TT_CODE
WHERE
CD_CODE=(SELECT DEPT_ID FROM  TT_SYS_USER
WHERE
USER_ID=#id#)
</select>
<select id="JNTCIEquip02ChangeStateCountmn"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.String">
SELECT KJ_NAME FROM  TT_CODE
WHERE
CD_CODE=(SELECT DEPT_ID FROM  TT_SYS_USER
WHERE
USER_ID=#userId#)
</select>
<select id="EquipShinsaNo"

         resultClass="java.lang.String">
       SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA
    </select>
    <select id="EquipApplyNo"

         resultClass="java.lang.String">
       SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI
    </select>
<select id="mailperson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
      resultClass="java.lang.String" >
        SELECT OFFIC_MAIL as mail  FROM  TT_PERSONAL_BASIC_INFO  where JN_CARD=#mailperson#
    </select>
<select id="adminmailperson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
          resultClass="java.lang.String" >
        SELECT  USERNAME
        FROM
         TT_PERSONAL_BASIC_INFO
         WHERE
        OFFIC_MAIL=#mail#
    </select>
    <select id="getEquipapplyCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip03ListInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT count(*) FROM
        (
        select
        apply_user_id,
        apply_no,
        tt.kj_name as
        apply_dept_name,
        apply_user_name,
        tc.kj_name as apply_setsubi_kuben,
        apply_setsubi_no,
        apply_reason,
        ttc.kj_name as apply_state
        from
        tt_setsubi_apply sa,

        (select cd_code ,kj_name from tt_code where
        cd_kubun='A1') tt ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B0') tc ,
        (select cd_code ,kj_name from tt_code where
        cd_kubun='B1') ttc

        <dynamic prepend="WHERE">
            sa.APPLY_SETSUBI_KUBEN = tc.CD_CODE and sa.apply_dept_id=tt.cd_code
            and sa.apply_state=ttc.cd_code
            <isNotEmpty property="dept">
                and sa.apply_dept_id = #dept#
            </isNotEmpty>
            <isNotEmpty property="type">
                and sa.apply_setsubi_kuben = #type#
            </isNotEmpty>
            <isNotEmpty property="cardnumber">
                and sa.apply_user_id like
                '%$cardnumber$%'
            </isNotEmpty>
            <isNotEmpty property="name">
                and sa.apply_user_name like
                '%$name$%'
            </isNotEmpty>
            <isNotEmpty property="state">
                and sa.apply_state = #state#
            </isNotEmpty>
        </dynamic>
        )
    </select>



    <select id="getDeptName"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectDeptNameOutput">
        select cd_code as APPLY_DEPT_ID ,kj_name as
        APPLY_DEPT_NAME from tt_code
        where cd_kubun ='A1'
    </select>

    <select id="getEquipType"
resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEquipTypeOutput">
       select cd_code as SETSUBI_KUBUN_ID ,kj_name as APPLY_SETSUBI_KUBEN from tt_code   where  cd_kubun ='B0'
    </select>
    <select id="getEquipState"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectEquipStateOutput">
        select cd_code as APPLY_STATE_ID,kj_name as APPLY_STATE
        from tt_code where cd_kubun ='B1'
    </select>


    <!-- ================================= 考勤记录导入 ================================= -->
    <!-- 获取考勤ID -->
    <select id="GetAttendanceId" parameterClass="java.lang.Integer"
        resultClass="java.lang.Integer">
        SELECT MAX(ATTENDANCE_ID) AS ATTENDANCE_ID FROM
        TT_ATTENCE_MANAGER_TEMP
    </select>
    <!-- 导入考勤记录 -->
    <insert id="InsertAttendance" parameterClass="java.util.Map">
        INSERT INTO
        TT_ATTENCE_MANAGER_TEMP
        (ATTENDANCE_ID,JN_CARD,,NAME，DEPT_ID，START_TIME，END_TIME，MACHINE_NO)
        VALUES(#attendance_id#,#jn_card#,#name#,#dept_id#,#start_time#,#end_time#,#machine_no#)
    </insert>
    <!-- 获取员工信息 -->
    <select id="GetDetailedInfo" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCISelectPersonalInfo">
        SELECT
        JN_CARD,
        USERNAME,
        DEPARTMENT
        FROM
        TT_PERSONAL_BASIC_INFO
    </select>

    <!-- ======================================请假审核============================================================== -->
    <select id="JNTCIAttendance04select"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT TTAS.LEAVE_ID AS LEAVE_ID,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS
        NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_SUBTIME,
        TTAS.EXAMINE_TIME AS EXAMINE_TIME,
        TTAS.EXAMINE_PERSON AS
        EXAMINE_PERSON,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS LEAVE_REASON,

        TC.KJ_NAME AS LEAVE_TYPE,
        TTLM.LEAVE_ID AS LEAVE_ID,
        TCA.KJ_NAME AS application_type,
        TCW.KJ_NAME AS EXAMINE_STATUS
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        JOIN TT_SYS_USER TSU ON
        TSU.USER_ID = TTLM.JN_CARD
        LEFT
        JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=TCA.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON TTAS.EXAMINE_STATUS =
        TCW.CD_CODE
        <dynamic prepend="WHERE ">
             1=1
            <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty>
            <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;= #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;= #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
         order by
         (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
            LEAVE_SUBTIME DESC ,EXAMINE_TIME DESC
    </select>
    <!--衣总和栋桑可以看见的请假内容  -->
    <select id="JNTCIAttendance04select1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT TTAS.LEAVE_ID AS LEAVE_ID,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS
        NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_SUBTIME,
        TTAS.EXAMINE_TIME AS EXAMINE_TIME,
        TTAS.EXAMINE_PERSON AS
        EXAMINE_PERSON,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS LEAVE_REASON,

        TC.KJ_NAME AS LEAVE_TYPE,
        TTLM.LEAVE_ID AS LEAVE_ID,
        TCA.KJ_NAME AS APPLICATION_TYPE，
        TCW.KJ_NAME AS EXAMINE_STATUS
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        JOIN TT_SYS_USER TSU ON
        TSU.USER_ID = TTLM.JN_CARD
        LEFT
        JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=TCA.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON TTAS.EXAMINE_STATUS =
        TCW.CD_CODE
        <dynamic prepend="WHERE ">
         ( TTAS.EXAMINE_STATUS='A01' or TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A11' or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A13'
         or  TTAS.EXAMINE_STATUS='A04')
           <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;= #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;= #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>

         </dynamic>
        AND (((TSU.FL_FUNC_USE ='6' AND TTLM.LEAVE_TOTALTIME >= 24)and(TTAS.EXAMINE_STATUS!='A04')) OR TSU.FL_FUNC_USE='4' or TTLM.PROJECT_PM='張棟')
        order by
        (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
            LEAVE_SUBTIME DESC ,EXAMINE_TIME DESC
    </select>
    <!--衣总检索时的SQL -->
    <select id="JNTCIAttendance04select4"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT TTAS.LEAVE_ID AS LEAVE_ID,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS
        NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_SUBTIME,
        TTAS.EXAMINE_TIME AS EXAMINE_TIME,
        TTAS.EXAMINE_PERSON AS
        EXAMINE_PERSON,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS LEAVE_REASON,

        TC.KJ_NAME AS LEAVE_TYPE,
        TTLM.LEAVE_ID AS LEAVE_ID,
        TCA.KJ_NAME AS APPLICATION_TYPE，
        TCW.KJ_NAME AS EXAMINE_STATUS
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        JOIN TT_SYS_USER TSU ON
        TSU.USER_ID = TTLM.JN_CARD
        LEFT
        JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=TCA.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON TTAS.EXAMINE_STATUS =
        TCW.CD_CODE
        <dynamic prepend="WHERE ">
          (TTAS.EXAMINE_STATUS='A01' or TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A11' or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A13'
         or  TTAS.EXAMINE_STATUS='A04')
            <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;= #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;= #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>

        </dynamic>
        order by
        (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
            LEAVE_SUBTIME DESC ,EXAMINE_TIME DESC
    </select>
<!--田总可以看见的请假详情  -->
    <select id="JNTCIAttendance04select2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT TTAS.LEAVE_ID AS LEAVE_ID,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS
        NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_SUBTIME,
        TTAS.EXAMINE_TIME AS EXAMINE_TIME,
        TTAS.EXAMINE_PERSON AS
        EXAMINE_PERSON,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS LEAVE_REASON,

        TC.KJ_NAME AS LEAVE_TYPE,
        TTLM.LEAVE_ID AS LEAVE_ID,
        TCA.KJ_NAME AS APPLICATION_TYPE，
        TCW.KJ_NAME AS EXAMINE_STATUS
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        JOIN TT_SYS_USER TSU ON
        TSU.USER_ID = TTLM.JN_CARD
        LEFT
        JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=TCA.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON TTAS.EXAMINE_STATUS =
        TCW.CD_CODE
         <dynamic prepend="WHERE ">
          <!-- TTAS.EXAMINE_STATUS='A10'  or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A04' -->
          ((TTLM.PROJECT_PM='田東啓' and (TTAS.EXAMINE_STATUS='A10'  or TTAS.EXAMINE_STATUS='A04' or TTAS.EXAMINE_STATUS='A12')) or (TTAS.EXAMINE_PERSON='田東啓' and  TTAS.EXAMINE_STATUS='A08') or (TTLM.PROJECT_PM!='田東啓'and (TTAS.EXAMINE_PERSON='張棟' or TTAS.EXAMINE_PERSON='衣蘭凱') and  TTAS.EXAMINE_STATUS='A08') or (TTAS.EXAMINE_PERSON='田東啓' and (TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A12')))
            <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <!-- <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty> -->
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;= #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;= #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE =#application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
       order by
       (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
        	LEAVE_SUBTIME DESC ,EXAMINE_TIME DESC
    </select>

<select id="JNTCIAttendance04select3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT TTAS.LEAVE_ID AS LEAVE_ID,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS
        NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_SUBTIME,
        TTAS.EXAMINE_TIME AS EXAMINE_TIME,
        TTAS.EXAMINE_PERSON AS
        EXAMINE_PERSON,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS
        LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS LEAVE_REASON,

        TC.KJ_NAME AS LEAVE_TYPE,
        TTLM.LEAVE_ID AS LEAVE_ID,
        TCA.KJ_NAME AS APPLICATION_TYPE,
        TCW.KJ_NAME AS EXAMINE_STATUS
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        JOIN TT_SYS_USER TSU ON
        TSU.USER_ID = TTLM.JN_CARD
        LEFT
        JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
         LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=TCA.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON TTAS.EXAMINE_STATUS =
        TCW.CD_CODE
        <dynamic prepend="WHERE ">
         ( TTAS.EXAMINE_STATUS='A03' or TTAS.EXAMINE_STATUS='A13' or TTAS.EXAMINE_STATUS='A10')
             <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;= #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;= #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
        order by
        (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
            LEAVE_SUBTIME DESC ,EXAMINE_TIME DESC
    </select>
    <update id="JNTCIAttendance04disagree"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
    UPDATE TT_AUDIT_STATUS SET examine_reason =#examine_reason#
    ,EXAMINE_PAPER_FG=#examine_paper_fg#,
    EXAMINE_STATUS = #examine_status#
    ,EXAMINE_TIME =
    TO_CHAR(SYSDATE,'yyyy/MM/DD')
    ,EXAMINE_PERSON=#userName#,
    ABSENCE=#absence# WHERE
    LEAVE_ID = #leave_id#    <!-- EXAMINE_PERSON=#examine_person# -->
    </update>
    <update id="JNTCIAttendance04disagree2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_LEAVE_MANAGER SET LEAVE_STATUS
        =
        #examine_status# ,UPD_TIME = TO_CHAR(SYSDATE,'yyyy/MM/DD') WHERE
        LEAVE_ID = #leave_id#
    </update>
    <!--申请休假是更新年假的SQL  -->
   <!--  <update id="JNTCIAttendance04rollback"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_VOCATION SET REMAIN_DAYS
        = #totalDays# WHERE
        USER_ID = #jn_card#
    </update> -->
    <update id="JNTCIAttendance04rollback2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_LEAVE_MANAGER SET LEAVE_TOTALTIME
        =
        #leave_totaltime# WHERE LEAVE_ID = #leave_id#
    </update>
    <update id="JNTCIAttendance04rollback3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_AUDIT_STATUS SET EXAMINE_STATUS =
        'A04',EXAMINE_TIME='',EXAMINE_PAPER_FG='0',
        EXAMINE_REASON='',
        ABSENCE=''
        WHERE LEAVE_ID = #leave_id#
    </update>
    <update id="reasonback"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_AUDIT_STATUS SET EXAMINE_STATUS =
        'A04',
        EXAMINE_REASON=''
        WHERE LEAVE_ID = #leave_id#
    </update>
    <update id="JNTCIAttendance04rollback5"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_AUDIT_STATUS SET EXAMINE_STATUS =
        'A08',EXAMINE_TIME='',EXAMINE_PAPER_FG='0',
        EXAMINE_REASON='',
        ABSENCE=''
        WHERE LEAVE_ID = #leave_id#
    </update>
    <select id="JNTCIAttendance04rollback4" parameterClass="java.lang.String"
        resultClass="java.lang.Double">
        SELECT ABSENCE from TT_AUDIT_STATUS where LEAVE_ID=#leave_id#
    </select>

    <delete id="JNTCIAttendance04DeleteTTLM"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        delete from TT_LEAVE_MANAGER where LEAVE_ID=#leave_id#
    </delete>
    <delete id="JNTCIAttendance04DeleteTTAS"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        delete from TT_AUDIT_STATUS where LEAVE_ID=#leave_id#
    </delete>
   <update id="vocationUpdate2" parameterClass="java.lang.String">
        UPDATE TT_VOCATION
        SET
        TOTAL_DAYS = 0
        where
        USER_ID = #userId#
    </update>
 <!--    <update id="vocationUpdate3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04updateInput">
        UPDATE TT_VOCATION SET
        REMAIN_DAYS =#totalDays#
        where
        USER_ID = #jn_card#
    </update> -->
 <!--leader可以看见的请假条数  -->
    <select id="JNTCIAttendance04selectCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
    COUNT(1) AS count
    FROM
    TT_LEAVE_MANAGER TTLM
    JOIN TT_AUDIT_STATUS TTAS ON TTLM.LEAVE_ID = TTAS.LEAVE_ID
    JOIN TT_SYS_USER TSU ON TSU.USER_ID = TTLM.JN_CARD
    LEFT JOIN TT_CODE TCW ON TTAS.EXAMINE_STATUS = TCW.CD_CODE
 <dynamic prepend="WHERE ">
            TTAS.EXAMINE_STATUS!='A06'
            <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty>
           <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;=
                #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;=
                #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
        order by jn_card
    </select>
   <!--栋桑可以看到的请假条数！  -->
    <select id="JNTCIAttendance04selectCount1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
    COUNT(1) AS count
    FROM
    TT_LEAVE_MANAGER TTLM
    JOIN TT_AUDIT_STATUS TTAS ON TTLM.LEAVE_ID = TTAS.LEAVE_ID
    JOIN TT_SYS_USER TSU ON TSU.USER_ID = TTLM.JN_CARD
    LEFT JOIN TT_CODE TCW ON TTAS.EXAMINE_STATUS = TCW.CD_CODE
        <dynamic prepend="WHERE ">
        ( TTAS.EXAMINE_STATUS='A01' or TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A11' or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A13'
         or  TTAS.EXAMINE_STATUS='A04')
          <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>

            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;=
                #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;=
                #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
           </isNotEmpty>

        </dynamic>
        AND (((TSU.FL_FUNC_USE ='6' AND TTLM.LEAVE_TOTALTIME >= 24)and(TTAS.EXAMINE_STATUS!='A04')) OR TSU.FL_FUNC_USE='4' or TTLM.PROJECT_PM='張棟')
        order by jn_card
    </select>
    <!--衣总检索条数  -->
    <select id="JNTCIAttendance04selectCount4"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
    COUNT(1) AS count
    FROM
    TT_LEAVE_MANAGER TTLM
    JOIN TT_AUDIT_STATUS TTAS ON TTLM.LEAVE_ID = TTAS.LEAVE_ID
    JOIN TT_SYS_USER TSU ON TSU.USER_ID = TTLM.JN_CARD
    LEFT JOIN TT_CODE TCW ON TTAS.EXAMINE_STATUS = TCW.CD_CODE
        <dynamic prepend="WHERE ">
        (TTAS.EXAMINE_STATUS='A01' or TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A11' or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A13'
         or  TTAS.EXAMINE_STATUS='A04')
         <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;=
                #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;=
                #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
        order by jn_card
    </select>
    <!--田总可以看到的请假条数  -->
    <select id="JNTCIAttendance04selectCount2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
       SELECT
    COUNT(1) AS count
    FROM
    TT_LEAVE_MANAGER TTLM
    JOIN TT_AUDIT_STATUS TTAS ON TTLM.LEAVE_ID = TTAS.LEAVE_ID
    JOIN TT_SYS_USER TSU ON TSU.USER_ID = TTLM.JN_CARD
    LEFT JOIN TT_CODE TCW ON TTAS.EXAMINE_STATUS = TCW.CD_CODE
        <dynamic prepend="WHERE ">
<!-- TTAS.EXAMINE_STATUS='A10'  or TTAS.EXAMINE_STATUS='A08' or TTAS.EXAMINE_STATUS='A12' or TTAS.EXAMINE_STATUS='A04'-->
((TTLM.PROJECT_PM='田東啓' and (TTAS.EXAMINE_STATUS='A10'  or TTAS.EXAMINE_STATUS='A04' or TTAS.EXAMINE_STATUS='A12')) or(TTAS.EXAMINE_PERSON='田東啓' and  TTAS.EXAMINE_STATUS='A08') or (TTLM.PROJECT_PM!='田東啓'and (TTAS.EXAMINE_PERSON='張棟' or TTAS.EXAMINE_PERSON='衣蘭凱') and  TTAS.EXAMINE_STATUS='A08') or (TTAS.EXAMINE_PERSON='田東啓' and (TTAS.EXAMINE_STATUS='A10' or TTAS.EXAMINE_STATUS='A12')))
           <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <!-- <isNotEmpty property="userName">
                and TTLM.PROJECT_PM=#userName#
            </isNotEmpty> -->
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;=
                #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;=
                #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
        order by jn_card
    </select>

<select id="JNTCIAttendance04selectCount3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInput"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
    COUNT(1) AS count
    FROM
    TT_LEAVE_MANAGER TTLM
    JOIN TT_AUDIT_STATUS TTAS ON TTLM.LEAVE_ID = TTAS.LEAVE_ID
    JOIN TT_SYS_USER TSU ON TSU.USER_ID = TTLM.JN_CARD
    LEFT JOIN TT_CODE TCW ON TTAS.EXAMINE_STATUS = TCW.CD_CODE
            <dynamic prepend="WHERE ">
          ( TTAS.EXAMINE_STATUS='A03' or TTAS.EXAMINE_STATUS='A13' or TTAS.EXAMINE_STATUS='A10')
            <isNotEmpty property="jn_card_serch">
                and TTLM.JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty property="name_serch">
                and TTLM.NAME like '%'||#name_serch#||'%'
            </isNotEmpty>
            <isNotEmpty property="leave_starttime_serch">
                and to_char(TTLM.LEAVE_STARTTIME
                ,'yyyy-mm-dd hh24:mi') &gt;=
                #leave_starttime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_endtime_serch">
                and to_char(TTLM.LEAVE_ENDTIME
                ,'yyyy-mm-dd hh24:mi') &lt;=
                #leave_endtime_serch#
            </isNotEmpty>
            <isNotEmpty property="leave_type_serch">
                and TTLM.LEAVE_TYPE = #leave_type_serch#
            </isNotEmpty>
            <isNotEmpty property="dept_id_serch">
                and TTLM.DEPT_ID = #dept_id_serch#
            </isNotEmpty>
            <isNotEmpty property="application_type_serch">
                and TTLM.APPLICATION_TYPE = #application_type_serch#
            </isNotEmpty>
            <isNotEmpty property="examine_status_serch">
                and TCW.KJ_NAME =
                #examine_status_serch#
            </isNotEmpty>
        </dynamic>
        order by jn_card
    </select>
    <!-- parameterClass="java.lang.String" -->
    <select id="JNTCIAttendance04forward"

        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        SELECT
        TTAS.EXAMINE_REASON AS examine_reason,
        TTLM.JN_CARD AS JN_CARD ,
        TTLM.NAME AS NAME,
        TCL.KJ_NAME AS DEPT_ID,
        TTLM.PROJECT_PM AS PROJECT_PM,
        TTAS.EXAMINE_PERSON AS EXAMINE_PERSON,
        TTAS.EXAMINE_PAPER_FG AS
        EXAMINE_PAPER_FG,
        TSU.LEADER ,
        tsu.DEPT_PERSON ,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_STARTTIME,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS LEAVE_ENDTIME,
        TTLM.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        TTLM.LEAVE_REASON AS
        LEAVE_REASON,
        TTAS.EXAMINE_STATUS AS
        EXAMINE_STATUS,
        TC.KJ_NAME AS
        LEAVE_TYPE,
       TCA.KJ_NAME AS APPLICATION_TYPE，
        TC.CD_CODE AS
        TYPE_LEAVE
        FROM TT_LEAVE_MANAGER TTLM
        JOIN
        TT_AUDIT_STATUS TTAS
        ON
        TTLM.LEAVE_ID = TTAS.LEAVE_ID
        join TT_SYS_USER
        TSU on
        TSU.USER_ID =
        TTLM.JN_CARD
        LEFT JOIN TT_CODE TC
        ON
        TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON TTLM.APPLICATION_TYPE=
        TCA.CD_CODE
        LEFT JOIN
        TT_CODE TCL
        on
        TTLM.DEPT_ID=TCL.CD_CODE
        WHERE TTLM.LEAVE_ID = #leave_id#
        AND
        TTAS.EXAMINE_STATUS != 'A06'
        order by jn_card
    </select>

    <select id="LeaveType"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'A5'
    </select>
    <select id="DeptId"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'A1'
    </select>
    <select id="ApplicationType"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'A6'
    </select>
    <select id="ExamineStatus"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'B2'
        AND cd_code!='A07' AND cd_code!='A05' AND cd_code!='A06'
    </select>
    <select id="Vocation" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
        select remain_days from tt_vocation where USER_ID =
        #userId#
    </select>

    <!-- cheng -->


    <select id="getuservocation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationOutvo">
        select vo.USER_ID as userId, vo.USER_NAME as userName, vo.USER_SEX as
        userSex,nvl(vo.january,0.0) as january, nvl(vo.february,0.0) as february, nvl(vo.march,0.0) as march, nvl(vo.april,0.0) as april,
        nvl(vo.may,0.0) as may, nvl(vo.june,0.0) as june, nvl(vo.july,0.0) as july, nvl(vo.august,0.0) as august, nvl(vo.september,0.0) as september,
        nvl(vo.octorber,0.0) as octorber, nvl(vo.november,0.0) as november, nvl(vo.december,0.0) as december,
        tc.KJ_NAME as deptId,
        vo.ENTYR_TIME as entryDate, tcl.KJ_NAME
        as userType,
        vo.HOLIDAY_DAYS as nianjia,
        vo.REMAIN_DAYS as remainDays
        from TT_VOCATION VO
        left join
        tt_code tc
        on tc.cd_code = vo.DEPT_ID
        left join tt_code tcl
        on
        tcl.cd_code = vo.USER_TYPE
        left join TT_PERSONAL_BASIC_INFO inf
        on inf.JN_CARD=vo.USER_ID
        <dynamic prepend="WHERE">

            <isNotEmpty property="userSelectId" prepend=" AND ">
                VO.USER_ID =
                #userSelectId#
            </isNotEmpty>
              <isNotEmpty property="usernameSelect" prepend=" AND ">
                vo.USER_NAME    like  '%$usernameSelect$%'

            </isNotEmpty>
            <isNotEmpty  prepend=" AND ">
             inf.OUT_TIME='2099/12/31'
            </isNotEmpty>
            <isNotEmpty property="deptId1" prepend=" AND ">
                VO.dept_Id =
                #deptId1#
            </isNotEmpty>
        </dynamic>
        order by vo.USER_ID asc
</select>
<select id="getuservocation2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationOutvo">
       select vo.USER_ID as userId,
        vo.REMAIN_DAYS as remainDays,
		vo.HOLIDAY_DAYS as nianjia
        from TT_VOCATION VO
        order by vo.USER_ID asc
</select>



    <delete id="deleteTtvocation"
             parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">
         delete from TT_VOCATION
    </delete>

    <insert id="updateVocationDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">

        INSERT INTO TT_VOCATION (USER_ID,USER_NAME,USER_SEX,DEPT_ID,USER_TYPE,REMAIN_DAYS,ENTYR_TIME,JANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST,SEPTEMBER,OCTORBER,NOVEMBER,DECEMBER) VALUES(#userId#, #userName#, #userSex#, #deptId#, #userType#, #remainDays# ,#entyrTime#,'0.0','0.0','0.0','0.0','0.0','0.0','0.0','0.0','0.0','0.0','0.0','0.0')
    </insert>

    <delete id="deletevocation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">

        delete from TT_VOCATION where
        USER_ID = #userId#

    </delete>
    <select id="selectyouxiang"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#userName#
    </select>
      <select id="selectyouxiangpm"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#projectPm#
    </select>






<select id="selectyouxiang1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#examinePerson#
    </select>






<select id="selectyouxiang2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#uname1#
    </select>
    <update id="vocationUpdate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">
        UPDATE TT_VOCATION VO SET
        REMAIN_DAYS = #remainDays#,
        january = #january#,
        february = #february#,
        march = #march#,
        april = #april#,
        may = #may#,
        june = #june#,
        july = #july#,
        august = #august#,
        september = #september#,
        octorber = #octorber#,
        november = #november#,
        december = #december#
        where
        USER_ID = #userId#
    </update>


    <select id="getuservocationselect"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationOutvo">
        select USER_ID as userId, USER_NAME as userName, USER_SEX as userSex,
        (select KJ_NAME FROM TT_CODE CO where CO.CD_CODE = VO.DEPT_ID) as
        deptId,
        ENTYR_TIME as entryDate, (select KJ_NAME FROM TT_CODE CO where
        CO.CD_CODE = VO.USER_TYPE) as userType,
        REMAIN_DAYS as remainDays from
        TT_VOCATION VO
        <dynamic prepend="WHERE">
            <isNotEmpty property="userSelectId" prepend=" AND ">
                USER_ID =
                #userSelectId#
            </isNotEmpty>
            <isNotEmpty property="usernameSelect" prepend=" AND ">

                     USER_NAME  like  '%$usernameSelect$%'
            </isNotEmpty>
            <isNotEmpty property="deptId" prepend=" AND ">
                VO.USER_TYPE =
                #deptId#
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="getuser"

        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationOutvo">
        select USER_ID as userId, USER_NAME as userName, USER_SEX
        as userSex,
        (select KJ_NAME FROM TT_CODE CO where CO.CD_CODE =
        VO.DEPT_ID) as deptId,HOLIDAY_DAYS as nianjia,
        ENTYR_TIME as entryDate, (select KJ_NAME FROM
        TT_CODE CO where CO.CD_CODE = VO.USER_TYPE) as userType,
        REMAIN_DAYS as
        remainDays,january as january,february as february,march as march,april as april,may as may,
        june as june,july as july,august as august,september as september,octorber as octorber,november as november,december as december
         from TT_VOCATION VO where
        USER_ID = #userId#
    </select>

    <select id="getUserCount" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(1)
        from TT_VOCATION VO
     left join TT_PERSONAL_BASIC_INFO inf
        on inf.JN_CARD=vo.USER_ID
        <dynamic prepend="WHERE">

            <isNotEmpty property="userSelectId" prepend=" AND ">
                VO.USER_ID =
                #userSelectId#
            </isNotEmpty>
            <isNotEmpty  prepend=" AND ">
             inf.OUT_TIME='2099/12/31'
            </isNotEmpty>
            <isNotEmpty property="usernameSelect" prepend=" AND ">

               VO.USER_NAME   like  '%$usernameSelect$%'
            </isNotEmpty>
            <isNotEmpty property="deptId1" prepend=" AND ">
                VO.dept_Id =
                #deptId1#
            </isNotEmpty>
        </dynamic>
    </select>


    <select id="downloadvocation"
      resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationOutput">
       <!--  SELECT
      USER_ID as userId,
     USER_NAME as userName,
    USER_SEX as  userSex,
    DEPT_ID  as deptId,

    REMAIN_DAYS,
    HOLIDAY_DAYS,
    JANUARY as  january,
    FEBRUARY as february,
MARCH as march,
APRIL as april,
MAY as may,
JUNE as june,
JULY as july,
AUGUST as august,
SEPTEMBER as september,
OCTORBER as octorber,
NOVEMBER as november,
DECEMBER  as december
        from TT_VOCATION VO
        join tt_sys_user tsu on
        tsu.user_id=vo.user_id
        left join tt_code tc
        on tc.cd_code = vo.DEPT_ID
        left join tt_code tcl
        on tcl.cd_code = vo.USER_TYPE -->
          SELECT
      VO.USER_ID as userId,
     VO.USER_NAME as userName,
    VO.USER_SEX as  userSex,
    cd.KJ_NAME  as deptId,

   VO.REMAIN_DAYS,
    VO.HOLIDAY_DAYS,
    VO.JANUARY as  january,
    VO.FEBRUARY as february,
VO.MARCH as march,
VO.APRIL as april,
VO.MAY as may,
VO.JUNE as june,
VO.JULY as july,
VO.AUGUST as august,
VO.SEPTEMBER as september,
VO.OCTORBER as octorber,
VO.NOVEMBER as november,
VO.DECEMBER  as december
        from TT_VOCATION VO
		left join TT_CODE cd
		on  VO.DEPT_ID=cd.CD_CODE and cd.CD_KUBUN='A1'
		order by   VO.USER_ID


    </select>
<select id="getUsershebaokuanianTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Float">

select ceil((To_date( #t3#, 'yyyy-mm-dd') - To_date(#t2# , 'yyyy-mm-dd')))  m4 FROM DUAL

    </select>

    <!-- <select id="getUsershebaoTime"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
SELECT to_char(SYAHO_JIKAN,'yyyy-mm-dd') AS shebaoTime from TT_PERSONAL_BASIC_INFO where JN_CARD=#userId#
    </select> -->
    <update id="updateShengyuNianjia"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">
update TT_VOCATION set REMAIN_DAYS =(nvl(HOLIDAY_DAYS,0)-(nvl(JANUARY,0)+nvl(FEBRUARY,0)+nvl(MARCH,0)+nvl(APRIL,0)+nvl(MAY,0)+nvl(JUNE,0)+nvl(JULY,0)+nvl(AUGUST,0)+nvl(SEPTEMBER,0)+nvl(OCTORBER,0)+nvl(NOVEMBER,0)+nvl(DECEMBER,0))) where USER_ID = #userId#
<!-- update TT_VOCATION set REMAIN_DAYS =(HOLIDAY_DAYS-(JANUARY+FEBRUARY+MARCH+APRIL+MAY+JUNE+JULY+AUGUST+SEPTEMBER+OCTORBER+NOVEMBER+DECEMBER)) where USER_ID = #userId# -->
    </update>
    <update id="updateShengyuNianjiaMonth"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">
update TT_VOCATION set JANUARY=0.0,FEBRUARY=0.0,MARCH=0.0,APRIL=0.0,MAY=0.0,JUNE=0.0,JULY=0.0,AUGUST=0.0,SEPTEMBER=0.0,OCTORBER=0.0,NOVEMBER=0.0,DECEMBER=0.0 where USER_ID = #userId#

    </update>
    <update id="updateShengyuNianjiaMonthone"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">

		update TT_VOCATION set JANUARY=nvl2(JANUARY,JANUARY,0.0),
		FEBRUARY=nvl2(FEBRUARY,FEBRUARY,0.0),MARCH=nvl2(MARCH,MARCH,0.0),
		APRIL=nvl2(APRIL,APRIL,0.0),MAY=nvl2(MAY,MAY,0.0),JUNE=nvl2(JUNE,JUNE,0.0),
		JULY=nvl2(JULY,JULY,0.0),AUGUST=nvl2(AUGUST,AUGUST,0.0),SEPTEMBER=nvl2(SEPTEMBER,SEPTEMBER,0.0),
		OCTORBER=nvl2(OCTORBER,OCTORBER,0.0),NOVEMBER=nvl2(NOVEMBER,NOVEMBER,0.0),DECEMBER=nvl2(DECEMBER,DECEMBER,0.0) where USER_ID = #userId#
    </update>
     <update id="updateTotalNianjia"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">

update TT_VOCATION set HOLIDAY_DAYS = #nianjia# where USER_ID = #userId#
    </update>
     <select id="getUserupdatenianjiaTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date(#t2# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t4# , 'yyyy-mm-dd hh24-mi-ss')))  s1 FROM DUAL
    </select>
    <select id="getUserupdatenianjiaTime2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date(#t4# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t5# , 'yyyy-mm-dd hh24-mi-ss')))  s2 FROM DUAL
    </select>
     <select id="getUserupdatenianjiaTime3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date(#t1# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t4# , 'yyyy-mm-dd hh24-mi-ss')))  s2 FROM DUAL
    </select>
     <select id="getUsershebaomanyinianTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date(#t4# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t2# , 'yyyy-mm-dd hh24-mi-ss')))  m1 FROM DUAL
    </select>
      <select id="getTime0"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
       select to_char(add_months(SYAHO_JIKAN,0),'yyyy-mm-dd') as t0 from TT_PERSONAL_BASIC_INFO where JN_CARD=#userId#
    </select>
     <select id="getTime1"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT ENTRY_TIME AS t1 from TT_PERSONAL_BASIC_INFO where JN_CARD=#userId#
    </select>
    <select id="getTime2"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">

 select to_char(add_months(SYAHO_JIKAN,12), 'yyyy-mm-dd') as t2 from
TT_PERSONAL_BASIC_INFO where JN_CARD=#userId#
    </select>
    <select id="getTime3"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
select to_char((add_months(trunc(sysdate, 'yyyy'), 12) - 1),'yyyy-mm-dd') as t3  from dual
    </select>
     <select id="getTime4"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
 select to_char	(sysdate , 'yyyy-mm-dd') as t4 FROM DUAL
    </select>
    <select id="getTime5"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
select to_char(trunc(sysdate,'yyyy'),'yyyy-mm-dd')  t5 FROM  DUAL
    </select>
     <select id="getUserrushemanshebaoTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date( #t1#, 'yyyy-mm-dd hh24-mi-ss') - To_date(#t2#, 'yyyy-mm-dd hh24-mi-ss')))  m2 FROM DUAL
    </select>

  <select id="getUserrushekuanianTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Float">
select ceil((To_date(#t3# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t1# , 'yyyy-mm-dd hh24-mi-ss')))  m3 FROM DUAL
    </select>



<select id="getUsershebaoshichangTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput"
        resultClass="java.lang.Integer">
select ceil((To_date(#t4# , 'yyyy-mm-dd hh24-mi-ss') - To_date(#t0# , 'yyyy-mm-dd hh24-mi-ss')))  m5

FROM DUAL

    </select>
    <select id="getUserCountSelect" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(USER_ID)
        FROM
        TT_VOCATION
        <dynamic prepend="WHERE">
            <isNotEmpty property="userSelectId">
                USER_ID = #userSelectId#
            </isNotEmpty>
            <!-- <isNotEmpty property="deptId" prepend=" AND "> USER_TYPE = #deptId#
                </isNotEmpty> -->
        </dynamic>
    </select>

    <select id="DeptIdforVocation"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06GetTypeListDto">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'A1'
    </select>

    <select id="UserTypeforVocation"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06GetTypeListDto">
        select kj_name,cd_code FROM TT_CODE where CD_KUBUN = 'A4'
    </select>
    <select id="selectRecforVocation" resultClass="java.lang.Integer">
        select count(1)
        FROM TT_VOCATION where USER_ID = #userId#
    </select>
<insert id="businessApplication1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        INSERT INTO TT_EVECTION_DATA (EVECTION_ID,USER_ID,
        USER_NAME, DEPT_ID, EVECTION_STARTTIME, EVECTION_ENDTIME,
        BUSINESS_DAYS, EVECTION_DESTINATION, EVECTION_REASON, CRE_DATETM,
        EXAMINE_STATUS,TJ_USER_ID,SEX,POSITION_ID,
        PROJECT_ID,DEPENDENCY,ID_CADE,DEPARTURE_TIME,PASSPORT,VISA,PASSPORT_ID,PASSPORT_VALIDITY,LEAVE,REACH_PLACE,
        NAME_PINYIN,TRAFFIC_RESERVE_PERSION,TRAFFIC_EXPLAIN,HOTEL_STARTTIME,HOTEL_ENDTIME,HOTEL_DESTINATION,HOTEL_PERSON,
        HOTEL_NUMBER,HOTEL_RESERVE_PERSION,HOTEL_EXPLAIN,ARTICLE_NAME,TRANSFER_STARTTIME,TRANSFER_ENDTIME,RECIPIENT,STORAGES,
        PASSPORT_LENGTH,ARTICLE_REMARK,EXAMINE_PERSON,PROJECT_NAME)
        VALUES(
        #evectionId#,
        #userId#,
        #userName#,
        #deptId#,
        #evectionStarttime#,
        #evectionEndtime#,
        #businessDays#,
        #evectionDestination#,
        #evectionReason#,
        sysDate,
        #examineStatus#,
        #tj_USER_ID#,
        #sex#,
        #position_ID#,
        #project_ID#,
        #dependency#,
        #id_CARD#,
        #departure_TIME#,
        #passport#,
        #visa#,
        #passport_ID#,
        #passport_VALIDITY#,
        #leave#,
        #reach_PLACE#,
        #name_PINYIN#,
        #traffic_RESERVE_PERSON#,
        #traffic_EXPLAIN#,
        #hotel_STARTTIME#,
        #hotel_ENDTIME#,
        #hotel_DESTINATION#,
        #hotel_PERSON#,
        #hotel_NUMBER#,
        #hotel_RESERVE_PERSON#,
        #hotel_EXPLAIN#,
        #article_NAME#,
        #transfer_STARTTIME#,
        #transfer_ENDTIME#,
        #recipient#,
        #storage#,
        #passport_LENGTH#,
        #article_REMARK#,
        #projectPm#,
        #project#)
    </insert>
    <insert id="inserVocation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIVocationInput">
        INSERT INTO TT_VOCATION
        (USER_ID,
        USER_NAME,
        USER_SEX,
        DEPT_ID,
        USER_TYPE,
        REMAIN_DAYS,
        ENTYR_TIME)VALUES
        (#userId#,
        #userName#,
        #userSex#,
        #deptId#,
        #userType#,
        #remainDays#,
        #entyrTime#
        )
    </insert>

    <!-- cheng -->
    <!-- 出張申請 -->
    <select id="getBusinessApplicatoin"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationOutput">
        SELECT DEPT_ID, EVECTION_STARTTIME, EVECTION_ENDTIME,
        EVECTION_DESTINATION, EVECTION_REASON,
        CRE_DATETM FROM TT_EVECTION_DATA
    </select>
    <insert id="businessApplication"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        INSERT INTO TT_EVECTION_DATA (EVECTION_ID,USER_ID,
        USER_NAME, DEPT_ID, EVECTION_STARTTIME, EVECTION_ENDTIME,
        BUSINESS_DAYS, EVECTION_DESTINATION, EVECTION_REASON, CRE_DATETM,
        EXAMINE_STATUS,TJ_USER_ID,SEX,POSITION_ID,
        PROJECT_ID,DEPENDENCY,ID_CADE,DEPARTURE_TIME,PASSPORT,VISA,PASSPORT_ID,PASSPORT_VALIDITY,LEAVE,REACH_PLACE,
        NAME_PINYIN,TRAFFIC_RESERVE_PERSION,TRAFFIC_EXPLAIN,HOTEL_STARTTIME,HOTEL_ENDTIME,HOTEL_DESTINATION,HOTEL_PERSON,
        HOTEL_NUMBER,HOTEL_RESERVE_PERSION,HOTEL_EXPLAIN,ARTICLE_NAME,TRANSFER_STARTTIME,TRANSFER_ENDTIME,RECIPIENT,STORAGES,
        PASSPORT_LENGTH,ARTICLE_REMARK,EXAMINE_PERSON,PROJECT_NAME)
        VALUES(
        #evectionId#,
        #userId#,
        #userName#,
        #deptId#,
        #evectionStarttime#,
        #evectionEndtime#,
        #businessDays#,
        #evectionDestination#,
        #evectionReason#,
        sysDate,
        #examineStatus#,
        #tj_USER_ID#,
        #sex#,
        #position_ID#,
        #project_ID#,
        #dependency#,
        #id_CARD#,
        #departure_TIME#,
        #passport#,
        #visa#,
        #passport_ID#,
        #passport_VALIDITY#,
        #leave#,
        #reach_PLACE#,
        #name_PINYIN#,
        #traffic_RESERVE_PERSON#,
        #traffic_EXPLAIN#,
        #hotel_STARTTIME#,
        #hotel_ENDTIME#,
        #hotel_DESTINATION#,
        #hotel_PERSON#,
        #hotel_NUMBER#,
        #hotel_RESERVE_PERSON#,
        #hotel_EXPLAIN#,
        #article_NAME#,
        #transfer_STARTTIME#,
        #transfer_ENDTIME#,
        #recipient#,
        #storage#,
        #passport_LENGTH#,
        #article_REMARK#,
        #examinePerson#,
        #project#)
    </insert>
    <insert id="businessApplicationGLB"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        INSERT INTO TT_EVECTION_DATA (EVECTION_ID,USER_ID,
        USER_NAME, DEPT_ID, EVECTION_STARTTIME, EVECTION_ENDTIME,
        BUSINESS_DAYS, EVECTION_DESTINATION, EVECTION_REASON, CRE_DATETM,
        EXAMINE_STATUS,TJ_USER_ID,SEX,POSITION_ID,
        PROJECT_ID,DEPENDENCY,ID_CADE,DEPARTURE_TIME,PASSPORT,VISA,PASSPORT_ID,PASSPORT_VALIDITY,LEAVE,REACH_PLACE,
        NAME_PINYIN,TRAFFIC_RESERVE_PERSION,TRAFFIC_EXPLAIN,HOTEL_STARTTIME,HOTEL_ENDTIME,HOTEL_DESTINATION,HOTEL_PERSON,
        HOTEL_NUMBER,HOTEL_RESERVE_PERSION,HOTEL_EXPLAIN,ARTICLE_NAME,TRANSFER_STARTTIME,TRANSFER_ENDTIME,RECIPIENT,STORAGES,
        PASSPORT_LENGTH,ARTICLE_REMARK,EXAMINE_PERSON,PROJECT_NAME)
        VALUES(
        #evectionId#,
        #userId#,
        #userName#,
        #deptId#,
        #evectionStarttime#,
        #evectionEndtime#,
        #businessDays#,
        #evectionDestination#,
        #evectionReason#,
        sysDate,
        #examineStatus#,
        #tj_USER_ID#,
        #sex#,
        #position_ID#,
        #project_ID#,
        #dependency#,
        #id_CARD#,
        #departure_TIME#,
        #passport#,
        #visa#,
        #passport_ID#,
        #passport_VALIDITY#,
        #leave#,
        #reach_PLACE#,
        #name_PINYIN#,
        #traffic_RESERVE_PERSON#,
        #traffic_EXPLAIN#,
        #hotel_STARTTIME#,
        #hotel_ENDTIME#,
        #hotel_DESTINATION#,
        #hotel_PERSON#,
        #hotel_NUMBER#,
        #hotel_RESERVE_PERSON#,
        #hotel_EXPLAIN#,
        #article_NAME#,
        #transfer_STARTTIME#,
        #transfer_ENDTIME#,
        #recipient#,
        #storage#,
        #passport_LENGTH#,
        #article_REMARK#,
        #projectPm#,
        #project#)
    </insert>


    <!-- 查看申请 -->
    <select id="getUsers"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISelectApplicationOutput">
        SELECT
        TED.EVECTION_ID as evectionId,
        TED.USER_ID as userId,
        TED.USER_NAME as userName,
        to_char(TED.EVECTION_STARTTIME,'YYYY-MM-DD') as evectionStartTime,
        to_char(TED.EVECTION_ENDTIME,'YYYY-MM-DD') as evectionEndTime,
        TED.BUSINESS_DAYS as businessDays,
        TED.EVECTION_DESTINATION as
        evectionDestination,
        TED.POSITION_ID as position_ID,
        TED.EVECTION_REASON as evectionReason,
        TED.CRE_DATETM as creDateTm,
        TCL.KJ_NAME as deptId,
        TC.KJ_NAME as
        examineStatus,
        TED.EXAMINE_PERSON as examinePerson
        FROM TT_EVECTION_DATA TED
        left join TT_CODE TC
        on
        TC.CD_CODE= TED.EXAMINE_STATUS
        left join TT_CODE TCL
        on TCL.CD_CODE=
        TED.DEPT_ID
        where USER_ID = #userId#
        order by case TED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TED.EVECTION_ID desc
        <!-- <dynamic prepend="WHERE "> <isNotEmpty property="userId"> USER_ID
            = #userId# </isNotEmpty> <isNotEmpty property="evectionId"> EVECTION_ID =
            #evectionId# </isNotEmpty> </dynamic> -->
    </select>



    <select id="deptType" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessDept">
        SELECT CD_CODE as deptId, KJ_NAME as deptName FROM TT_CODE
        WHERE CD_KUBUN='A1'
    </select>

    <select id="modifyUsers"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISelectApplicationOutput">
        SELECT
        TED.EVECTION_ID as evectionId,
        TED.USER_ID as userId,
        TED.USER_NAME as userName,
        TED.DEPT_ID as deptId,
        to_char(TED.EVECTION_STARTTIME,'YYYY-MM-DD') as evectionStartTime,
        to_char(TED.EVECTION_ENDTIME,'YYYY-MM-DD') as evectionEndTime,
        TED.BUSINESS_DAYS as businessDays,
        TED.EVECTION_DESTINATION as
        evectionDestination,
        TED.EVECTION_REASON as evectionReason,
        TED.CRE_DATETM as creDateTm,
        TT.KJ_NAME as deptName,
        TED.SEX as sex,
        TED.EXAMINE_STATUS as examine_STATUS,
        TS.POSITION as
        position_ID,
        TED.PROJECT_NAME as project,
        TED.PROJECT_ID as project_ID,
       <!--  decode(TS.PROJECT_ID,'SL1','大宇宙内部系统',
        'SL2','国内project',
        'SL3','WEB前端')  as project, -->
        TED.DEPENDENCY as dependency,
        TED.ID_CADE as id_CARD,
        to_char(TED.DEPARTURE_TIME,'YYYY-MM-DD') as departure_TIME,
        TED.PASSPORT as passport,
        TED.VISA as visa,
        TED.PASSPORT_ID as
        passport_ID,

        to_char(TED.PASSPORT_VALIDITY,'YYYY-MM-DD') as passport_VALIDITY,
        TED.LEAVE as leave,
        TED.REACH_PLACE as reach_PLACE,
        TED.NAME_PINYIN as name_PINYIN,
        TED.TRAFFIC_RESERVE_PERSION as
        traffic_RESERVE_PERSON,
        TED.TRAFFIC_EXPLAIN as traffic_EXPLAIN,
        to_char(TED.HOTEL_STARTTIME,'YYYY-MM-DD') as hotel_STARTTIME,
        to_char(TED.HOTEL_ENDTIME,'YYYY-MM-DD') as hotel_ENDTIME,
        TED.HOTEL_DESTINATION as hotel_DESTINATION,
        TED.HOTEL_PERSON as hotel_PERSON,
        TED.HOTEL_NUMBER as hotel_NUMBER,
        TED.HOTEL_RESERVE_PERSION as hotel_RESERVE_PERSON,
        TED.HOTEL_EXPLAIN as
        hotel_EXPLAIN,
        TED.ARTICLE_NAME as article_NAME,
        to_char(TED.TRANSFER_STARTTIME,'YYYY-MM-DD')
        as transfer_STARTTIME,
        to_char(TED.TRANSFER_ENDTIME,'YYYY-MM-DD') as transfer_ENDTIME,
        TED.RECIPIENT as recipient,
        TED.STORAGES as storage,
        TED.PASSPORT_LENGTH as passport_LENGTH,
        TED.ARTICLE_REMARK as
        article_REMARK,
        TPBI.TJ_CARD as tj_USER_ID,
        TS.LEADER AS projectPm,
        TED.EXAMINE_PERSON as examinePerson
        FROM TT_EVECTION_DATA TED
        left
        join TT_CODE TT
        on TT.CD_CODE =
        TED.DEPT_ID
        left join TT_SYS_USER TS
        on
        TED.USER_ID = TS.USER_ID
        left join
        TT_PERSONAL_BASIC_INFO  TPBI on
        TPBI.JN_CARD = TS.USER_ID
        <dynamic prepend="WHERE ">
            <isNotEmpty property="evectionId">
                EVECTION_ID = #evectionId#
            </isNotEmpty>
        </dynamic>
    </select>

    <select id="compareDate" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationOutput">
        SELECT EVECTION_STARTTIME AS evectionStarttime,
        EVECTION_ENDTIME AS
        evectionEndtime,EXAMINE_STATUS as examine_STATUS FROM TT_EVECTION_DATA WHERE USER_ID
        = #userId# and (EXAMINE_STATUS='A04'OR EXAMINE_STATUS='A06'OR EXAMINE_STATUS='A01')
    </select>

    <select id="selectDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationOutput">
        SELECT EVECTION_STARTTIME AS evectionStarttime,
        EVECTION_ENDTIME AS evectionEndtime
        FROM TT_EVECTION_DATA WHERE USER_ID
        = #userId# AND
        EVECTION_ID != #evectionId# and (EXAMINE_STATUS='A04'OR EXAMINE_STATUS='A05'OR EXAMINE_STATUS='A07')
    </select>

    <select id="businessLogin" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        select
        TS.LEADER as projectPm,
        TT.KJ_NAME as deptName,
        TT.CD_CODE as deptId,
        TS.POSITION as position_ID,
        TS.PROJECT_ID AS project_ID,
        decode(ts.PROJECT_ID,'SL1','大宇宙内部系统',
        'SL2','国内project',
        'SL3','WEB前端')  as project,
        TPBI.SEX as sex,
        TPBI.TJ_CARD as tj_USER_ID
        from TT_SYS_USER TS left join TT_CODE TT
        on TS.DEPT_ID = TT.CD_CODE left join
        TT_PERSONAL_BASIC_INFO  TPBI on
        TPBI.JN_CARD = TS.USER_ID
        where TT.CD_KUBUN = 'A1' AND TS.USER_ID =
        #userId#
    </select>
    <insert id="insertmonths"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        INSERT INTO TT_EVECTION_DATA1(
       EVECTION_ID,IN_MONTH)VALUES(
        #evectionId#,#in_month#)
    </insert>
    <select id="businessUser" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        select
        USER_ID as userId,
        USER_NAME as userName,
        LEADER as projectPm,
        TS.POSITION as position_ID,
        TS.PROJECT_ID as project_ID,
        TPBI.SEX as sex,
        TPBI.TJ_CARD as tj_USER_ID,
        FL_FUNC_USE as flag
        from TT_SYS_USER TS
        join
        TT_PERSONAL_BASIC_INFO TPBI
        on TPBI.JN_CARD=TS.USER_ID
         where USER_ID = #userId#

    </select>

    <select id="getMaxEvectionId" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select max(EVECTION_ID) as evectionId from
        TT_EVECTION_DATA
    </select>

    <select id="getApplicationCount" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(USER_ID)
        FROM
        TT_EVECTION_DATA
        where USER_ID =
        #userId#
    </select>

    <!-- 修改申请 -->
    <update id="saveApplication"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">
        update TT_EVECTION_DATA set DEPT_ID = #deptId#,
        EVECTION_STARTTIME =
        #evectionStarttime#,
        EVECTION_ENDTIME =
        #evectionEndtime#,
        EVECTION_DESTINATION = #evectionDestination#,
        EVECTION_REASON =
        #evectionReason#,
        BUSINESS_DAYS = #businessDays#,
        SEX = #sex#,
       <!--  EXAMINE_PERSON = #examinePerson#, -->
        POSITION_ID = #position_ID#,
        PROJECT_NAME = #project#,
        PROJECT_ID = #project_ID#,
        DEPENDENCY = #dependency#,
        ID_CADE = #id_CARD#,
        DEPARTURE_TIME = #departure_TIME#,
        PASSPORT = #passport#,
        VISA = #visa#,
        PASSPORT_ID = #passport_ID#,
        LEAVE = #leave#,
        REACH_PLACE = #reach_PLACE#,
        NAME_PINYIN = #name_PINYIN#,
        TRAFFIC_RESERVE_PERSION = #traffic_RESERVE_PERSON#,
        TRAFFIC_EXPLAIN = #traffic_EXPLAIN#,
        HOTEL_STARTTIME = #hotel_STARTTIME#,
        HOTEL_ENDTIME = #hotel_ENDTIME#,
        HOTEL_DESTINATION = #hotel_DESTINATION#,
        HOTEL_PERSON = #hotel_PERSON#,
        HOTEL_NUMBER = #hotel_NUMBER#,
        HOTEL_RESERVE_PERSION = #hotel_RESERVE_PERSON#,
        HOTEL_EXPLAIN = #hotel_EXPLAIN#,
        ARTICLE_NAME = #article_NAME#,
        TRANSFER_STARTTIME = #transfer_STARTTIME#,
        TRANSFER_ENDTIME = #transfer_ENDTIME#,
        RECIPIENT = #recipient#,
        STORAGES = #storage#,
        PASSPORT_LENGTH = #passport_LENGTH#,
        ARTICLE_REMARK = #article_REMARK#
        where EVECTION_ID = #evectionId#
    </update>
    <delete id="deleteApplication"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">

        delete from TT_EVECTION_DATA where
        EVECTION_ID =
        #evectionId#

    </delete>
        <delete id="deletemonths"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessApplicationInput">

        delete from TT_EVECTION_DATA1 where
        EVECTION_ID =
        #evectionId#

    </delete>

    <!--个人情報登録 -->
    <insert id="loginPersonalInfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">
           insert into TT_PERSONAL_BASIC_INFO(
        TJ_CARD,
        JN_CARD,
        USERNAME,
        SEX,
        BIRTHDAR,
        NATION,
        ID_CARD,
        BORN_IN,
        ADDRESS,
        TELEPHONE,
        EMERG_CONTACT,
        EMERG_CONTACT_TEL,
        DEPARTMENT,
        POSITION,
        ENTRY_TIME,
        MARITAL_STATUS,
        EDUCATION,
        NATIONALITY,
        JP_NAME,
        PERSONAL_MALL,
        OFFIC_MAIL,
        TECH_CAPABILITY,
        PASSPORT,
        VISA,
        VACA_QUALI,
        WORK_EXPERIENCE,
        PHOTO_PATH,
        SPECIALTY,
        TOTOKU_TIMESTAMP,
        KOSHIN_TIMESTAMP,
        SYAHO_JIKAN,
        OUT_TIME,
        TOTOKU_USER,
        TOTOKU_PGM，
        KOSHIN_USER，
        KOSHIN_PGM
        ) values (
        #tj_Card#,
        #jn_Card#,
        #userName#,
        #sex#,
        #birthday#,
        #nation#,
        #id_Card#,
        #born_In#,
        #address#,
        #telephone#,
        #emerg_Contact#,
        #emerg_Contact_tel#,
        #department#,
        #position#,
        #entry_Time#,
        #marital_Status#,
        #education#,
        #nationality#,
        #jn_Name#,
        #pesonal_Mall#,
        #offic_Mail#,
        #tech_capability#,
        #passport#,
        #visa#,
        #vaca_quali#,
        #work_Experience#,
        #photo_Path#,
        #specialty#,
        sysdate,
        sysdate,
        #socialSecurity#,
        #out_Time#,
        #userId#,
        #userId#,
        #userId#,
        #userId#
        )

    </insert>

    <!--職業資格登録 -->
    <insert id="loginPersonalInfoOccupation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into TT_VOCATIONAL_QUALI(
        TJ_CARD,
        JN_CARD,
        WINNING_DATE,
        WINNING_CERTIFICATE,
        TOTOKU_TIMESTAMP
        )values(
        #tj_Card#,
        #jn_Card#,
        #winning_date#,
        #wining_certificate#,
        #login_time#
        )

    </insert>

    <!--个人履歴登録 -->
    <insert id="loginPersonalInfoWorkExperience"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into TT_WORK_EXPERIENCE(
        TJ_CARD,
        JN_CARD,
        ORDER_NO,
        CAREERS_TYPE,
        PROJ_NAME,
        ATTEND_NM,
        ATTEND_MONTH,
        ATTEND_STATES,
        DEVELOP_PHASE,
        FIRM_CONTENT,
        LANG_TOOL,
        DATA_BASE,
        TECHNICAL_SYS,
        MODEL_DEVICE,
        DEVELOP_PERIOD,
        TOTAL_PERIOD,
        TOTOKU_TIMESTAMP
        )values(
        #tj_Card#,
        #jn_Card#,
        #order_no#,
        #careers_type#,
        #proj_name#,
        #attend_nm#,
        #attend_month#,
        #attend_states#,
        #develop_phase#,
        #firm_content#,
        #lang_tool#,
        #data_base#,
        #technical_sys#,
        #model_device#,
        #develop_period#,
        #total_period#,
        #login_time#
        )

    </insert>

    <!--ユーザ表登録 -->
    <insert id="loginPersonalUser"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

       insert into TT_SYS_USER(
        USER_ID,
        USER_NAME,
        USER_PASSWORD,
        FL_FUNC_USE,
        DEPT_ID,
        TOROKU_TIMESTAMP,
        KOSHIN_TIMESTAMP,
        POSITION,
        LEADER,
        DEPT_PERSON,
        PROJECT_ID,
        TOROKU_USER,
        TOROKU_PGM,
        KOSHIN_USER,
        KOSHIN_PGM
        )values(
        #jn_Card#,
        #userName#,
        #password#,
        '6',
        #department#,
        sysdate,
        sysdate ,
        #position#,
        #leader#,
        #deptPerson#,
        'SL1',
        #userId#,
        #userId#,
        #userId#,
        #userId#
        )


    </insert>


    <!-- 指定したCARDのユーザを取得する -->
    <select id="getUser"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.SelectCardOutput">
        SELECT JN_CARD, TJ_CARD FROM TT_PERSONAL_BASIC_INFO WHERE
        JN_CARD =
        #jn_Card# OR TJ_CARD = #tj_Card#
    </select>
	<select id="getUser1"
	        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput"
	        resultClass="java.lang.String">
	        SELECT COUNT(*) FROM TT_PERSONAL_BASIC_INFO WHERE
	        JN_CARD =
	        #jn_Card# OR TJ_CARD = #tj_Card#
	    </select>
 <!-- =================================Attendance05================================================== -->
    <select id="getUserInfoforAttendance05" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Attendance06SelectRecOutput">
        select
        user_id,
        user_name ,
        dept_id,
        leader
        from TT_SYS_USER
        WHERE user_id = #user_id#
    </select>

    <select id="getDeptnameforAttendance05" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
        kj_name
        from TT_CODE
        WHERE CD_KUBUN = 'A1' and
        CD_CODE=#dept_id#
    </select>

      <select id="SelectUpdateAttendance05"
       parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Attendance06SelectRecOutput">
        select   to_char(tai.START_TIME_ADD,'yyyy/mm/dd  hh24:mi:ss') as start_time_add,
        to_char(tai.END_TIME_ADD,'yyyy/mm/dd  hh24:mi:ss') as end_time_add,
        tai.RETROACTIVE_ID as retroactive_id,
        tai.RETROACTIVE_REASON as retroactive_reason,
        tai.RETROACTIVE_TYPE as retroactive_type,
        tai.REASON_TYPE as reason_type,
		tai.TENPU_PATH as fileName
        from TT_ADDSIGN_INFO tai
        where JN_CARD =#user_id#  and to_char(tai.UPD_TIME,'yyyy/mm/dd hh24:mi:ss') = #sub_time#
    </select>

    <select id="getMaxAttenManagerCount" resultClass="java.lang.Integer">
        select
        max(ATTENDANCE_ID+1) from TT_ATTENCE_MANAGER_TEMP
    </select>

    <insert id="insertRec1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        INSERT INTO TT_ADDSIGN_INFO(
        RETROACTIVE_ID,
        JN_CARD,
        RETROACTIVE_TYPE,
        RETROACTIVE_PERSON,
        SUB_TIME,
        UPD_TIME,
        RETROACTIVE_REASON,
        START_TIME_ADD,
        RETROACTIVE_SYSTIME,
        REASON_TYPE,

        RETROACTIVE_STATUS,
         TENPU_PATH
        ) VALUES(
        #retroactive_id#,
        #user_id#,
        #retroactive_type#,
        #leader#,
        TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS'),
        TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS'),
        #retroactive_reason#,
        #start_time_add#,
        #start_time_add#,
         #reason_type#,

        #retroactive_status#,
           #tenpu_path#
        )
    </insert>
    <insert id="insertRec2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        INSERT INTO TT_ADDSIGN_INFO(
        RETROACTIVE_ID,
        JN_CARD,
        RETROACTIVE_TYPE,
        RETROACTIVE_PERSON,
        SUB_TIME,
        UPD_TIME,
        RETROACTIVE_REASON,
        END_TIME_ADD,
        RETROACTIVE_SYSTIME,

         REASON_TYPE,
        RETROACTIVE_STATUS,
        TENPU_PATH
        ) VALUES(
        #retroactive_id#,
        #user_id#,
        #retroactive_type#,
        #leader#,
        TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS'),
        TO_CHAR(SYSDATE,'YY/MM/DD
        HH24:MI:SS'),
        #retroactive_reason#,
        #end_time_add#,
        #end_time_add#,
         #reason_type#,

        #retroactive_status#,
             #tenpu_path#
        )
    </insert>
    <insert id="insertRec3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        INSERT INTO TT_ADDSIGN_INFO(
        RETROACTIVE_ID,
        JN_CARD,
        RETROACTIVE_TYPE,
        RETROACTIVE_PERSON,
        SUB_TIME,
        UPD_TIME,
        RETROACTIVE_REASON,
        START_TIME_ADD,
        END_TIME_ADD,
        RETROACTIVE_SYSTIME,
         REASON_TYPE,

        RETROACTIVE_STATUS,
          TENPU_PATH
        )
        VALUES(
        #retroactive_id#,
        #user_id#,
        #retroactive_type#,
        #leader#,
        TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS'),
        TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS'),
        #retroactive_reason#,
        #start_time_add#,
        #end_time_add#,
        #start_time_add#,
         #reason_type#,

        #retroactive_status#,
          #tenpu_path#
        )
    </insert>
    <update id="updateRec1"
                  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        update TT_ADDSIGN_INFO set
        START_TIME_ADD = #start_time_add#,
        END_TIME_ADD = '',
        RETROACTIVE_TYPE = #retroactive_type#,
        RETROACTIVE_REASON = #retroactive_reason#,
        TENPU_PATH=#tenpu_path#,
        REASON_TYPE = #reason_type#,
        UPD_TIME = TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS')
        where RETROACTIVE_ID = #retroactive_id#
    </update>
    <update id="updateRec2"
                  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        update TT_ADDSIGN_INFO set
         START_TIME_ADD = '',
        END_TIME_ADD = #end_time_add#,
        RETROACTIVE_TYPE = #retroactive_type#,
        RETROACTIVE_REASON = #retroactive_reason#,
        TENPU_PATH=#tenpu_path#,
        REASON_TYPE = #reason_type#,
		UPD_TIME = TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS')
        where RETROACTIVE_ID = #retroactive_id#
    </update>
    <update id="updateRec3"
                  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        update TT_ADDSIGN_INFO set
        START_TIME_ADD = #start_time_add#,
        END_TIME_ADD = #end_time_add#,
        RETROACTIVE_TYPE = #retroactive_type#,
        RETROACTIVE_REASON = #retroactive_reason#,
        TENPU_PATH=#tenpu_path#,
        REASON_TYPE = #reason_type#,
        UPD_TIME = TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS')
        where RETROACTIVE_ID = #retroactive_id#
    </update>

    <select id="getMaxId" resultClass="java.lang.Integer">
        select
        max(cast(substr(RETROACTIVE_ID,2,length(RETROACTIVE_ID)) as int)) from
        TT_ADDSIGN_INFO
    </select>

    <select id="getTypeList" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06GetTypeListDto">
        select CD_CODE,KJ_NAME from TT_CODE where CD_KUBUN='A8' and CD_CODE in (1,2,3)
    </select>
    <select id="getTypeList02" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06GetTypeListDto">
        select CD_CODE,KJ_NAME from TT_CODE where CD_KUBUN='A8' and CD_CODE in (4,5)
    </select>

    <select id="getRetroactivePerson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
        select USER_NAME from TT_SYS_USER where USER_ID=#userId#
    </select>

    <select id="getRetroactiveTypeName"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
        select KJ_NAME from TT_CODE where
        CD_CODE=#retroactive_type#
    </select>

    <select id="getJNTCIAttendance05selectCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
         select count(1) from TT_ADDSIGN_INFO tai  WHERE tai.JN_CARD =  #user_id#
    </select>

    <select id="getJNTCIAttendance05select"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Attendance06SelectRecOutput">
          select tai.JN_CARD as user_id,
        to_char(tai.START_TIME_ADD,'yyyy/mm/dd  hh24:mi:ss') as start_time,
        to_char(tai.END_TIME_ADD,'yyyy/mm/dd  hh24:mi:ss') as end_time,
        tai.RETROACTIVE_REASON as retroactive_reason,
        tai.RETROACTIVE_PERSON as retroactive_person,
        tenpu_path,
        tai.RETROACTIVE_STATUS as status_value,
        to_char(tai.UPD_TIME,'yyyy/mm/dd hh24:mi:ss') as sub_time,
         tc.kj_name as retroactive_type,

        tpbi.USERNAME as name,
         tc1.KJ_NAME  as retroactive_status
         from TT_ADDSIGN_INFO tai
        inner join TT_PERSONAL_BASIC_INFO tpbi on
        tai.JN_CARD = tpbi.JN_CARD
         inner join tt_code tc on
         tc.CD_CODE = tai.RETROACTIVE_TYPE and tc.CD_KUBUN='A8'
        inner join tt_code tc1 on
        tc1.CD_CODE = tai.RETROACTIVE_STATUS and tc1.CD_KUBUN='B2'
         WHERE tai.JN_CARD =#user_id#
        order by case tai.RETROACTIVE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end，tai.UPD_TIME desc
    </select>

<select id="getJNTCIAttendance05CheckRec"
        resultClass="java.lang.Integer">
        select count(HIDUKE) from TT_ATTENCE_MANAGER
        where JN_CARD =#user_id# AND
        (HIDUKE=#ST# OR HIDUKE=#NT#)
    </select>
    <!-- <select id="getJNTCIAttendance05CheckRec1"
        resultClass="java.lang.Integer">
        select count(START_TIME) from TT_ATTENCE_MANAGER
        where JN_CARD =#user_id# AND
        HIDUKE=#ST#
    </select>
     <select id="getJNTCIAttendance05CheckRec2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.Integer">
        select count(END_TIME) from TT_ATTENCE_MANAGER
        where JN_CARD =#user_id# AND
        HIDUKE=#NT#
     </select> -->
     <select id="getJNTCIAttendance05CheckTimeCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.Integer">
        select TIME_COUNT from TT_ATTENCE_MANAGER
        where JN_CARD =#user_id# AND
        (HIDUKE=#ST# OR HIDUKE=#NT#)
     </select>
     <select id="getJNTCIAttendance05CheckTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
        select START_TIME as check_time from TT_ATTENCE_MANAGER
        where JN_CARD =#user_id# AND
        (HIDUKE=#ST# OR HIDUKE=#NT#)
     </select>
     <select id="getJNTCIAttendance05CheckTime1"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
                resultClass="java.lang.String">
                select END_TIME as check_time from TT_ATTENCE_MANAGER
                where JN_CARD =#user_id# AND
                (HIDUKE=#ST# OR HIDUKE=#NT#)
    </select>

    <select id="getJNTCIAttendance05CheckCheckInsert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.Integer">
        select count(1) from TT_ADDSIGN_INFO tai
        where
        tai.JN_CARD =#user_id#
        and
        tai.RETROACTIVE_TYPE=#retroactive_type#
        <isNotEmpty prepend="and" property="start_time_add">
            to_char(tai.START_TIME_ADD,'YYYY-MM-DD HH24:MI:SS') =
            #start_time_add#
        </isNotEmpty>
        <isNotEmpty prepend="and" property="end_time_add">
            to_char(tai.END_TIME_ADD,'YYYY-MM-DD HH24:MI:SS') = #end_time_add#
        </isNotEmpty>
        and tai.RETROACTIVE_REASON=#retroactive_reason#
    </select>

    <select id="getJNTCIAttendance05StatusResult"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
         select tai.RETROACTIVE_STATUS from
         TT_ADDSIGN_INFO tai
        where tai.JN_CARD =#user_id# and
        (to_char(tai.RETROACTIVE_SYSTIME,'YYYY-MM-DD')= to_char(SUBSTR(#start_time_add#,1,10))
        OR to_char(tai.RETROACTIVE_SYSTIME,'YYYY-MM-DD')= to_char(SUBSTR(#end_time_add#,1,10)))
    </select>

   <select id="getRertoactiveRec"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.Integer">
        select count(1) from TT_ADDSIGN_INFO where
        JN_CARD
        =#user_id# and
        to_char(START_TIME_ADD,'YYYY/MM/DD')= #ST# and (RETROACTIVE_STATUS='A04'
        or RETROACTIVE_STATUS='A06' or RETROACTIVE_STATUS='A01' or RETROACTIVE_STATUS='A08')
    </select>
    <select id="getRertoactiveRec1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.Integer">
        select count(1) from TT_ADDSIGN_INFO where
        JN_CARD
        =#user_id# and
        to_char(END_TIME_ADD,'YYYY/MM/DD')= #NT# and (RETROACTIVE_STATUS='A04'
        or RETROACTIVE_STATUS='A06' or RETROACTIVE_STATUS='A01' or RETROACTIVE_STATUS='A08')
    </select>

    <select id="getStatusCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
        select MAX(cast(EXAMINE_ID as int)+1) from TT_AUDIT_STATUS
    </select>

    <delete id="deleteRecforAttendance05"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input">
        delete from TT_ADDSIGN_INFO where
        TO_CHAR(UPD_TIME,'YYYY/MM/DD HH24:MI:SS')
        = #sub_time#
        and
        JN_CARD=#user_id#
    </delete>

    <!-- =================================Attendance05================================================== -->



    <select id="getMTRRemark"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingInquireInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingInquireInfo">

        select
        ROOM_NO,ROOM_NAME,USERNAME,JN_CARD,START_TIME,END_TIME,APPLY_TIME,REMARK
        from TT_MEETING_REMARK where 1 = 1
        <dynamic>
            <isNotEmpty prepend="AND" property="room_no_serch">
                ROOM_NO = #room_no_serch#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="room_name">
                ROOM_NAME = #room_name#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="jn_card_serch">
                JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="start_time_serch">
                <![CDATA[
                    START_TIME >= #start_time_serch#
                ]]>
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="end_time_serch">
                <![CDATA[
                    END_TIME <= #end_time_serch#
                ]]>
            </isNotEmpty>
        </dynamic>
        ORDER BY ROOM_NO ASC,START_TIME DESC

    </select>

    <delete id="deleteMTRRemark"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingInquireInput">

        delete from TT_MEETING_REMARK where
        ROOM_NO = #room_no#
        and START_TIME = #start_time#

    </delete>

    <select id="getMTRRemarkCount" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(*)
        FROM
        TT_MEETING_REMARK where 1 = 1
        <dynamic>
            <isNotEmpty prepend="AND" property="room_no_serch">
                ROOM_NO = #room_no_serch#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="room_name">
                ROOM_NAME = #room_name#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="jn_card_serch">
                JN_CARD = #jn_card_serch#
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="start_time_serch">
                <![CDATA[
                    START_TIME >= #start_time_serch#
                ]]>
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="end_time_serch">
                <![CDATA[
                    END_TIME <= #end_time_serch#
                ]]>
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="findUserByCard" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT USER_NAME FROM TT_SYS_USER WHERE USER_ID = #jnCard#
    </select>

    <select id="findRoomNameByNo" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT KJ_NAME AS roomName FROM TT_CODE WHERE CD_CODE =
        #roomNo#
    </select>

    <!-- 通过卡号查询邮件名 -->
      <select id="findOfficEmail" parameterClass="java.lang.String"
            resultClass="java.lang.String">
            SELECT OFFIC_MAIL FROM TT_PERSONAL_BASIC_INFO WHERE JN_CARD =
            #jnCard#
      </select>

        <!--會議室一覽 通過會議室番號查詢時間 -->
    <select id="selectTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingSelectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingSelectOutput">
        SELECT START_TIME as startTime, END_TIME as
        endTime,APPLY_TIME as
        applyTime,round(to_number(TO_DATE(END_TIME,'yyyy-mm-dd
        hh24:mi:ss')-TO_DATE(START_TIME,'yyyy-mm-dd hh24:mi:ss'))*1440) as
        minite
        FROM TT_MEETING_REMARK WHERE TO_DATE(END_TIME,'yyyy-mm-dd hh24:mi:ss') > sysdate AND ROOM_NO =
        #roomNo#
        ORDER BY START_TIME
    </select>


      <insert id="insertRecord"
      parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingApplyInput">
            INSERT INTO TT_MEETING_REMARK(
            JN_CARD,
            ROOM_NO,
            ROOM_NAME,
            REMARK,
            APPLY_TIME,
            USERNAME,
            START_TIME,
            END_TIME,
          TO_ID
          )VALUES(
          #jnCard#,
          #roomNo#,
          #roomName#,
          #remark#,
          #applyTime#,
          #username#,
          #startTime#,
          #endTime#,
          #toId#
          )
      </insert>


    <select id="findUseTimeByRoomNo" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingApplyOutput">
        SELECT START_TIME AS startTime,END_TIME AS endTime FROM
        TT_MEETING_REMARK WHERE ROOM_NO = #roomNo#
    </select>



  <insert id="JNTCIEquip01"
         parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip01Input">
         INSERT INTO TT_SETSUBI_SHINSEI(SHINSEI_NO,
        SHINSEI_USER,SHINSEI_KUBUN,SETSUBI_KUBUN,SHINSEI_JYOUTAI
        ,SHINSEI_HIDUKE,SHINSEI_RIYU,SHINSEI_BUMON,ITEM_NAME,ITEM_NUMBER,SHINSA_NO)
        values(#shinseiNo#,#userId#
        ,'5','HKA','0',#shinsei_hiduke#,#reason#,#deptName#,#aitemuName#
        ,#aitemuNumber#,#shinsaNo#)
    </insert>
    <select id="getShinseiMaxNo" resultClass="java.lang.String">
       SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI
    </select>
    <select id="getShinsaMaxNo" resultClass="java.lang.String">
       SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA
    </select>
 <insert id="insertShinsaMaxNo"
       parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip01Input">
        INSERT INTO TT_SETSUBI_SHINSA(SHINSA_NO,
        SHINSA_JYOUTAI,SHINSA_HIDUKE,SHINSASYA)
        values(#shinsaNo#,'B03','','--')
    </insert>
 <!--設備購入申請用  -->

    <!-- JNTCIEquip02 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ -->
    <select id="getDeptJNTCIEquip02"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02dept"
        parameterClass="java.lang.String">
        select TT.KJ_NAME as
        deptName,TT.CD_CODE as dept from
        TT_SYS_USER TS left join TT_CODE TT
        on TS.DEPT_ID = TT.CD_CODE where
        TT.CD_KUBUN = 'A1' AND TS.USER_ID =
        #JN_CARD#
    </select>
    <select id="getEquipJNTCIEquip02"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">
        SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND
        C.CD_KUBUN='B0' and s.SETSUBI_SYURUI = #typeTemp# and
        s.SETSUBI_JYOUTAI='1'
    </select>
    <select id="getEquipJNTCIEquip04"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">
        SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND
        C.CD_KUBUN='B0' and s.SETSUBI_KUBEN = #typeTemp# and
        s.SETSUBI_JYOUTAI='2' and s.HOYUSHA=#hoyusha#
    </select>
    <select id="getEquipJNTCIBack"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equip">
        SELECT S.SETSUBI_NO AS equipID,C.KJ_NAME AS equipName FROM
        TT_SETSUBI_HYOU S,TT_CODE C WHERE S.SETSUBI_SYURUI=C.CD_CODE
        AND
        C.CD_KUBUN='B0' and s.SETSUBI_SYURUI = #typeTemp# and
        s.SETSUBI_STATE='2'
    </select>

    <select id="getEquipTypeJNTCIEquip02"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEquip02equipType">
        SELECT CD_CODE AS equipTypeID, KJ_NAME AS equipTypeName
        FROM TT_CODE WHERE CD_KUBUN = 'B0'
    </select>


     <insert id="insertEquipRequireJNTCIEquip02"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">
        INSERT INTO TT_SETSUBI_SHINSEI (SHINSEI_NO,SHINSEI_BUMON,SHINSEI_USER,
        SETSUBI_KUBUN,SETSUBI_NO,SHINSEI_KUBUN,SHINSEI_JYOUTAI,SHINSEI_RIYU,SHINSA_NO,SHINSEI_HIDUKE
        )
        values((SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI),(SELECT DEPT_ID FROM  TT_SYS_USER WHERE USER_ID=#id#),#id#,#equipType#,#equip#,#koshinPGM#,'0',#reason#,(SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA),#time1#)
    </insert>
    <insert id="insertEquipShinsaNo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">
        INSERT INTO TT_SETSUBI_SHINSA(SHINSA_NO,
        SHINSA_JYOUTAI,SHINSA_HIDUKE,SHINSASYA)
        values((SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA),'B03','','--')
    </insert>



    <insert id="insertEquipApplyJNTCIEquip02"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">
        insert into
        tt_setsubi_apply(apply_no,apply_dept_id,apply_setsubi_kuben,apply_user_id,apply_state)
        values((SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI),#dept1#,#type#,#cardnumber#,#state#)

    </insert>



<select id="JNTCIEquip02CancelCount"
              parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
              resultClass="java.lang.Integer">
select COUNT(*) from TT_SETSUBI_SHINSEI
 WHERE
    SHINSEI_JYOUTAI='0'
AND SETSUBI_KUBUN=#equipType#
AND SETSUBI_NO=#equip#
</select>




<insert id="JNTCIEquip05insert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">

INSERT INTO TT_SETSUBI_SHINSEI (SHINSEI_NO,SHINSEI_BUMON,SHINSEI_USER,
        SETSUBI_KUBUN,SETSUBI_NO,SHINSEI_KUBUN,SHINSEI_JYOUTAI,SHINSEI_RIYU,SHINSA_NO,SETSUBI_JYOUTAI,SHINSEI_HIDUKE
        )
        values((SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI),(SELECT DEPT_ID FROM  TT_SYS_USER WHERE USER_ID=#id#),#id#,#equipType#,#b#,#koshinPGM#,'0',#reason#,(SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA),'1',#time1#)
</insert>

    <update id="JNTCIEquip02ChangeState"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">
UPDATE
TT_SETSUBI_HYOU
SET
SETSUBI_JYOUTAI='0',
TANAOROSHI_DATE=#koshinTimestamp#,
HOKANBASHO='倉庫'
WHERE
    SETSUBI_JYOUTAI='1'
AND  SETSUBI_NO=#equip#
AND SETSUBI_SYURUI=#equipType#
</update>

 <select id="JNTCIEquip02ChangeStateCount"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_HYOU
WHERE
    SETSUBI_JYOUTAI='0'
AND SETSUBI_NO=#equip#
AND SETSUBI_SYURUI=#equipType#
</select>
<select id="JNTCIEquip02ChangeStateCount1"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_HYOU
WHERE
    SETSUBI_JYOUTAI='1'
AND USER_ID=#id#
AND SETSUBI_SYURUI=#equipType#
</select>
<select id="JNTCIEquip02ChangeStateCount2"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SHINSEI_USER=#id#
AND
    SHINSEI_JYOUTAI='0'
AND SHINSEI_KUBUN='2'
AND SETSUBI_KUBUN=#equipType#
</select>
<select id="JNTCIEquip02ChangeStateCount3"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SHINSEI_USER=#id#
    AND SHINSEI_JYOUTAI='0'
AND SHINSEI_KUBUN='3'
AND SETSUBI_KUBUN=#equipType#
AND SETSUBI_NO=#b#
</select>
<select id="JNTCIEquip02ChangeStateCount33"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SHINSEI_USER=#id#
AND     SHINSEI_JYOUTAI='0'
AND SHINSEI_KUBUN='4'
AND SETSUBI_KUBUN=#equipType#
AND SETSUBI_NO=#b#
</select>
<select id="JNTCIEquip02ChangeStateCount4"
                parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input"
                resultClass="java.lang.Integer">
SELECT COUNT(* ) FROM  TT_SETSUBI_SHINSEI
WHERE
SHINSEI_USER=#id#
AND SHINSEI_JYOUTAI='0'
AND SHINSEI_KUBUN='4'
AND SETSUBI_KUBUN=#equipType#
</select>


    <insert id="JNTCIEquip04insert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEquip02Input">

INSERT INTO TT_SETSUBI_SHINSEI (SHINSEI_NO,SHINSEI_BUMON,SHINSEI_USER,
        SETSUBI_KUBUN,SETSUBI_NO,SHINSEI_KUBUN,SHINSEI_JYOUTAI,SHINSEI_RIYU,SHINSA_NO,SETSUBI_JYOUTAI,SHINSEI_HIDUKE
        )
        values((SELECT MAX(SHINSEI_NO+1) from TT_SETSUBI_SHINSEI),(SELECT DEPT_ID FROM  TT_SYS_USER WHERE USER_ID=#id#),#id#,#equipType#,#b#,#koshinPGM#,'0',#reason#,(SELECT MAX(SHINSA_NO+1) from TT_SETSUBI_SHINSA),'1',#time1#)
</insert>

    <!-- ==========================attendanceLeave01=============================================== -->
    <!-- 查询个人信息四条信息 -->
    <select id="leave" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select
        TS.USER_ID AS jnCard,
        TS.USER_NAME AS Name,
        TS.LEADER AS projectPm,
        TT.KJ_NAME as deptName,
        TT.CD_CODE as deptId
        from  TT_SYS_USER TS
        left  join
        TT_CODE TT on TS.DEPT_ID = TT.CD_CODE
        where
        TT.CD_KUBUN = 'A1' AND TS.USER_ID = #JN_CARD#


    </select>
    <select id="remainDays" parameterClass="java.lang.String"
        resultClass="java.lang.Double">
        select REMAIN_DAYS from TT_VOCATION where
        user_Id=#JN_CARD#
    </select>
    <update id="UpdateRemainDays"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        update TT_VOCATION set REMAIN_DAYS = #remainDays# where
        user_Id=#jnCard#
    </update>
    <!-- 添加请假申请后将申请的内容返回到页面 -->
    <select id="leaveId" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select JN_CARD AS JnCard,NAME AS Name,DEPT_ID AS
        DeptId,PROJECT_PM AS ProjectPm,LEAVE_TYPE AS
        leaveType,to_char(LEAVE_STARTTIME,'yyyy/mm/dd hh24:mi') AS
        leaveStartTime,to_char(LEAVE_ENDTIME,'yyyy/mm/dd hh24:mi') AS
        leaveEndTime,LEAVE_TOTALTIME AS leaveTotalTime,LEAVE_REASON AS
        leaveReason from TT_LEAVE_MANAGER where LEAVE_ID = #leaveID#
    </select>
    <select id="JNTCIAttendance03select" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        SELECT TTAS.LEAVE_ID AS leaveId,
        TTLM.JN_CARD AS jnCard ,
        TTLM.NAME AS name,
        TCL.KJ_NAME AS deptId,
        TTLM.PROJECT_PM AS projectPm,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS leaveSubtime,
        TTAS.EXAMINE_TIME AS examineTime,
        TCA.KJ_NAME AS applicationtype,
        TTAS.EXAMINE_PERSON AS examinePerson,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS leaveStartTime,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS leaveEndTime,
        TTLM.LEAVE_TOTALTIME AS leaveTotalTime,
        TTLM.LEAVE_TOTALTIME AS
        leaveReason,
        TC.KJ_NAME AS leaveType,
        TCW.KJ_NAME AS examineStatus,
        TTAS.EXAMINE_REASON as exmineReason,
        TTLM.UPD_TIME AS updTime
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        LEFT JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT
        JOIN TT_CODE TCL
        on TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON
        TTAS.EXAMINE_STATUS = TCW.CD_CODE
         LEFT JOIN TT_CODE TCA
        ON
         TTLM.APPLICATION_TYPE = TCA.CD_CODE
        WHERE TTLM.JN_CARD = #jnCard# and TTLM.APPLICATION_TYPE='AP1'
        ORDER
        BY
         (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
        	TTLM.UPD_TIME DESC
    </select>
    <select id="JNTCIAttendance03select1" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        SELECT TTAS.LEAVE_ID AS leaveId,
        TTLM.JN_CARD AS jnCard ,
        TTLM.NAME AS name,
        TCL.KJ_NAME AS deptId,
        TTLM.PROJECT_PM AS projectPm,
        to_char(TTLM.LEAVE_SUBTIME,'yyyy-mm-dd hh24:mi') AS leaveSubtime,
        TTAS.EXAMINE_TIME AS examineTime,
        TTAS.EXAMINE_PERSON AS examinePerson,
        TCA.KJ_NAME AS applicationtype,
        to_char(TTLM.LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS leaveStartTime,
        to_char(TTLM.LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS leaveEndTime,
        TTLM.LEAVE_TOTALTIME AS leaveTotalTime,
        TTLM.LEAVE_TOTALTIME AS
        leaveReason,
        TC.KJ_NAME AS leaveType,
        TCW.KJ_NAME AS examineStatus,
        TTAS.EXAMINE_REASON as exmineReason,
        TTLM.UPD_TIME AS updTime
        FROM
        TT_LEAVE_MANAGER TTLM
        JOIN TT_AUDIT_STATUS TTAS
        ON TTLM.LEAVE_ID =
        TTAS.LEAVE_ID
        LEFT JOIN TT_CODE TC
        ON TTLM.LEAVE_TYPE=TC.CD_CODE
        LEFT
        JOIN TT_CODE TCL
        on TTLM.DEPT_ID=TCL.CD_CODE
        LEFT JOIN TT_CODE TCW
        ON
        TTAS.EXAMINE_STATUS = TCW.CD_CODE
        LEFT JOIN TT_CODE TCA
        ON
         TTLM.APPLICATION_TYPE = TCA.CD_CODE
        WHERE TTLM.JN_CARD = #jnCard# and TTLM.APPLICATION_TYPE='AP2'
        ORDER
        BY
         (case TTAS.EXAMINE_STATUS
            when 'A04' then 1
            when 'A02' then 2
			when 'A11' then 3
			when 'A12' then 4
            when 'A07' then 5
			when 'A09' then 6
			when 'A05' then 7
			when 'A01' then 8
			when 'A08' then 9
			when 'A06' then 10
			when 'A03' then 11
			when 'A10' then 12
			when 'A13' then 13
            end),
        	TTLM.UPD_TIME DESC
    </select>
    <delete id="deleteLeave1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        delete from TT_LEAVE_MANAGER where LEAVE_ID=#leaveId#
        and JN_CARD=#jnCard#

    </delete>
    <delete id="deleteLeave2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        delete from TT_AUDIT_STATUS where LEAVE_ID=#leaveId#
    </delete>

    <!-- INSERT 休むを情報 -->
 <insert id="JNTCIAttendance03Insert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        INSERT INTO TT_LEAVE_MANAGER
        (LEAVE_ID,JN_CARD,NAME,DEPT_ID,PROJECT_PM,LEAVE_TYPE,LEAVE_STARTTIME,LEAVE_ENDTIME,LEAVE_TOTALTIME,LEAVE_REASON,LEAVE_SUBTIME,UPD_TIME,APPLICATION_TYPE)
        VALUES(#leaveId#,#jnCard#,#name#,#deptId#,#projectPm#,#leaveType#,#leaveStartTime#,#leaveEndTime#,#leaveTotalTime#,#leaveReason#,#leaveSubtime#,#updTime#,'AP1')
    </insert>
<insert id="JNTCIAttendance03Insert1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        INSERT INTO TT_LEAVE_MANAGER
        (LEAVE_ID,JN_CARD,NAME,DEPT_ID,PROJECT_PM,LEAVE_TYPE,LEAVE_STARTTIME,LEAVE_ENDTIME,LEAVE_TOTALTIME,LEAVE_REASON,LEAVE_SUBTIME,UPD_TIME,APPLICATION_TYPE)
        VALUES(#leaveId#,#jnCard#,#name#,#deptId#,#projectPm#,#leaveType#,#leaveStartTime#,#leaveEndTime#,#leaveTotalTime#,#leaveReason#,#leaveSubtime#,#updTime#,'AP2')
    </insert>
    <!-- INSERT 監査状態データ -->
    <insert id="AuditStatusInsert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03AuditStatusDto">
        INSERT INTO TT_AUDIT_STATUS
        (EXAMINE_ID,EXAMINE_PERSON,LEAVE_ID,OBJECT_TYPE,OBJECT_ID,EXAMINE_STATUS,UPD_TIME)
        VALUES(#EXAMINE_ID#,#EXAMINE_PERSON#,#LEAVE_ID#,#OBJECT_TYPE#,#OBJECT_ID#,#EXAMINE_STATUS#,#UPD_TIME#)
    </insert>
    <!-- SELECT 最大IDを取得 +1 -->
    <select id="maxId" parameterClass="java.lang.Integer"
        resultClass="java.lang.Integer">
        select max(LEAVE_ID+1) from TT_LEAVE_MANAGER
    </select>

    <select id="eaxMaxID" parameterClass="java.lang.Integer"
        resultClass="java.lang.String">
        select max(EXAMINE_ID+1) from TT_AUDIT_STATUS
    </select>

    <!-- SELECT 部門 -->
    <select id="selectdeptID" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select TT.KJ_NAME as deptName,TT.CD_CODE as deptId from
        TT_SYS_USER TS left
        join TT_CODE TT on TS.DEPT_ID = TT.CD_CODE where
        TT.CD_KUBUN = 'A1'
        AND TS.USER_ID = #JN_CARD#
    </select>
    <!-- deptNameによってクエリcode -->
    <select id="deptLeaveID"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        select DISTINCT TT_CODE.KJ_NAME AS
        deptName,TT_CODE.CD_CODE AS deptId from
        TT_LEAVE_MANAGER left join
        TT_CODE on TT_LEAVE_MANAGER.DEPT_ID =
        TT_CODE.CD_CODE where
        TT_CODE.CD_KUBUN = 'A1' AND
        TT_LEAVE_MANAGER.JN_CARD = #jnCard# AND
        TT_LEAVE_MANAGER.LEAVE_ID =
        #leaveId#
    </select>

  <!--查询数据库中婚假的总时间（leaveTypeTime）以及查询数据库中婚假的总次数（countNum）-->
    <select id="leaveTypeTime" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        SELECT
          SUM(LEAVE_TOTALTIME) AS leaveTypeTime,COUNT(LEAVE_TYPE) AS countNum
        FROM
            TT_LEAVE_MANAGER
        WHERE
           JN_CARD = #jnCard#
          AND LEAVE_TYPE = 'AL3'
    </select>
     <!--根据leaveId从数据库中查询休假类型和休假时间-->
    <select id="searchTime" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select LEAVE_TOTALTIME as leaveTotalTime ,LEAVE_TYPE  AS leaveType from TT_LEAVE_MANAGER WHERE LEAVE_ID =#leaveId#
    </select>
    <!-- SELECT休む -->
    <select id="leaveType" parameterClass="java.lang.Integer"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        SELECT CD_CODE as leaveCode,KJ_NAME as leaveName FROM
        TT_CODE WHERE CD_KUBUN='A5'
    </select>
         <select id="chaxunyouxiang"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#project_PM#
    </select>
      <select id="chaxunyouxiang1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#shencha#
    </select>
      <select id="chaxunyouxiang2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         JN_CARD=#user_id#
    </select>
    <select id="viewCount" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT count(TT_LEAVE_MANAGER.LEAVE_ID) AS totalCount
        FROM TT_LEAVE_MANAGER
        LEFT JOIN TT_AUDIT_STATUS on
        TT_LEAVE_MANAGER.LEAVE_ID =
        TT_AUDIT_STATUS.LEAVE_ID where
        TT_LEAVE_MANAGER.LEAVE_ID =
        TT_AUDIT_STATUS.LEAVE_ID and
        TT_LEAVE_MANAGER.jn_card=#jnCard# and TT_LEAVE_MANAGER.APPLICATION_TYPE='AP1'
    </select>
 <select id="viewCount1" resultClass="java.lang.String"
        resultSetType="SCROLL_INSENSITIVE">
        SELECT count(TT_LEAVE_MANAGER.LEAVE_ID) AS totalCount
        FROM TT_LEAVE_MANAGER
        LEFT JOIN TT_AUDIT_STATUS on
        TT_LEAVE_MANAGER.LEAVE_ID =
        TT_AUDIT_STATUS.LEAVE_ID where
        TT_LEAVE_MANAGER.LEAVE_ID =
        TT_AUDIT_STATUS.LEAVE_ID and
        TT_LEAVE_MANAGER.jn_card=#jnCard# and TT_LEAVE_MANAGER.APPLICATION_TYPE='AP2'
    </select>
    <select id="updateLeaveId"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendanceSelect03Dto">
        select DISTINCT TT_LEAVE_MANAGER.LEAVE_ID AS
        leaveId,TT_LEAVE_MANAGER.JN_CARD AS JnCard,TT_LEAVE_MANAGER.NAME AS
        Name,TT_LEAVE_MANAGER.DEPT_ID AS DeptId,TT_LEAVE_MANAGER.PROJECT_PM AS
        ProjectPm,TT_AUDIT_STATUS.EXAMINE_STATUS AS
        examineStatus,TT_LEAVE_MANAGER.LEAVE_TYPE AS
        leaveType,TT_LEAVE_MANAGER.LEAVE_STARTTIME AS
        leaveStartTime,TT_LEAVE_MANAGER.LEAVE_ENDTIME AS
        leaveEndTime,TT_LEAVE_MANAGER.LEAVE_TOTALTIME AS
        leaveTotalTime,TT_LEAVE_MANAGER.LEAVE_REASON AS leaveReason
        from
        TT_LEAVE_MANAGER LEFT JOIN TT_AUDIT_STATUS ON
        TT_LEAVE_MANAGER.LEAVE_ID = TT_AUDIT_STATUS.LEAVE_ID where
        TT_LEAVE_MANAGER.LEAVE_ID = #leaveId# and TT_LEAVE_MANAGER.JN_CARD =
        #jnCard#
    </select>
        <select id="selectCompareDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto"
        resultClass="java.lang.String">
        SELECT DISTINCT JN_CARD as checkDate
        FROM TT_LEAVE_MANAGER le
        left join TT_AUDIT_STATUS au ON le.LEAVE_ID=au.LEAVE_ID
        WHERE ((le.LEAVE_STARTTIME &lt;= to_date(#leaveStartTime#,'yyyy-MM-dd
        hh24:mi')
        AND le.LEAVE_ENDTIME &gt;= to_date(#leaveEndTime#,'yyyy-MM-dd
        hh24:mi'))
        OR(le.LEAVE_STARTTIME &gt; to_date(#leaveStartTime#,'yyyy-MM-dd
        hh24:mi')
        AND le.LEAVE_STARTTIME &lt; to_date(#leaveEndTime#,'yyyy-MM-dd
        hh24:mi'))
        OR(le.LEAVE_ENDTIME &gt; to_date(#leaveStartTime#,'yyyy-MM-dd
        hh24:mi')
        AND le.LEAVE_ENDTIME &lt; to_date(#leaveEndTime#,'yyyy-MM-dd
        hh24:mi')))
        AND le.JN_CARD=#jnCard# and (au.EXAMINE_STATUS='A10' or au.EXAMINE_STATUS='A13' or au.EXAMINE_STATUS='A03' or au.EXAMINE_STATUS='A01' or au.EXAMINE_STATUS='A08' or au.EXAMINE_STATUS='A04')
        AND le.LEAVE_ID != #leaveId#
    </select>

    <update id="updateStatus"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03AuditStatusDto">
        update TT_AUDIT_STATUS set EXAMINE_STATUS =
        #EXAMINE_STATUS#,EXAMINE_PERSON=#EXAMINE_PERSON# WHERE LEAVE_ID =
        #LEAVE_ID#
    </update>

    <update id="updateLeave"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        update TT_LEAVE_MANAGER set LEAVE_TYPE =
        #leaveType#,LEAVE_STARTTIME = #leaveStartTime#,LEAVE_ENDTIME =
        #leaveEndTime#,LEAVE_TOTALTIME = #leaveTotalTime#,LEAVE_REASON =
        #leaveReason# WHERE LEAVE_ID = #leaveId#
    </update>
    <!-- attendanceLeave01.sql ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ -->

    <select id="JNTCIBusinessVerifyVoInfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as  uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,

        <!-- TT_ED.EXAMINE_PERSON as examinePerson, -->
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
      1=1
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
            <!-- <isNotEmpty property="userName">
                and TT_ED.EXAMINE_PERSON = #userName#
            </isNotEmpty> -->
            <isNotEmpty property="userName">
                and TSU.LEADER = #userName#
            </isNotEmpty>
            order by case TT_ED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TT_ED.EVECTION_ID desc
        </dynamic>
    </select>
<select id="JNTCIBusinessVerifyVoInfoGL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
               (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty >
                and TT_ED.DEPT_ID = '002'
            </isNotEmpty>
            <isNotEmpty >
                and ((TSU.LEADER ='張棟')or((TSU.LEADER !='張棟')and(TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A08' or TT_ED.EXAMINE_STATUS='A09' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS='A06')))
            </isNotEmpty>
                order by case TT_ED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TT_ED.EVECTION_ID desc
        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoGLL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
               (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty >
                and TT_ED.DEPT_ID = '001'
            </isNotEmpty>
            <isNotEmpty>
                 and TSU.LEADER ='衣蘭凱'
            </isNotEmpty>
             <!-- <isNotEmpty property="userName">
                and TT_ED.EXAMINE_PERSON = #userName#
            </isNotEmpty>
              <isNotEmpty>
                 or TT_ED.EXAMINE_PERSON =  '田東啓'
            </isNotEmpty> -->
               order by case TT_ED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TT_ED.EVECTION_ID desc
        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoGL1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
               (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
             <isNotEmpty property="userName">
                and TT_ED.EXAMINE_PERSON = #userName#
            </isNotEmpty>
               ORDER BY  TT_ED.EVECTION_ID DESC
        </dynamic>
    </select>


    <select id="JNTCIBusinessVerifyVoInfoGGL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
               (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
           <isNotEmpty property="userName">
                and (TT_ED.EXAMINE_PERSON = #userName# or  TSU.LEADER ='田東啓')
            </isNotEmpty>
             order by case TT_ED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TT_ED.EVECTION_ID desc
        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoLL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.EXAMINE_STATUS,'A05','承認しない'
        ,'A01','承認中','A04','未審査','A06','終了','A07','PM承認しない','A08','承認済','A09','承認済しない') as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,

        <!-- TT_ED.EXAMINE_PERSON as examinePerson, -->
        TSU.LEADER as projectPm,
        TT_ED.EVECTION_REASON as evectionReason
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
              <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =
                #examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
             order by case TT_ED.EXAMINE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end,TT_ED.EVECTION_ID desc
        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(TT_ED.USER_ID)
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
       <dynamic prepend="WHERE">
          1=1
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
             <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME  like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =#examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
            <isNotEmpty property="userName">
                and TSU.LEADER = #userName#
            </isNotEmpty>

        </dynamic>
    </select>
<select id="JNTCIBusinessVerifyVoInfoCountGL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(TT_ED.USER_ID)
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
       <dynamic prepend="WHERE">
           (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
             <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME  like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =#examine_Status#
            </isNotEmpty>
            <isNotEmpty >
                and TT_ED.DEPT_ID = '002'
            </isNotEmpty>
             <isNotEmpty >
                and ((TSU.LEADER ='張棟')or((TSU.LEADER !='張棟')and(TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A08' or TT_ED.EXAMINE_STATUS='A09' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS='A06')))
            </isNotEmpty>
           <!--  <isNotEmpty property="userName">
                and TT_ED.EXAMINE_PERSON = #userName#
            </isNotEmpty> -->
           <!--  <isNotEmpty>
                 or TT_ED.EXAMINE_PERSON = '田東啓'
            </isNotEmpty> -->

        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoCountGGGL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(TT_ED.USER_ID)
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
       <dynamic prepend="WHERE">
           (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
             <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME  like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =#examine_Status#
            </isNotEmpty>
            <isNotEmpty>
                and TT_ED.DEPT_ID = '001'
            </isNotEmpty>
             <isNotEmpty>
                 and TSU.LEADER ='衣蘭凱'
            </isNotEmpty>
           <!--  <isNotEmpty property="userName">
                and TT_ED.EXAMINE_PERSON = #userName#
            </isNotEmpty> -->
           <!--  <isNotEmpty>
                 or TT_ED.EXAMINE_PERSON = '田東啓'
            </isNotEmpty> -->

        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoCountGGL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(TT_ED.USER_ID)
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
       <dynamic prepend="WHERE">
           (TT_ED.EXAMINE_STATUS='A01' or TT_ED.EXAMINE_STATUS='A04' or TT_ED.EXAMINE_STATUS='A05' or TT_ED.EXAMINE_STATUS= 'A06' or TT_ED.EXAMINE_STATUS='A07'  or  TT_ED.EXAMINE_STATUS= 'A08' or TT_ED.EXAMINE_STATUS= 'A09')
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
             <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME  like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =#examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
            <isNotEmpty property="userName">
                and (TT_ED.EXAMINE_PERSON = #userName# or  TSU.LEADER ='田東啓')
            </isNotEmpty>

        </dynamic>
    </select>
    <select id="JNTCIBusinessVerifyVoInfoCountLL"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="java.lang.String" resultSetType="SCROLL_INSENSITIVE">
        SELECT
        COUNT(TT_ED.USER_ID)
        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON TT_ED.USER_ID=TSU.USER_ID
       <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="user_Id">
                and TT_ED.USER_ID = #user_Id#
            </isNotEmpty>
             <isNotEmpty property="user_Name">
                and TT_ED.USER_NAME  like  '%$user_Name$%'
            </isNotEmpty>
            <isNotEmpty property="examine_Status">
                and TT_ED.EXAMINE_STATUS =#examine_Status#
            </isNotEmpty>
            <isNotEmpty property="dept_Id">
                and TT_ED.DEPT_ID = #dept_Id#
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="JNTCIBusinessVerify02"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as uid1,
        TT_ED.USER_NAME as uname1,
        decode(TT_ED.SEX, '0', '女', '1', '男', '') as sex,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,

        TT_ED.BUSINESS_DAYS as businessDays,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy/MM/dd') as evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy/MM/dd') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TT_ED.EVECTION_REASON as evectionReason,
        <!-- to_char(TT_ED.CRE_DATETM,'yyyy-MM-dd HH:mm:ss') as creDateTm, -->


        TT_ED.BUSINESS_DAYS as businessDays,
        TPBI.TJ_CARD as tjUserId,
        TSU.LEADER as projectPm,
        TT_ED.EXAMINE_PERSON as examinePerson,
        TT_ED.EXAMINE_STATUS as examineStatus,


        TSU.POSITION as positionId,
        <!-- TSU.PROJECT_ID as projectId, -->
        TT_ED.PROJECT_ID as projectId,
        TT_ED.PROJECT_NAME as projectName,
       <!--  decode(TSU.PROJECT_ID,'SL1','大宇宙内部系统','SL2','国内project','SL3','WEB前端')as projectName, -->
        TT_ED.DEPENDENCY as dependency,
        TT_ED.ID_CADE as idCard,
        to_char(TT_ED.DEPARTURE_TIME,'YYYY-MM-DD') as departureTime,


        decode(TT_ED.PASSPORT,'1','有','0','无') as passport,
        decode(TT_ED.VISA,'1','有','0','无') as visa,


        TT_ED.PASSPORT_ID as passportId,

        to_char(TT_ED.PASSPORT_VALIDITY,'YYYY-MM-DD') as passportValidity,

        TT_ED.LEAVE as leave,
        TT_ED.REACH_PLACE as reachPlace,
        TT_ED.NAME_PINYIN as namePinyin,
        TT_ED.TRAFFIC_RESERVE_PERSION as trafficReservePerson,
        TT_ED.TRAFFIC_EXPLAIN as trafficExplain,
        to_char(TT_ED.HOTEL_STARTTIME,'YYYY-MM-DD') as hotelStartTime,
        to_char(TT_ED.HOTEL_ENDTIME,'YYYY-MM-DD') as hotelEndtime,
        TT_ED.HOTEL_DESTINATION as hotelDestination,
        TT_ED.HOTEL_PERSON as hotelPerson,
        TT_ED.HOTEL_NUMBER as hotelNumber,
        TT_ED.HOTEL_RESERVE_PERSION as hotelReservePerson,
        TT_ED.HOTEL_EXPLAIN as hotelExplain,

        TT_ED.ARTICLE_NAME as articleName,
        to_char(TT_ED.TRANSFER_STARTTIME,'YYYY-MM-DD') as transferStartTime,
        to_char(TT_ED.TRANSFER_ENDTIME,'YYYY-MM-DD') as transferEndTime,
        TT_ED.RECIPIENT as recipient,
        TT_ED.STORAGES as storAges,
        decode(TT_ED.PASSPORT_LENGTH,'1','长签','0','短签') as passportLength,
        TT_ED.ARTICLE_REMARK as articleRemark,
        EVECTION_TYPE as evectionType

        FROM
        TT_EVECTION_DATA TT_ED
        INNER  JOIN TT_SYS_USER TSU
        ON
        TT_ED.USER_ID=TSU.USER_ID
        LEFT JOIN TT_CODE TCD
        ON
        TCD.CD_KUBUN='S1'AND TT_ED.PROJECT_ID=TCD.KJ_NAME

        left join
        TT_PERSONAL_BASIC_INFO  TPBI on
        TPBI.JN_CARD = TSU.USER_ID

        where
        EVECTION_ID = #evectionId#


    </select>
 <update id="JNTCIBusinessVerify02Update"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS =
        #examineStatus#,
        EXAMINE_PERSON =#examinePerson#

        WHERE EVECTION_ID = #evectionId#
    </update>

    <update id="JNTCIBusinessVerifyUpdate" >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A01',
        EXAMINE_PERSON=#leader#

        WHERE EVECTION_ID = #deleteId_card#
    </update>
    <update id="JNTCIBusinessVerifyUpdateLeader" >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_PERSON=#leader#

        WHERE EVECTION_ID = #deleteId_card#
    </update>

    <update id="JNTCIBusinessVerifyUpdateDisagree" >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A07'

        WHERE EVECTION_ID = #deleteId_card#
    </update>
    <update id="JNTCIBusinessVerifyUpdateLeader1" >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_PERSON=''

        WHERE EVECTION_ID = #deleteId_card#
    </update>
    <select id="selectyouxiangbyLeader"
        parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#leader#
    </select>
<select id="selectShenQingRen"
       parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
       USER_NAME as ShenQingRen
        from
       TT_EVECTION_DATA
        WHERE
        EVECTION_ID = #deleteId_card#
    </select>
    <select id="selectexamineStatus"
       parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
       EXAMINE_STATUS as examineStatus
        from
       TT_EVECTION_DATA
        WHERE
        EVECTION_ID = #deleteId_card#
    </select>
    <select id="selectEvectionStartTime"
       parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
        to_char(EVECTION_STARTTIME,'yyyy/mm/dd') as
        starttime
        from
       TT_EVECTION_DATA
        WHERE
        EVECTION_ID = #deleteId_card#
    </select>
    <select id="selectEvectionEndTime"
       parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
       to_char(EVECTION_ENDTIME,'yyyy/mm/dd') as endtime
        from
       TT_EVECTION_DATA
        WHERE
        EVECTION_ID = #deleteId_card#
    </select>
 <select id="selectleaderChuchai"
       parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select
       LEADER as leader
        from
       TT_SYS_USER
        WHERE
        USER_ID = #userId#
    </select>

     <update id="JNTCIBusinessVerify1Update" >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A06'

        WHERE EVECTION_ID = #deleteId_card#
    </update>
    <update id="JNTCIBusinessVerify6Update"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input"
    >
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A08',
         EXAMINE_PERSON=#examinePerson#
        WHERE EVECTION_ID = #deleteId_card#
    </update>

    <update id="JNTCIBusinessVerify1UpdateDisagree"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A05',
      EXAMINE_PERSON=#examinePerson#
        WHERE EVECTION_ID = #deleteId_card#
    </update>
    <update id="JNTCIBusinessVerify1Update6Disagree"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A09',
      EXAMINE_PERSON=#examinePerson#
        WHERE EVECTION_ID = #deleteId_card#
    </update>
     <insert id="JNTCIBusinessVerifycount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        INSERT INTO TT_EVECTION_DETAIL(
        EVECTION_YM,EVECTION_COUNT,EVECTION_ID)VALUES(
        #day#,#count#,#evectionId#)
    </insert>
     <insert id="JNTCIBusinessVerifycountone"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        INSERT INTO TT_EVECTION_DETAIL(
        EVECTION_YM,EVECTION_COUNT,EVECTION_ID)VALUES(
        #day#,#count#,#deleteId_card#)
    </insert>
     <delete id="JNTCIBusinessVerifycountDeleteone"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        delete from TT_EVECTION_DETAIL
        where  EVECTION_ID=#deleteId_card#
    </delete>
    <update id="JNTCIBusinessVerifycount1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        UPDATE TT_EVECTION_DETAIL SET
        EVECTION_YM = #day#,
        EVECTION_COUNT = #count#
        where  EVECTION_ID=#evectionId#
    </update>
      <delete id="JNTCIBusinessVerifycountDelete"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        delete from TT_EVECTION_DETAIL
        where  EVECTION_ID=#evectionId#
    </delete>
    <update id="JNTCIBusinessVerifycountupdate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input">
        UPDATE TT_EVECTION_DATA SET
        EXAMINE_STATUS = 'A04'
        where  EVECTION_ID=#evectionId#
    </update>
     <select id="JNTCIBusinessVerifycountDeleteChaxun"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify02Input"
        resultClass="java.lang.Integer">
        select count(1)  from TT_EVECTION_DETAIL
        where  EVECTION_ID=#evectionId#
    </select>
    <select id="examineStatus"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Output">
        select
        CD_CODE,
        KJ_NAME
        from
        TT_CODE
        WHERE CD_KUBUN = 'B2' AND
        cd_code!='A01'
    </select>


    <select id="deptId"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Output">
        select
        CD_CODE,
        KJ_NAME
        from
        TT_CODE
        WHERE
        CD_KUBUN = 'A1'

    </select>





    <!-- 加班申请 -->
    <select id="selectUser" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
       <!-- select user_id, user_name, dept_id,project_PL as
        project_PM,project_id as
        project ,FL_FUNC_USE as flag from TT_SYS_USER WHERE user_id=#ID# -->
        select TSU.USER_ID, TSU.USER_NAME, TSU.DEPT_ID,TSU.PROJECT_PL as project_PM,
        TSU.PROJECT_ID as project_id, TSU.FL_FUNC_USE as flag ,
		TC.KJ_NAME as project

		from TT_SYS_USER TSU
		left join TT_CODE TC
		on TC.CD_CODE = TSU.PROJECT_ID and TC.CD_KUBUN='S1'
		WHERE user_id=#ID#
    </select>
    <select id="selectProject_NO" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select PROJECT_NO from TT_CODE WHERE CD_KUBUN='S1' and
        CD_CODE=#project_id#
    </select>
    <select id="selectProject_id" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select PROJECT_ID from TT_SYS_USER
        where USER_ID=#user_id#
    </select>
    <select id="selectDept" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select DISTINCT TC.KJ_Name as dept_id from TT_CODE TC left
        join TT_SYS_USER
        info on info.DEPT_ID = TC.CD_CODE where
        TC.CD_KUBUN='A1' and
        TC.CD_CODE = #dept_id#
    </select>
    <select id="selectProject_Name" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        <!-- select DISTINCT TC.KJ_Name as dept_id from TT_CODE TC left -->
        select DISTINCT TC.KJ_Name as Project_Name from TT_CODE TC left
        join TT_SYS_USER
        info on info.PROJECT_ID = TC.CD_CODE where
        TC.CD_KUBUN='S1' and
        TC.CD_CODE = #project_id#
    </select>
    <select id="equalsDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
          SELECT DISTINCT USER_ID as checkDate
        FROM
        TT_EXTRA_MANAGEMENT
        WHERE ((EXTRA_STARTTIME &lt;= to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &gt;= to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_STARTTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_STARTTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_ENDTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi')))
               AND USER_ID=#user_id# AND (EXTRA_AUDITSS='A04' or EXTRA_AUDITSS='A06' or EXTRA_AUDITSS='A01' or EXTRA_AUDITSS='A08')
    </select>

    <select id="equalsTime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
          SELECT DISTINCT TT_EXTRA_MANAGEMENT.USER_ID as checkTime,TT_EVECTION_DATA.EXAMINE_STATUS
        FROM
        TT_EXTRA_MANAGEMENT join TT_EVECTION_DATA on
        TT_EXTRA_MANAGEMENT.USER_ID = TT_EVECTION_DATA.USER_ID
        WHERE  (to_char(EVECTION_ENDTIME,'yyyy-MM-dd hh24:mi') &gt;= #extra_starttime#
        AND to_char(EVECTION_STARTTIME,'yyyy-MM-dd hh24:mi') &lt;= #extra_starttime#)
        AND ( to_char(EVECTION_ENDTIME,'yyyy-MM-dd hh24:mi') &gt;= #extra_endtime#
        AND to_char(EVECTION_STARTTIME,'yyyy-MM-dd hh24:mi') &lt;= #extra_endtime#)
               AND TT_EXTRA_MANAGEMENT.USER_ID=#user_id#
               AND TT_EVECTION_DATA.EXAMINE_STATUS= 'A06'
    </select>

<select id="equalsTime1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
          SELECT DISTINCT TT_EXTRA_MANAGEMENT.USER_ID as checkTime,TT_EVECTION_DATA.EXAMINE_STATUS
        FROM
        TT_EXTRA_MANAGEMENT join TT_EVECTION_DATA on
        TT_EXTRA_MANAGEMENT.USER_ID = TT_EVECTION_DATA.USER_ID
        WHERE  (to_char(EVECTION_ENDTIME,'yyyy-MM-dd hh24:mi') &gt;= #extra_starttime#
        AND to_char(EVECTION_STARTTIME,'yyyy-MM-dd hh24:mi') &lt;= #extra_starttime#)
        AND ( to_char(EVECTION_ENDTIME,'yyyy-MM-dd hh24:mi') &gt;= #extra_endtime#
        AND to_char(EVECTION_STARTTIME,'yyyy-MM-dd hh24:mi') &lt;= #extra_endtime#)
               AND TT_EXTRA_MANAGEMENT.USER_ID=#userId#
               AND TT_EVECTION_DATA.EXAMINE_STATUS= 'A06'
    </select>

      <select id="equalsDate11"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
          SELECT DISTINCT USER_ID as checkDate
        FROM
        TT_EXTRA_MANAGEMENT
        WHERE ((EXTRA_STARTTIME &lt;= to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &gt;= to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_STARTTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_STARTTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_ENDTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi')))
               AND USER_ID=#userId#
    </select>
     <select id="equalsDate22"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
          SELECT DISTINCT USER_ID as checkDate
        FROM
        TT_EXTRA_MANAGEMENT
        WHERE ((EXTRA_STARTTIME &lt;= to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &gt;= to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_STARTTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_STARTTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi'))
        OR(EXTRA_ENDTIME &gt; to_date(#extra_starttime#,'yyyy-MM-dd
        hh24:mi')
        AND EXTRA_ENDTIME &lt; to_date(#extra_endtime#,'yyyy-MM-dd
        hh24:mi')))
               AND USER_ID=#userId# AND EXTRA_ID!=#extra_id#
    </select>
    <select id="selectType"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        select DISTINCT TC.KJ_NAME,TC.CD_CODE as code_id from
        TT_CODE TC left join
        TT_EXTRA_MANAGEMENT extra on
        TC.CD_CODE=extra.EXTRA_TYPE where
        TC.CD_KUBUN='B3'
    </select>
    <select id="primarykey" resultClass="java.lang.String">
        select max(extra_id) from
        (select substr(extra_id,2) as extra_id from TT_EXTRA_MANAGEMENT) order
        by extra_id desc
    </select>
    <select id="selecttotalCount" resultClass="java.lang.String">
       select count(user_id)
        AS totalCount from TT_EXTRA_MANAGEMENT a
	  left join TT_CODE b
	  on a.PROJECT = b.KJ_NAME
	   where
	    b.CD_KUBUN='S1' and
	    user_id=#user_id#
    </select>
    <select id="selectallextraByuser_id" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeApplicationSelectInput">
        select extra_id, user_id,user_name,e.leader  as project_PM,c.KJ_NAME as
        dept_id,project,co.cd_code as project_id,to_char(extra_starttime,'yyyy-mm-dd
        hh24:mi') as
        extra_starttime,to_char(extra_endtime,'yyyy-mm-dd
        hh24:mi') as
        extra_endtime,extra_time,cod.KJ_NAME
        as extra_type
        ,pay_id,code.KJ_NAME
        as extra_reason
        from TT_EXTRA_MANAGEMENT e left
        join TT_Code c
        on
        e.DEPT_ID = c.CD_CODE left join TT_Code cod
        on
        e.EXTRA_TYPE =
        cod.CD_CODE
        left join TT_Code code
        on e.EXTRA_AUDITSS =
        code.CD_CODE
        left join TT_Code co
        on e.PROJECT = co.KJ_NAME
        where
        cod.CD_KUBUN='B3'and
        co.CD_KUBUN='S1'and
        code.CD_KUBUN='B2' and
        e.USER_ID=#user_id#
          order by (case e.EXTRA_AUDITSS
            when 'A04' then 1
            when 'A05' then 2
            when 'A06' then 3
            end),e.CRE_DATETM desc
    </select>
    <insert id="insertmonth"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        INSERT INTO TT_EXTRA_MANAGEMENT1(
        EXTRA_ID,IN_MONTH)VALUES(
        #extra_id#,#in_month#)
    </insert>
    <insert id="insertExtraRecord"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        INSERT INTO TT_EXTRA_MANAGEMENT(
        EXTRA_ID,USER_ID,
        USER_NAME, DEPT_ID, PROJECT, EXTRA_TYPE, EXTRA_TIME,
        EXTRA_STARTTIME,EXTRA_ENDTIME,
        EXTRA_REASON,CRE_DATETM,EXTRA_AUDITSS,LEADER)VALUES(
        #extra_id#,#user_id#, #user_name#, #dept_code#,
        #project#,#extra_type#, #extra_time_txt#, #extra_starttime#,
        #extra_endtime#,#extra_reason#,#cre_datetm#,'A04',#project_PM#)
    </insert>
    <delete id="deleteextra"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        delete from TT_EXTRA_MANAGEMENT where
        EXTRA_ID=#extra_id#
    </delete>
    <select id="selectExtrabyextraid"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeApplicationSelectInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        select tt.extra_id,tt.user_id,tt.user_name,tt.project,cccc.cd_code as project_id,tsu.USER_ID as examinePerson,
        to_char(extra_starttime,'yyyy-mm-dd hh24:mi') as extra_starttime,
        to_char(extra_endtime,'yyyy-mm-dd hh24:mi') as extra_endtime,
        extra_time,tt.leader as project_PM,extra_reason as extra_auditss,
        c.KJ_NAME as dept_code,cc.KJ_NAME as extra_reason,
        ccc.CD_CODE as
        extra_type
        from TT_EXTRA_MANAGEMENT tt
        left join TT_code c on tt.DEPT_ID
        = c.CD_CODE
        left join TT_code cc on cc.CD_CODE = tt.EXTRA_AUDITSS
        left
        join TT_code ccc on ccc.CD_CODE = tt.EXTRA_TYPE
        left join TT_code cccc
        on cccc.KJ_NAME=tt.PROJECT
        left join TT_SYS_USER  tsu
        on tt.examine_person = tsu.USER_NAME
        where cc.CD_KUBUN='B2'and ccc.CD_KUBUN='B3'
        and cccc.CD_KUBUN='S1' and tt.extra_id=#extra_id#
    </select>
    <select id="selectexamineTrueName" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput"
        resultClass="java.lang.String">
    select USER_NAME FROM TT_SYS_USER WHERE USER_ID=#examinePerson#
    </select>
    <update id="updateExtraByID"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        update TT_EXTRA_MANAGEMENT set
        extra_starttime=#extra_starttime#, extra_endtime=#extra_endtime#,
        extra_time=#extra_time#,extra_reason=#extra_auditss#
        ,extra_type=#extra_type#,examine_person=#examineTrueName# where extra_id=#extra_id#
    </update>


    <!-- 殘業审查 -->
    <select id="selectTotalCountbyName"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="java.lang.String">
             select COUNT(*)
        from TT_EXTRA_MANAGEMENT
       where EXAMINE_PERSON=#userName#  or  LEADER=#userName#
    </select>
    <select id="selectTotalCountBoss"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="java.lang.String">
        select COUNT(1)
        from TT_EXTRA_MANAGEMENT
        TT_EX
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE
        =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE =
        TT_EX.EXTRA_TYPE
        <dynamic prepend="WHERE ">
            EXTRA_AUDITSS='A06' and TCO.CD_KUBUN ='B3'
            <isNotEmpty property="user_id2">
                and USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <!-- <isNotEmpty property="userName">
                and EXAMINE_PERSON_GLB=#userName#
            </isNotEmpty> -->
            <isNotEmpty property="dept_id2">
                and DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>

            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
    </select>
       <select id="getextratimeBoss"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIOverTimeVerifyOutvo">
        select TT_EX.EXTRA_ID,
        TT_EX.USER_ID,
        TT_EX.USER_NAME,
        TT_EX.PROJECT,
        TC.KJ_NAME AS DEPT_ID,
        TCO.KJ_NAME AS EXTRA_TYPE,
        TT_EX.EXTRA_TIME,
        to_char(EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        TT_EX.EXTRA_REASON,
        TSU.PROJECT_PL as LEADER,
        TT_EX.PAY_ID,
        TT_EX.CRE_DATETM,
        TCA.KJ_NAME AS EXTRA_AUDITSS,
        TT_EX.EXAMINE_PERSON as examinePerson
        from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE


        <dynamic prepend="WHERE ">
            EXTRA_AUDITSS='A06' and TCO.CD_KUBUN ='B3'  <!-- and EXTRA_AUDITSS = 'A05'  -->
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <!-- <isNotEmpty property="userName">
                and EXAMINE_PERSON_GLB=#userName#
            </isNotEmpty> -->
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>

            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
        order by (case TT_EX.EXTRA_AUDITSS
            when 'A04' then 1
            when 'A05' then 2
            when 'A06' then 3
            end),EXTRA_ID desc

    </select>
    <select id="selectleader"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyCondition">
        select user_name from TT_SYS_USER where  FL_FUNC_USE in (1,4)
    </select>
    <select id="JNTCIOVERTIME"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyCondition"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyCondition">
        select EXTRA_ID,
        USER_ID,
        USER_NAME,
        PROJECT,
        EXTRA_TYPE,
        TCO.KJ_NAME as EXTRA_NAME,
        TC.KJ_NAME AS DEPT_ID,
        EXTRA_TIME,
        to_char(EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        EXTRA_REASON,
        PAY_ID,
        LEADER,
        EXTRA_AUDITSS，
        CRE_DATETM,
        TT_EX.EXAMINE_PERSON as examinePerson
        from
        TT_EXTRA_MANAGEMENT TT_EX
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE =TT_EX.DEPT_ID
        and TC.CD_KUBUN = 'A1'
        INNER JOIN
        TT_CODE TCO
        ON
        TCO.CD_CODE =TT_EX.EXTRA_TYPE
        AND TCO.CD_KUBUN = 'B3'
        WHERE EXTRA_ID = #extra_id#
    </select>
   <!-- select examinePerson -->
        <select id="examinePerson"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select USER_ID AS examineId,USER_NAME AS examinePerson
            from JINANIMS.TT_SYS_USER where FL_FUNC_USE IN (0,4,1) and POSITION >= 'T07'
            order by FL_FUNC_USE desc
    </select>
    <select id="examinePersonGL"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
        select USER_ID AS examineId,USER_NAME AS examinePerson
            from JINANIMS.TT_SYS_USER where FL_FUNC_USE IN (1)
            order by FL_FUNC_USE desc
    </select>
    <update id="resultupdate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_EXTRA_MANAGEMENT
        SET EXTRA_AUDITSS =
        #extra_auditss#
        where EXTRA_ID = #extra_id#
    </update>
    <select id="selectTotalCountGLB"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="java.lang.String">
        select COUNT(1)
         from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE
        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
                 TT_EX.DEPT_ID ='001'  and TSU.PROJECT_PL='衣蘭凱' and TCO.CD_KUBUN ='B3'
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>
            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
        </select>
        <select id="selectTotalCountPM"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="java.lang.String">
        select COUNT(1)
         from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE
        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
             (TSU.PROJECT_PL=#userName# )  and TCO.CD_KUBUN ='B3'
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>
            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
        </select>
        <select id="selectTotalCountKFB"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="java.lang.String">
        select COUNT(1)
         from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE
        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
               (EXTRA_AUDITSS='A06' and TT_EX.DEPT_ID ='002'  and TCO.CD_KUBUN ='B3')or(  (TSU.PROJECT_PL=#userName#)  and TCO.CD_KUBUN ='B3')
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>
            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
        </select>
        <select id="getextratimeGLB"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIOverTimeVerifyOutvo">
        select TT_EX.EXTRA_ID,
        TT_EX.USER_ID,
        TT_EX.USER_NAME,
        TT_EX.PROJECT,
        TC.KJ_NAME AS DEPT_ID,
        TCO.KJ_NAME AS EXTRA_TYPE,
        TT_EX.EXTRA_TIME,
        to_char(EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        TT_EX.EXTRA_REASON,
        TSU.PROJECT_PL as LEADER,
        TT_EX.PAY_ID,
        TT_EX.CRE_DATETM,
        TCA.KJ_NAME AS EXTRA_AUDITSS,
        TT_EX.EXAMINE_PERSON as examinePerson
        from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE


        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
              TT_EX.DEPT_ID ='001'  and TSU.PROJECT_PL ='衣蘭凱' and  TCO.CD_KUBUN ='B3'
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>

            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
            order by (case TT_EX.EXTRA_AUDITSS
            when 'A04' then 1
            when 'A05' then 2
            when 'A06' then 3
            end),EXTRA_ID desc
    </select>
     <select id="getextratimePM"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIOverTimeVerifyOutvo">
        select TT_EX.EXTRA_ID,
        TT_EX.USER_ID,
        TT_EX.USER_NAME,
        TT_EX.PROJECT,
        TC.KJ_NAME AS DEPT_ID,
        TCO.KJ_NAME AS EXTRA_TYPE,
        TT_EX.EXTRA_TIME,
        to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        TT_EX.EXTRA_REASON,
        TSU.PROJECT_PL as LEADER,
        TT_EX.PAY_ID,
        TT_EX.CRE_DATETM,
        TCA.KJ_NAME AS EXTRA_AUDITSS,
        TT_EX.EXAMINE_PERSON as examinePerson
        from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE


        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
               (TSU.PROJECT_PL=#userName#)  and TCO.CD_KUBUN ='B3'
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>

            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
         order by (case TT_EX.EXTRA_AUDITSS
            when 'A04' then 1
            when 'A05' then 2
            when 'A06' then 3
            end),EXTRA_ID desc
    </select>
    <select id="getextratimeKFB"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIOverTimeVerifyOutvo">
        select TT_EX.EXTRA_ID,
        TT_EX.USER_ID,
        TT_EX.USER_NAME,
        TT_EX.PROJECT,
        TC.KJ_NAME AS DEPT_ID,
        TCO.KJ_NAME AS EXTRA_TYPE,
        TT_EX.EXTRA_TIME,
        to_char(EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        TT_EX.EXTRA_REASON,
        TSU.PROJECT_PL as LEADER,
        TT_EX.PAY_ID,
        TT_EX.CRE_DATETM,
        TCA.KJ_NAME AS EXTRA_AUDITSS,
        TT_EX.EXAMINE_PERSON as examinePerson
        from
        TT_EXTRA_MANAGEMENT
        TT_EX
        LEFT JOIN
        TT_SYS_USER
        TSU
        ON TSU.USER_ID=TT_EX.USER_ID
        INNER JOIN
        TT_CODE TC
        ON
        TC.CD_CODE
        =TT_EX.DEPT_ID
        LEFT JOIN TT_CODE
        TCA
        ON
        TCA.CD_CODE =TT_EX.EXTRA_AUDITSS
        INNER JOIN
        TT_CODE
        TCO
        ON
        TCO.CD_CODE = TT_EX.EXTRA_TYPE


        <dynamic prepend="WHERE ">
           <!--  1=1 and TCO.CD_KUBUN ='B3' -->
          (EXTRA_AUDITSS='A06' and TT_EX.DEPT_ID ='002'  and TCO.CD_KUBUN ='B3')or(  (TSU.PROJECT_PL=#userName#)  and TCO.CD_KUBUN ='B3')
            <isNotEmpty property="user_id2">
                and TT_EX.USER_ID =#user_id2#
            </isNotEmpty>
            <isNotEmpty property="user_name2">
                <!-- and USER_NAME=#user_name# -->
                and TT_EX.USER_NAME like '%$user_name2$%'
            </isNotEmpty>
            <isNotEmpty property="dept_id2">
                and TT_EX.DEPT_ID =#dept_id2#
            </isNotEmpty>
            <isNotEmpty property="extra_auditss_search">
                and EXTRA_AUDITSS = #extra_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="extra_starttime1">
                and
                to_char(TT_EX.EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') &gt;=
                #extra_starttime1#
            </isNotEmpty>

            <isNotEmpty property="extra_endtime1">
                and
                to_char(TT_EX.EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') &lt;=
                #extra_endtime1#
            </isNotEmpty>
        </dynamic>
         order by (case TT_EX.EXTRA_AUDITSS
            when 'A04' then 1
            when 'A05' then 2
            when 'A06' then 3
            end),EXTRA_ID desc
    </select>
    <select id="selectdeptidbyname" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select CD_CODE FROM TT_CODE WHERE KJ_NAME=#dept_id#
    </select>
    <select id="maxcount" parameterClass="java.lang.Integer"
        resultClass="java.lang.Integer">

        select max(cast(EXAMINE_ID as int) + 1) FROM
        TT_AUDIT_STATUS
    </select>
    <insert id="insertextraValidation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        INSERT INTO TT_AUDIT_STATUS
        (EXAMINE_ID,OBJECT_TYPE,OBJECT_ID,EXAMINE_PERSON,UPD_TIME,EXAMINE_STATUS)
        VALUES(#examine_id#,#dept_id#,#extra_id#,#leader#,#creat_time#,#extra_auditss# )
    </insert>
    <update id="updateex_days"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_VOCATION set EX_DAYS =#ex_days# where USER_ID
        =#user_id#
    </update>
    <delete id="deleteOverTimeById" parameterClass="java.lang.String">
        delete from
        TT_EXTRA_MANAGEMENT where EXTRA_ID =#deleteExtra_Id#
    </delete>
     <update id="deleteExaminePerson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_EXTRA_MANAGEMENT
        SET EXAMINE_PERSON =null
        where EXTRA_ID = #extra_id#
    </update>
    <delete id="deleteAddsignInfoById" parameterClass="java.lang.String">
        delete from
        TT_ADDSIGN_INFO where RETROACTIVE_ID =#deleteExtra_Id#
    </delete>


    <!-- JNTCIIntelligence -->


    <select id="getDeptNameListA"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIIntelligenceVo">
        select
        CD_CODE,
        KJ_NAME
        from TT_CODE
        WHERE CD_KUBUN = 'A1'

    </select>

    <select id="getkubunList"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIIntelligenceVo">
        select
        CD_CODE,
        KJ_NAME
        from TT_CODE
        WHERE CD_KUBUN = 'C3'
    </select>
    <select id="personList"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIIntelligenceVo">
        select DISTINCT LEADER from TT_SYS_USER
    </select>
    <select id="USERIdList" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIIntelligenceVo">
        select USER_ID, c.KJ_NAME
        kj_name,DEPT_PERSON,LEADER,code.KJ_NAME ckj_name
        from TT_SYS_USER u
        inner join TT_CODE c on u.DEPT_ID=c.CD_CODE
        inner join TT_CODE code on
        u.PROJECT_ID=code.CD_CODE
        where USER_ID=#userId#
    </select>
    <select id="entryList"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIIntelligenceVo">
        select
        CD_CODE,
        KJ_NAME
        from TT_CODE
        WHERE CD_KUBUN = 'S1'
    </select>
    <update id="userUpdate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIIntelligenceInput">
        update TT_SYS_USER
        set DEPT_ID = #dept_id#
        ,DEPT_PERSON =
        #ku_id#
        ,LEADER=#per_id#,
        PROJECT_ID=#entry_id#
        where USER_ID = #userId#
    </update>
    <select id="infoListDownLoadFileId" resultClass="java.lang.String"
		resultSetType="SCROLL_INSENSITIVE">
		SELECT
		TENPU_PATH
		FROM  TT_ADDSIGN_INFO
		WHERE RETROACTIVE_ID = #RETROACTIVE_ID#
	</select>
	<update id="infoListDownLoadFileIdUpdate">
		update TT_ADDSIGN_INFO
	SET
		JN_CARD = #JN_CARD#,

		reason_type = #reason_type#,
		TENPU_PATH=#filePath#,
		start_time_add = #start_time_add#,
			end_time_add = #end_time_add#
		where RETROACTIVE_ID = #RETROACTIVE_ID#
	</update>



		<select id="infoListDownLoad"
		resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoOut">
	   SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME
        ,
        code1.KJ_NAME as k_name,
         REASON_TYPE as reason_type ,
        u.LEADER as person,
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        info.RETROACTIVE_REASON,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as END_TIME_ADD,
        code2.KJ_NAME as shencha,
        info.TENPU_PATH as tenpu_path,
        info.RETROACTIVE_STATUS
        FROM
        TT_ADDSIGN_INFO info
        inner join TT_CODE code
        on
        info.RETROACTIVE_TYPE=code.CD_CODE and code.CD_KUBUN='A8'
        inner join
        TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        inner join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
        inner join TT_CODE code2
        on
        code2.CD_CODE=info.RETROACTIVE_STATUS

where		info.RETROACTIVE_ID = #RETROACTIVE_ID#
	</select>
<select id="infoListCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
           SELECT
        count(1)
        FROM

        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
           <dynamic prepend="WHERE ">
                    1=1   and    (info.RETROACTIVE_STATUS='A04' or   info.RETROACTIVE_STATUS='A07' or   info.RETROACTIVE_STATUS='A01')   and  (CODE2.KJ_NAME='公用修正')
              <isNotEmpty property="userName">
             and  u.leader=#userName#
              </isNotEmpty>
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
                 <isNotEmpty property="USER_NAME_SEARCH"> and
                 u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                and
                info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
             <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
        </dynamic>

    </select>

    <select id="infoList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAddsignInfoVo">
            SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME ,
        code1.KJ_NAME as k_name,
        u.LEADER as person,
       CODE2.KJ_NAME  as  reason_type，
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss')
        as
        START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as
        END_TIME_ADD,
        info.RETROACTIVE_REASON,

        info.RETROACTIVE_STATUS as status
        FROM
        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
        <dynamic prepend="WHERE ">
           (info.RETROACTIVE_STATUS='A04' or   info.RETROACTIVE_STATUS='A07' or   info.RETROACTIVE_STATUS='A01' )      and  (CODE2.KJ_NAME='公用修正')
              <isNotEmpty property="userName">
             and  u.leader=#userName#
              </isNotEmpty>
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
                 <isNotEmpty property="USER_NAME_SEARCH"> and
                  u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                and
                info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
               order by case  info.RETROACTIVE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end，info.RETROACTIVE_ID DESC
        </dynamic>
    </select>
     <select id="infoListCount1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
           SELECT
        count(1)
        FROM

        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
           <dynamic prepend="WHERE ">
               (info.RETROACTIVE_STATUS='A04' or   info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' )   and  (CODE2.KJ_NAME='私用修正')
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
              <isNotEmpty property="USER_NAME_SEARCH"> and
              u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                and
                info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
        </dynamic>

    </select>

  <select id="infoList1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAddsignInfoVo">
            SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME ,
        code1.KJ_NAME as k_name,
        u.LEADER as person,
       CODE2.KJ_NAME  as  reason_type，
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss')
        as
        START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as
        END_TIME_ADD,
        info.RETROACTIVE_REASON,

        info.RETROACTIVE_STATUS as status
        FROM
        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE

        <dynamic prepend="WHERE ">
            (info.RETROACTIVE_STATUS='A04' or   info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' )  and  (CODE2.KJ_NAME='私用修正')
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
                          <isNotEmpty property="USER_NAME_SEARCH">
                  and
       u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                and
                info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
                order by case  info.RETROACTIVE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end，info.RETROACTIVE_ID DESC
        </dynamic>
    </select>
   <!--  棟桑登录 -->

<select id="infoListCount2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
        SELECT count(1) from (
        SELECT *
        FROM TT_ADDSIGN_INFO info
        left join TT_CODE code
        on info.RETROACTIVE_TYPE=code.CD_CODE and code.CD_KUBUN='A8'
        left join TT_CODE CODE2
        on info.REASON_TYPE=CODE2.CD_CODE and CODE2.CD_KUBUN='A8'
        left join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on u.DEPT_ID=code1.CD_CODE

         <dynamic prepend="WHERE ">
        (code1.KJ_NAME='技術開発部') and
             (((u.LEADER ='張棟')and((CODE2.KJ_NAME='公用修正')))or((u.LEADER !='張棟')and(  (info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' or   info.RETROACTIVE_STATUS='A01' )   and  (CODE2.KJ_NAME='公用修正'))))
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
            <isNotEmpty property="USER_NAME_SEARCH">
                 and u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                  and info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
        </dynamic>
        )
    </select>
<select id="infoList2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAddsignInfoVo">
       	  SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME ,
        code1.KJ_NAME as k_name,
        u.LEADER as person,
       CODE2.KJ_NAME  as  reason_type，
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss')
        as
        START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as
        END_TIME_ADD,
        info.RETROACTIVE_REASON,

        info.RETROACTIVE_STATUS as status
        FROM
        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE

         <dynamic prepend="WHERE ">
             (code1.KJ_NAME='技術開発部') and
             (((u.LEADER ='張棟')and((CODE2.KJ_NAME='公用修正')))or((u.LEADER !='張棟')and(  (info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' or   info.RETROACTIVE_STATUS='A01')   and  (CODE2.KJ_NAME='公用修正'))))
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
            <isNotEmpty property="USER_NAME_SEARCH">
                 and u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                  and info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>

        </dynamic>
        order by(case  RETROACTIVE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end) ，RETROACTIVE_ID DESC
    </select>
  <!--衣总公用，管理部 -->
 <select id="infoListCount3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
           SELECT
        count(1)
        FROM

        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
           <dynamic prepend="WHERE ">
             (code1.KJ_NAME='管理部') and    (info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' or   info.RETROACTIVE_STATUS='A04')   and  (CODE2.KJ_NAME='公用修正')
              <!-- <isNotEmpty property="userName">
             and  u.leader=#userName#
              </isNotEmpty> -->
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
                 <isNotEmpty property="USER_NAME_SEARCH"> and
                 u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                  and info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
        </dynamic>

    </select>

    <select id="infoList3"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAddsignInfoVo">
            SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME ,
        code1.KJ_NAME as k_name,
        u.LEADER as person,
       CODE2.KJ_NAME  as  reason_type，
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss')
        as
        START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as
        END_TIME_ADD,
        info.RETROACTIVE_REASON,

        info.RETROACTIVE_STATUS as status
        FROM
        TT_ADDSIGN_INFO info
        left join TT_CODE
        code
        on info.RETROACTIVE_TYPE=code.CD_CODE and
        code.CD_KUBUN='A8'

        left join TT_CODE CODE2

        on info.REASON_TYPE=CODE2.CD_CODE and
        CODE2.CD_KUBUN='A8'

        left
        join TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        left join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
        <dynamic prepend="WHERE ">
       (code1.KJ_NAME='管理部')  and    (info.RETROACTIVE_STATUS='A05' or   info.RETROACTIVE_STATUS='A06' or   info.RETROACTIVE_STATUS='A04')   and  (CODE2.KJ_NAME='公用修正')
            <!--   <isNotEmpty property="userName">
             and  u.leader=#userName#
              </isNotEmpty> -->
            <isNotEmpty property="JN_CARD_SEARCH"> and
                JN_CARD =#JN_CARD_SEARCH#
            </isNotEmpty>
                 <isNotEmpty property="USER_NAME_SEARCH"> and
                  u.USER_NAME  like  '%$USER_NAME_SEARCH$%'
            </isNotEmpty>
            <isNotEmpty property="retroactive_type2">
                and
                RETROACTIVE_TYPE=#retroactive_type2#
            </isNotEmpty>
            <isNotEmpty property="retroactive_auditss_search">
                  and info.RETROACTIVE_STATUS=#retroactive_auditss_search#
            </isNotEmpty>
            <isNotEmpty property="retroactive_starttime_search">
                and
               to_char(info.START_TIME_ADD,'yyyy-mm-dd hh24:mi') &gt;=
                #retroactive_starttime_search#
            </isNotEmpty>

            <isNotEmpty property="retroactive_endtime_search">
                and
                to_char(info.END_TIME_ADD,'yyyy-mm-dd hh24:mi') &lt;=
                #retroactive_endtime_search#
            </isNotEmpty>
                 order by case  info.RETROACTIVE_STATUS
            when 'A04' then 1
            when 'A01' then 2
            when 'A07' then 3
            when 'A08' then 4
            when 'A09' then 5
            when 'A05' then 6
            when 'A06' then 7
            end，info.RETROACTIVE_ID DESC
        </dynamic>
    </select>



<select id="gerenList"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAddsignInfoVo">
                SELECT
        info.RETROACTIVE_ID,
        JN_CARD,
        u.USER_NAME as USER_NAME
        ,
        code1.KJ_NAME as k_name,
         REASON_TYPE as reason_type ,
        u.LEADER as person,
        code.KJ_NAME as
        RETROACTIVE_TYPE,
        info.RETROACTIVE_REASON,
        to_char(info.START_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as START_TIME_ADD,
        to_char(info.END_TIME_ADD,'yyyy/mm/dd hh24:mi:ss') as END_TIME_ADD,
        code2.KJ_NAME as shencha,
        info.TENPU_PATH as tenpu_path,
        info.RETROACTIVE_STATUS
        FROM
        TT_ADDSIGN_INFO info
        inner join TT_CODE code
        on
        info.RETROACTIVE_TYPE=code.CD_CODE and code.CD_KUBUN='A8'
        inner join
        TT_SYS_USER u
        on u.USER_ID=info.JN_CARD
        inner join TT_CODE code1
        on
        u.DEPT_ID=code1.CD_CODE
        inner join TT_CODE code2
        on
        code2.CD_CODE=info.RETROACTIVE_STATUS
        where info.RETROACTIVE_ID=#card_id#
    </select>
    <select id="selectuserId"
            resultClass="java.lang.String">
        SELECT USER_ID
        FROM TT_SYS_USER
        WHERE USER_NAME=#USER_NAME#
    </select>
    <select id="selectAddsign"
            resultClass="java.lang.Integer">
        select count(*)
        from TT_ADDSIGN_INFO
        where
        RETROACTIVE_ID=#RETROACTIVE_ID#
    </select>
 <!--更新审查表状态-->
    <update id="statusUpdate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput">
        update TT_ADDSIGN_INFO SET
        RETROACTIVE_STATUS =#examine_status#,         UPD_TIME=TO_CHAR(SYSDATE,'YY/MM/DD HH24:MI:SS')
        where
        RETROACTIVE_ID=#RETROACTIVE_ID#
    </update>
    <!--午前补卡考勤修正  -->
    <update id="addManager_update_starttime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput">
       update TT_ATTENCE_MANAGER
       set
        START_TIME = #start_time_add#，
        START_TIME_BEFORE=#start_time_before#
      where
         HIDUKE=substr(#start_time_add#,0,10)
         and JN_CARD = #JN_CARD#
    </update>
    <!-- 午后补卡考勤修正 -->
    <update id="addManager_update_endtime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput">
       update TT_ATTENCE_MANAGER
       set
        END_TIME = #end_time_add#，
        END_TIME_BEFORE=#end_time_before#
      where
         HIDUKE=substr(#end_time_add#,0,10)
         and JN_CARD = #JN_CARD#
    </update>

	<select id="buqiantimes"
            resultClass="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM tt_addsign_info
        WHERE
        JN_CARD = #JN_CARD#
        AND to_char(RETROACTIVE_SYSTIME,'yyyy/mm')=#ym# and
        retroactive_status ='A06'
   </select>

    <update id="updateManager">
        UPDATE TT_ATTENCE_MANAGER
        SET
        TIME_COUNT=#timeCount#,
        TOROKU_USER=#userId#，
        TOROKU_TIMESTAMP=#toroku_timeStamp#,
        MONTH=#month#
        WHERE
        JN_CARD=#JN_CARD#
        AND
        HIDUKE=#start_time_add_search#
    </update>
    <!--登录申请的年月和扣除时间  -->
    <update id="updateAddSign">
        UPDATE TT_ADDSIGN_INFO
        SET
            SHNSEI_TIME=#shnsei_time#,
            KOJYO_TIME=#kojyo_time#
        WHERE
        RETROACTIVE_ID=#RETROACTIVE_ID#
    </update>

     <insert id="addManager_update_alltime"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput">
        INSERT INTO TT_ATTENCE_MANAGER
        (
            HIDUKE,
            JN_CARD,
            NAME,
            DEPT_ID,
            START_TIME,
            END_TIME,
            START_TIME_BEFORE,
            END_TIME_BEFORE
        )
        VALUES
        (
            #start_time_add_search#,
            #JN_CARD#,
            (SELECT USER_NAME FROM TT_SYS_USER WHERE USER_ID=#JN_CARD#),
            (SELECT CD_CODE FROM TT_CODE WHERE CD_KUBUN='A1' AND KJ_NAME=#k_name#),
            #start_time_add#,
            #end_time_add#,
            #start_time_before#,
            #end_time_before#
        )
    </insert>

     <select id="adddaytime"
            resultClass="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM TT_ATTENCE_MANAGER
        WHERE
        JN_CARD = #JN_CARD#
        AND HIDUKE=#start_time_add_search#
   </select>
   <select id="selectStartTime"
            resultClass="java.lang.String">
        select START_TIME
        FROM TT_ATTENCE_MANAGER
        where
        HIDUKE=#start_time_add_search#
        and JN_CARD=#JN_CARD#
   </select>
   <select id="selectStartTimeBefore"
            resultClass="java.lang.String">
        select START_TIME_BEFORE
        FROM TT_ATTENCE_MANAGER
        where
        HIDUKE=#start_time_add_search#
        and JN_CARD=#JN_CARD#
   </select>
   <select id="selectEndTime"
            resultClass="java.lang.String">
        select END_TIME
        FROM TT_ATTENCE_MANAGER
        where
        HIDUKE=#start_time_add_search#
        and JN_CARD=#JN_CARD#
   </select>
   <select id="selectEndTimeBefore"
            resultClass="java.lang.String">
        select END_TIME_BEFORE
        FROM TT_ATTENCE_MANAGER
        where
        HIDUKE=#start_time_add_search#
        and JN_CARD=#JN_CARD#
   </select>
   <select id="queryStatus"
           resultClass="java.lang.String">
        select RETROACTIVE_STATUS
        from TT_ADDSIGN_INFO
        where RETROACTIVE_ID=#RETROACTIVE_ID#
   </select>
   <delete id="deleteAddsign">
        delete from TT_ADDSIGN_INFO
        where
        RETROACTIVE_ID=#RETROACTIVE_ID#
   </delete>
   <delete id="deleteManager">
    delete from TT_ATTENCE_MANAGER
    where JN_CARD=#JN_CARD#
    and HIDUKE=#start_time_add_search#
   </delete>
    <!--====================================JNTCIAddsignInfo END ================================================= -->


    <!-- Query -->
    <insert id="insertCheckValue"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">
        update TT_ATTENCE_MANAGER_TEMP set CHECKVALUE=#checkValue#
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="ATTENDANCE_ID">
                and ATTENDANCE_ID = #ATTENDANCE_ID#
            </isNotEmpty>
        </dynamic>
    </insert>
    <insert id="insert"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">
        update TT_ATTENCE_MANAGER_TEMP set CHECKVALUE=#checkValue#
        where ATTENDANCE_ID =
        #ATTENDANCE_ID#
    </insert>
    <insert id="insertLeaveCheckValue"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">
        update TT_LEAVE_MANAGER set CHECKVALUE=#checkValue#
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_Id">
                and LEAVE_ID = #leave_Id#
            </isNotEmpty>
        </dynamic>
    </insert>

    <!-- Query 查询 ATTENDANCE_ID AS ATTENDANCE_ID, -->
    <select id="getUserList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">

        SELECT *
        FROM
        (SELECT TO_CHAR(A.START_TIME,'yyyy-mm-dd') as time,
        A.JN_CARD AS JN_CARD,
        A.ATTENDANCE_ID AS ATTENDANCE_ID,
        null AS
        LEAVE_ID,
        A.NAME AS NAME,
        A.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd hh24:mi') AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        KDkd.KJ_NAME AS
        deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME AS
        LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS
        REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME AS EXTRA_TYPE
        FROM
        TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        b.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(A.START_TIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
        UNION ALL

        SELECT TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd'),
        B.JN_CARD AS
        JN_CARD,
        null AS ATTENDANCE_ID,
        B.LEAVE_ID AS LEAVE_ID,
        B.NAME AS NAME,
        B.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd hh24:mi')
        AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        KDkd.KJ_NAME AS deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME
        AS LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS
        REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME AS EXTRA_TYPE
        FROM
        TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        B.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
        )
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="JN_CARD">
                and JN_CARD = #JN_CARD#
            </isNotEmpty>

            <isNotEmpty property="NAME">
                and NAME = #NAME#
            </isNotEmpty>

            <isNotEmpty property="deptuser_id">
                and DEPT_Name_id = #deptuser_id#
            </isNotEmpty>
            <isNotEmpty property="attendanceStatus">
                and CHECKVALUE = #attendanceStatus#
            </isNotEmpty>

            <isNotEmpty property="leave_starttime">
                and START_TIME like
                #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
    </select>

    <select id="getLeavesDataUserList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">

        SELECT *
        FROM
        (SELECT JN_CARD AS JN_CARD,
        NULL AS chechValue2,
        NULL AS
        leave_Id,
        CHECKVALUE
        AS CHECKVALUE,
        CHECKVALUE AS checkException,
        NAME AS
        NAME,
        code1.KJ_NAME
        AS DEPT_ID,
        code1.CD_CODE AS DEPT_Name,
        TO_CHAR(TT_ATTENCE_MANAGER_TEMP.START_TIME,'yyyy-mm-dd hh24:mi') AS
        START_TIME,
        TO_CHAR(TT_ATTENCE_MANAGER_TEMP.END_TIME,'yyyy-mm-dd hh24:mi')
        AS
        END_TIME,
        NULL AS LEAVE_TOTALTIME,
        NULL AS LEAVE_TYPE,
        REMAIN_DAYS AS
        REMAIN_DAYS,
        EXTRA_TIME AS EXTRA_TIME,
        TT_CODEjb.KJ_NAME AS EXTRA_TYPE
        FROM TT_ATTENCE_MANAGER_TEMP
        LEFT JOIN TT_CODE code1
        ON
        TT_ATTENCE_MANAGER_TEMP.DEPT_ID=code1.CD_CODE
        LEFT JOIN TT_VOCATION
        ON
        TT_VOCATION.USER_ID=TT_ATTENCE_MANAGER_TEMP.JN_CARD
        LEFT JOIN
        TT_EXTRA_MANAGEMENT
        ON TT_EXTRA_MANAGEMENT.USER_ID
        =TT_ATTENCE_MANAGER_TEMP.JN_CARD
        AND
        TO_CHAR(TT_ATTENCE_MANAGER_TEMP.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(TT_EXTRA_MANAGEMENT.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND
        TT_EXTRA_MANAGEMENT.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE TT_CODEjb
        ON
        TT_CODEjb.CD_CODE =TT_EXTRA_MANAGEMENT.EXTRA_TYPE
        AND
        TT_CODEjb.CD_KUBUN='B3'
        UNION ALL
        SELECT JN_CARD AS JN_CARD,
        CHECKVALUE
        AS chechValue2,
        LEAVE_ID AS leave_Id,
        NULL AS CHECKVALUE,
        NULL AS
        checkException,
        NAME AS NAME,
        code2.KJ_NAME AS DEPT_ID,
        code2.CD_CODE AS
        DEPT_Name,
        TO_CHAR(LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') AS START_TIME,
        TO_CHAR(
        LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        LEAVE_TOTALTIME AS
        LEAVE_TOTALTIME,
        code3.KJ_NAME AS LEAVE_TYPE,
        NULL AS
        REMAIN_DAYS,
        NULL AS
        EXTRA_TIME,
        NULL AS EXTRA_TYPE
        FROM TT_LEAVE_MANAGER
        LEFT JOIN TT_CODE
        code2
        ON TT_LEAVE_MANAGER.DEPT_ID=code2.CD_CODE
        LEFT
        JOIN TT_CODE code3
        ON TT_LEAVE_MANAGER.LEAVE_TYPE=code3.CD_CODE
        )
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="JN_CARD">
                and JN_CARD = #JN_CARD#
            </isNotEmpty>

            <isNotEmpty property="NAME">
                and NAME = #NAME#
            </isNotEmpty>
            <isNotEmpty property="deptuser_id">
                and DEPT_Name = #deptuser_id#
            </isNotEmpty>

            <isNotEmpty property="leave_starttime">
                and START_TIME like
                #leave_starttime#||'%'
            </isNotEmpty>


            <isNotEmpty property="checkValue">
                and checkValue like #checkValue#
            </isNotEmpty>

            <isNotEmpty property="attendanceStatus">
                and chechValue2 = #attendanceStatus#
            </isNotEmpty>

        </dynamic>
    </select>
    <select id="getCheckValue" parameterClass="java.lang.Integer"
        resultClass="java.lang.String">
        SELECT CHECKVALUE from TT_LEAVE_MANAGER WHERE
        LEAVE_ID=#leave_Id#
    </select>
    <!-- Query 总条数 -->
    <select id="getUserCountList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="java.lang.String">

        SELECT count(*)
        FROM
        (SELECT TO_CHAR(A.START_TIME,'yyyy-mm-dd'),
        A.JN_CARD AS JN_CARD,
        A.NAME AS NAME,
        A.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd hh24:mi') AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        KDkd.KJ_NAME AS
        deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME AS
        LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS
        REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME AS EXTRA_TYPE
        FROM
        TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        b.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(A.START_TIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>

        UNION ALL
        SELECT TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd'),
        B.JN_CARD AS
        JN_CARD,
        B.NAME AS NAME,
        B.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd hh24:mi') AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        KDkd.KJ_NAME AS
        deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME AS
        LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS
        REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME AS EXTRA_TYPE
        FROM
        TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        B.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
        )
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="JN_CARD">
                and JN_CARD = #JN_CARD#
            </isNotEmpty>

            <isNotEmpty property="NAME">
                and NAME = #NAME#
            </isNotEmpty>

            <isNotEmpty property="deptuser_id">
                and DEPT_Name_id = #deptuser_id#
            </isNotEmpty>
            <isNotEmpty property="attendanceStatus">
                and CHECKVALUE = #attendanceStatus#
            </isNotEmpty>

            <isNotEmpty property="leave_starttime">
                and START_TIME like
                #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
    </select>
    <!-- <select id="getEvection" resultClass="java.lang.String"> select count(1)
        from TT_EVECTION_DATA </select> -->
    <!-- Query 部门类型 -->
    <select id="getListDeptName"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">
        select
        CD_CODE,
        KJ_NAME
        from TT_CODE
        WHERE CD_KUBUN = 'A1'
    </select>

    <!-- Query 出差 判断 -->
    <select id="chuchaiif" parameterClass="java.lang.String"
        resultClass="java.lang.String">


        <!-- select count(*) as count from TT_EVECTION_DATA where TT_EVECTION_DATA.USER_ID=
            #temp# -->

        select COUNT(*) from TT_EVECTION_DATA where USER_ID=#temp#


    </select>


    <select id="getUserShuJu"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIQueryOutvo">
        SELECT *
        FROM
        (SELECT TO_CHAR(A.START_TIME,'yyyy-mm-dd'),
        A.JN_CARD AS
        JN_CARD,
        A.ATTENDANCE_ID AS ATTENDANCE_ID,
        null AS LEAVE_ID,
        A.NAME AS
        NAME,
        A.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd
        hh24:mi') AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS
        END_TIME,
        KDkd.KJ_NAME AS deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME AS LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME
        AS EXTRA_TYPE
        FROM TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        b.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(A.START_TIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>

        UNION ALL
        SELECT TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd'),
        B.JN_CARD AS
        JN_CARD,
        null AS ATTENDANCE_ID,
        B.LEAVE_ID AS LEAVE_ID,

        B.NAME AS NAME,
        B.CHECKVALUE AS checkValue,
        TO_CHAR(A.START_TIME,'yyyy-mm-dd hh24:mi')
        AS START_TIME,
        TO_CHAR(A.END_TIME,'yyyy-mm-dd hh24:mi') AS END_TIME,
        KDkd.KJ_NAME AS deptid,
        KDkd.CD_CODE AS DEPT_Name_id,
        B.LEAVE_TOTALTIME
        AS LEAVE_TOTALTIME,
        CDqjType.KJ_NAME AS LEAVE_TYPE,
        C.REMAIN_DAYS AS
        REMAIN_DAYS,
        D.EXTRA_TIME AS EXTRA_TIME,
        CDjb.KJ_NAME AS EXTRA_TYPE
        FROM
        TT_ATTENCE_MANAGER_TEMP A
        FULL JOIN TT_LEAVE_MANAGER B
        ON
        TO_CHAR(A.START_TIME,'yyyy-mm-dd') =
        TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd')
        AND A.JN_CARD = B.JN_CARD
        LEFT
        JOIN TT_CODE KDkd
        ON KDkd.CD_CODE = A.DEPT_ID
        LEFT JOIN TT_VOCATION C
        ON
        C.USER_ID=A.JN_CARD
        LEFT JOIN TT_EXTRA_MANAGEMENT D
        ON D.USER_ID
        =A.JN_CARD
        AND TO_CHAR(A.START_TIME,'yyyy-mm-dd')
        =TO_CHAR(D.EXTRA_STARTTIME,'yyyy-mm-dd')
        AND D.EXTRA_AUDITSS ='A03'
        LEFT JOIN TT_CODE CDjb
        ON CDjb.CD_CODE =D.EXTRA_TYPE
        AND
        CDjb.CD_KUBUN='B3'
        LEFT JOIN TT_CODE CDqjType
        ON CDqjType.CD_CODE =
        B.LEAVE_TYPE
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="leave_starttime">
                and
                TO_CHAR(B.LEAVE_STARTTIME,'yyyy-mm-dd') like #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
        )
        <dynamic prepend="WHERE">
            1=1
            <!-- <isNotEmpty property="JN_CARD"> and JN_CARD = #JN_CARD# </isNotEmpty>
                <isNotEmpty property="NAME"> and NAME = #NAME# </isNotEmpty> <isNotEmpty
                property="deptuser_id"> and DEPT_Name_id = #deptuser_id# </isNotEmpty> <isNotEmpty
                property="attendanceStatus"> and CHECKVALUE = #attendanceStatus# </isNotEmpty> -->

            <isNotEmpty property="leave_starttime">
                and START_TIME like
                #leave_starttime#||'%'
            </isNotEmpty>
        </dynamic>
    </select>


    <select id="SelectEmpInfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionOutput">
        SELECT USER_ID as info_EmpNo,USER_NAME as user_Name,EMP_POSITION as
        emp_Position FROM TT_SYS_USER
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="info_EmpNo">
                and USER_ID = #info_EmpNo#
            </isNotEmpty>
            <isNotEmpty property="emp_Position">
                and EMP_POSITION = #emp_Position#
            </isNotEmpty>
        </dynamic>
    </select>

    <update id="UpdateEmpPosition"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput">
        update TT_SYS_USER
        set EMP_POSITION = #emp_Position#
        where USER_ID = #info_EmpNo#
    </update>



    <!-- =================================================================================================================================== -->

    <select id="JNTCIPositionUpdateUserCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput"
        resultClass="java.lang.Integer">
        SELECT COUNT(*)
        FROM TT_PERSONAL_BASIC_INFO
        WHERE JN_CARD =
        #info_EmpNo#
    </select>

    <select id="JNTCIPositionUpdatePositionCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput"
        resultClass="java.lang.Integer">
        SELECT COUNT(*)
        FROM TT_POSITION

        WHERE POSITION_ID =
        #emp_Position#
    </select>

    <update id="OldPositionUserId"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput">

        UPDATE TT_POSITION SET JN_CARD = '' ,KOSHIN_TIMESTAMP =
        #systemTime#
        ,KOSHIN_USER = #userId# WHERE JN_CARD = #info_EmpNo#

    </update>

    <update id="NewPositionUserId"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput">

        UPDATE TT_POSITION SET JN_CARD = #info_EmpNo#
        ,KOSHIN_TIMESTAMP =
        #systemTime# ,KOSHIN_USER = #userId# WHERE
        POSITION_ID =
        #emp_Position#

    </update>

    <update id="OldPersonalPositionId"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput">

        UPDATE TT_PERSONAL_BASIC_INFO SET POSITION_ID = ''
        ,KOSHIN_TIMESTAMP =
        #systemTime# ,KOSHIN_USER = #userId# WHERE
        POSITION_ID =
        #emp_Position#

    </update>

    <update id="NewPersonalPositionId"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPositionUpdateInput">

        UPDATE TT_PERSONAL_BASIC_INFO SET POSITION_ID =
        #emp_Position#
        ,KOSHIN_TIMESTAMP = #systemTime# ,KOSHIN_USER = #userId#
        WHERE JN_CARD
        = #info_EmpNo#

    </update>

    <select id="infoEmpNoListId"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIEmpPositionVo">
       SELECT CONCAT(JN_CARD,USERNAME) AS KEY, CONCAT(JN_CARD,USERNAME) AS VAlUE FROM TT_PERSONAL_BASIC_INFO WHERE POSITION_ID IS NULL ORDER BY JN_CARD
    </select>

    <!-- =================================================================================================================================== -->
    <!-- 个人登录SQL追加部分 -->
    <select id="selectloginPersonalInfoLanguage" resultClass="java.lang.Integer">
        SELECT
        max(ID) FROM PERSONALPROFILE
    </select>


    <insert id="loginPersonalInfoLanguage"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #language2#,
        #level#,
        #work_time#,
        #yanyu#
        )

    </insert>

    <insert id="loginPersonalInfoJavaEnvironment"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #javaenvironment#,
        #level#,
        #work_time#,
        #javahuanjing#
        )

    </insert>

    <insert id="loginPersonalInfoJavaLanguage"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #javalanguage#,
        #level#,
        #work_time#,
        #javayuyan#
        )

    </insert>

    <insert id="loginPersonalInfoTool"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #tool#,
        #level#,
        #work_time#,
        #toolid#
        )

    </insert>


    <insert id="loginPersonalInfoDb"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #db#,
        #level#,
        #work_time#,
        #dbid#
        )

    </insert>
    <insert id="loginPersonalInfoOs"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into PERSONALPROFILE(
        ID,
        JN_CARD,
        SOFTWARENAME,
        SKILL_LEVEL,
        EXPERIENCEYEARS,
        CLASSIFICATION
        )values(
        #personinfoid#,
        #jn_Card#,
        #os#,
        #level#,
        #work_time#,
        #osid#
        )

    </insert>

    <insert id="loginPersonalInfojapan"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">
        insert into PERSONALPROFILE(
        CLASSIFICATION,
        SOFTWARENAME,
        SORTS,
        JN_CARD,
        ID
        )values(
        #japanl#,
        #japanl#,
        #japanStr#,
        #jn_Card#,
        #personinfoid#
        )
    </insert>

    <insert id="loginPersonalInfoenglish"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">
        insert into PERSONALPROFILE(
        CLASSIFICATION,
        SOFTWARENAME,
        SORTS,
        JN_CARD,
        ID
        )values(
        #englishl#,
        #englishl#,
        #englishStr#,
        #jn_Card#,
        #personinfoid#
        )
    </insert>
    <!-- ===================================================================================== -->


    <update id="Deleteman"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput">
        update TT_PERSONAL_BASIC_INFO
        set POSITION_ID = ''
        where POSITION_ID =#emp_Position#
    </update>

    <update id="DeletePosition"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput">
        update TT_POSITION
        set JN_CARD = '',
        KOSHIN_USER = #info_EmpNo#,
        KOSHIN_TIMESTAMP=#systemTime#
        where POSITION_ID =#emp_Position#
    </update>

    <!-- <update id="deleterecord"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput">
        update TT_POSITION
        set KOSHIN_USER = #info_EmpNo#,
        KOSHIN_TIMESTAMP=sysdate
        where POSITION_ID =#emp_Position#
    </update> -->

    <!-- ===================================================================================== -->
    <!-- END -->

    <select id="selectdownloadInfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as userId,
        TT_ED.USER_NAME as userName,
        TT_ED.EXAMINE_STATUS as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as
        evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TT_ED.EVECTION_REASON as evectionReason,
        to_char(TT_ED.CRE_DATETM,'yyyy-MM-dd HH:mm:ss') as creDateTm,
        TT_ED.TJ_USER_ID as tjUserId,
        <!-- TT_ED.SEX as sex, -->
        decode(TT_ED.SEX,'0','女','1','男') as sex,
        TT_ED.POSITION_ID as positionId,
        TT_ED.PROJECT_ID as projectId,
        <!-- TT_ED.PROJECT_NAME as projectName, -->
        TT_ED.DEPENDENCY as dependency,
        TT_ED.ID_CADE as idCard,
        to_char(TT_ED.DEPARTURE_TIME, 'yyyy-MM-dd HH:mm:ss') as departureTime,
        TT_ED.PASSPORT as passport,
        TT_ED.VISA as visa,
        TT_ED.PASSPORT_ID as passportId,
        to_char( TT_ED.PASSPORT_VALIDITY, 'yyyy-MM-dd HH:mm:ss') as passportValidity,
        TT_ED.LEAVE as leave,
        TT_ED.REACH_PLACE as reachPlace,
        TT_ED.NAME_PINYIN as namePinyin,
        TT_ED.TRAFFIC_RESERVE_PERSION as trafficReservetPerson,
        TT_ED.TRAFFIC_EXPLAIN as trafficExplain,
        to_char( TT_ED.HOTEL_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as hotelStartTime,
        to_char(TT_ED.HOTEL_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as hotelEndTime,
        TT_ED.HOTEL_DESTINATION as hotelDestination,
        TT_ED.HOTEL_PERSON as hotelPerson,
        TT_ED.HOTEL_NUMBER as hotelNumber,
        TT_ED.HOTEL_RESERVE_PERSION as hotelReservePerson,
        TT_ED.HOTEL_EXPLAIN as hotelExplain,
        TT_ED.ARTICLE_NAME as articleName,
        to_char(TT_ED.TRANSFER_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as transferStartTime,
        to_char(TT_ED.TRANSFER_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as
        transferEndTime,
        TT_ED.RECIPIENT as recipient,
        TT_ED.STORAGES as storages,
        TT_ED.PASSPORT_LENGTH as passportLength,
        TT_ED.ARTICLE_REMARK as articleRemark,
        TT_ED.EVECTION_TYPE as evectionType
        FROM
        TT_EVECTION_DATA TT_ED
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="evectionId">
                and TT_ED.EVECTION_ID = #evectionId#
            </isNotEmpty>
        </dynamic>
    </select>


    <select id="selectdownloadInfoList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIBusinessVerify01Input"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIBusinessVerifyVo">
        SELECT
        TT_ED.EVECTION_ID as evectionId,
        TT_ED.USER_ID as userId,
        TT_ED.USER_NAME as userName,
        TT_ED.EXAMINE_STATUS as examineStatus,
        decode(TT_ED.DEPT_ID,'001','管理部','002','技術開発部') as deptId,
        to_char(TT_ED.EVECTION_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as
        evectionStartTime,
        to_char(TT_ED.EVECTION_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as evectionEndTime,
        TT_ED.EVECTION_DESTINATION as evectionDestination,
        TT_ED.EVECTION_REASON as evectionReason,
        to_char(TT_ED.CRE_DATETM,'yyyy-MM-dd HH:mm:ss') as creDateTm,
        TT_ED.TJ_USER_ID as tjUserId,
      <!--   TT_ED.SEX as sex, -->
        decode(TT_ED.SEX,'0','女','1','男') as sex,
        TT_ED.POSITION_ID as positionId,
        TT_ED.PROJECT_ID as projectId,
        TT_ED.DEPENDENCY as dependency,
        TT_ED.ID_CADE as idCard,
        to_char(TT_ED.DEPARTURE_TIME, 'yyyy-MM-dd HH:mm:ss') as departureTime,
        TT_ED.PASSPORT as passport,
        TT_ED.VISA as visa,
        TT_ED.PASSPORT_ID as passportId,

        to_char(TT_ED.PASSPORT_VALIDITY, 'yyyy-MM-dd HH:mm:ss') as passportValidity,
        TT_ED.LEAVE as leave,
        TT_ED.REACH_PLACE as reachPlace,
        TT_ED.NAME_PINYIN as namePinyin,
        TT_ED.TRAFFIC_RESERVE_PERSION as trafficReservetPerson,
        TT_ED.TRAFFIC_EXPLAIN as trafficExplain,
        to_char( TT_ED.HOTEL_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as hotelStartTime,
        to_char(TT_ED.HOTEL_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as hotelEndTime,
        TT_ED.HOTEL_DESTINATION as hotelDestination,
        TT_ED.HOTEL_PERSON as hotelPerson,
        TT_ED.HOTEL_NUMBER as hotelNumber,
        TT_ED.HOTEL_RESERVE_PERSION as hotelReservePerson,
        TT_ED.HOTEL_EXPLAIN as hotelExplain,
        TT_ED.ARTICLE_NAME as articleName,
        to_char(TT_ED.TRANSFER_STARTTIME, 'yyyy-MM-dd HH:mm:ss') as transferStartTime,
        to_char(TT_ED.TRANSFER_ENDTIME, 'yyyy-MM-dd HH:mm:ss') as
        transferEndTime,
        TT_ED.RECIPIENT as recipient,
        TT_ED.STORAGES as storages,
        TT_ED.PASSPORT_LENGTH as passportLength,
        TT_ED.ARTICLE_REMARK as articleRemark,
        TT_ED.EVECTION_TYPE as evectionType
        FROM
        TT_EVECTION_DATA TT_ED
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="evectionId">
                and TT_ED.EVECTION_ID = #evectionId#
            </isNotEmpty>
        </dynamic>
    </select>

    <select id="selectSkill"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoDetailedInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCISelectPersonalSkillInfo">
        SELECT
        CLASSIFICATION AS classification,
        SOFTWARENAME AS
        softwarename,
        SORTS AS sorts,
        SKILL_LEVEL AS skill_level,
        EXPERIENCEYEARS AS experienceyears,
        JN_CARD AS userid,
        ID AS id
        FROM
        PERSONALPROFILE
        WHERE JN_CARD=#id_card#
    </select>

    <select id="InitEmpInfoSouth"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionOutput">
        select
        TP.POSITION_ID as emp_Position
        ,TPBI.JN_CARD as
        info_EmpNo
        ,TPBI.USERNAME as user_Name
        ,TC.KJ_NAME as dept
        ,TPBI.PHOTO_PATH as photo
        from TT_POSITION TP
        left join
        TT_PERSONAL_BASIC_INFO TPBI
        on TP.JN_CARD = TPBI.JN_CARD
        inner join
        TT_CODE TC
        on TC.CD_KUBUN = 'A1'
        and TPBI.DEPARTMENT = TC.CD_CODE WHERE
        TP.POSITION_ID LIKE'A%'
    </select>

    <select id="InitEmpInfo"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIEmpPositionOutput">
        select
        TP.POSITION_ID as emp_Position
        ,TPBI.JN_CARD as
        info_EmpNo
        ,TPBI.USERNAME as user_Name
        ,TC.KJ_NAME as dept
        ,TPBI.PHOTO_PATH as photo
        from TT_POSITION TP
        left join
        TT_PERSONAL_BASIC_INFO TPBI
        on TP.JN_CARD = TPBI.JN_CARD
        inner join
        TT_CODE TC
        on TC.CD_KUBUN = 'A1'
        and TPBI.DEPARTMENT = TC.CD_CODE
    </select>
    <!-- ===================================================================================== -->

    <select id="selectNameInfoList"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTICIEmpPositionDownloadOutput">
        select
        USERNAME as user_Name,
        EXCEL_POSITION_X as
        excel_position_x,
        EXCEL_POSITION_Y as excel_position_y
        from
        TT_POSITION
        pos
        left join
        TT_PERSONAL_BASIC_INFO per
        on per.JN_CARD = pos.JN_CARD
    </select>
    <!-- ch begin -->
    <select id="selectTjCard" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        SELECT
        TJ_CARD
        FROM TT_PERSONAL_BASIC_INFO
        WHERE JN_CARD = #jn_Card#
    </select>

    <update id="loginPersonalInfoEm"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">
        update TT_PERSONAL_BASIC_INFO
        set TECH_CAPABILITY = #tech_capability#,WORK_EXPERIENCE =
        #work_Experience#
        where JN_CARD = #jn_Card#
    </update>
    <select id="selectworkexp"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput"
        resultClass="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM TT_WORK_EXPERIENCE
        WHERE JN_CARD = #jn_Card# AND TJ_CARD=#tj_Card#
    </select>
    <insert id="updatePersonalInfoWorkExperience"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">
        insert into TT_WORK_EXPERIENCE(
        TJ_CARD,
        JN_CARD,
        ORDER_NO,
        CAREERS_TYPE,
        PROJ_NAME,
        ATTEND_NM,
        ATTEND_MONTH,
        ATTEND_STATES,
        DEVELOP_PHASE,
        FIRM_CONTENT,
        LANG_TOOL,
        DATA_BASE,
        TECHNICAL_SYS,
        MODEL_DEVICE,
        DEVELOP_PERIOD,
        TOTAL_PERIOD,
        TOTOKU_TIMESTAMP,
        TOTOKU_USER,
        TOTOKU_PGM,
        KOSHIN_TIMESTAMP,
        KOSHIN_USER,
        KOSHIN_PGM
        )values(
        #tj_Card#,
        #jn_Card#,
        #order_no#,
        #careers_type#,
        #proj_name#,
        #attend_nm#,
        #attend_month#,
        #attend_states#,
        #develop_phase#,
        #firm_content#,
        #lang_tool#,
        #data_base#,
        #technical_sys#,
        #model_device#,
        #develop_period#,
        #total_period#,
        to_date(#logintime#,'yyyy-mm-dd hh24:mi:ss'),
        #jn_Card#,
        '個人情報修正',
        #login_time#,
        #jn_Card#,
        '個人情報修正'
        )
    </insert>
        <insert id="updatePersonalInfoOccupation"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIPersonalInfoLoginInput">

        insert into TT_VOCATIONAL_QUALI(
        TJ_CARD,
        JN_CARD,
        WINNING_DATE,
        WINNING_CERTIFICATE,
        TOTOKU_TIMESTAMP,
        TOTOKU_USER,
        TOTOKU_PGM,
        KOSHIN_TIMESTAMP,
        KOSHIN_USER,
        KOSHIN_PGM
        )values(
        #tj_Card#,
        #jn_Card#,
        #winning_date#,
        #wining_certificate#,
        to_date(#logintime#,'yyyy-mm-dd hh24:mi:ss'),
        #jn_Card#,
        '個人情報修正',
        #login_time#,
        #jn_Card#,
        '個人情報修正'
        )

    </insert>


    <!-- 选取登录时间 -->
    <select id="selectLoginTime" parameterClass="java.lang.String"
        resultClass="java.lang.String">
        select * from(
        SELECT
        to_char(TOTOKU_TIMESTAMP,'yyyy-mm-dd hh24:mi:ss')
        FROM TT_WORK_EXPERIENCE
        WHERE JN_CARD = #jn_Card#
        )
        where rownum =1
    </select>
    <!-- END -->
    <select id="ajaxSearchEmail"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingApplyInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingApplyAjaxOutput">
        SELECT
        TPBI.OFFIC_MAIL || '@trans-cosmos.com.cn' AS KEY,
        TC.KJ_NAME || '　　　' || TPBI.JN_CARD || '　　　' ||TPBI.USERNAME  AS VALUE
        FROM TT_PERSONAL_BASIC_INFO TPBI
        LEFT JOIN TT_CODE TC
        ON TC.CD_CODE = TPBI.DEPARTMENT
        <dynamic prepend="WHERE">
            TPBI.OFFIC_MAIL &lt;&gt; 'null'
            <isNotEmpty property="jnCard">
                and TPBI.JN_CARD LIKE #jnCard#||'%'
            </isNotEmpty>
            <isNotEmpty property="username">
                and TPBI.USERNAME LIKE
                #username#||'%'
            </isNotEmpty>
            <isNotEmpty property="officeMail">
                and TPBI.OFFIC_MAIL LIKE
                #officeMail#||'%'
            </isNotEmpty>
        </dynamic>
            ORDER BY KJ_NAME,JN_CARD,USERNAME
    </select>
    <!--JNTCIAttendanceLeave03.jsp 页面全选删除 的SQL语句 -->
    <delete id="JNTCIAttendance03DeleteTTLM" parameterClass="java.lang.String">
        delete from TT_LEAVE_MANAGER where LEAVE_ID=#deleteAllId#
    </delete>
    <delete id="JNTCIAttendance03DeleteTTAS" parameterClass="java.lang.String">
       delete from TT_AUDIT_STATUS where LEAVE_ID=#deleteAllId#
    </delete>
<update id="updatePowerByname"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
        UPDATE TT_SYS_USER
        SET  FL_FUNC_USE=#power#
        WHERE
         USER_ID=#usersId#
</update>



<select id="updateProjectByname2" parameterClass="java.lang.String"
        resultClass="java.lang.String" >
   select b.KJ_NAME as projectdutyname from
		TT_SYS_USER t
		left join
		 (select * from TT_CODE
		 where CD_KUBUN='SA') b
		on
		b.CD_CODE=t.PROJECT_ID
			WHERE t.user_id=#usersId#
    </select>
   <update id="updateProjectByname"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
		  UPDATE TT_SYS_USER
        SET  PROJECT_ID=#projectId#
        WHERE
          USER_ID=#usersId#
</update>

<update id="updateProjectByname1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
		  UPDATE TT_SYS_USER
       SET  PROJECT_PL =  #projectdutyname#
        WHERE
          USER_ID=#usersId#
</update>
    <delete id="deleteProjectByname"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
        delete from TT_CODE where
        CD_CODE=#projectId2#
    </delete>
     <update id="setProjectNull"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
          update TT_sys_user
          set project_id = null
          where project_id = #projectId2#
</update>


<select id="projectnamelist"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       select kj_name as proname1,cd_code as pro1 from tt_code where cd_kubun = 'S1'
    </select>
<select id="selectprojectusername" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
select concat(user_name,user_id) as nameandcard from tt_sys_user where project_id =#projectId1#
</select>

 <select id="selectAllUserEMail"  resultClass="java.lang.String">
        SELECT
        TPBI.JN_CARD || '=' || TPBI.OFFIC_MAIL || '@trans-cosmos.com.cn'
        FROM TT_PERSONAL_BASIC_INFO TPBI
        LEFT JOIN TT_CODE TC
        ON TC.CD_CODE = TPBI.DEPARTMENT
        ORDER BY JN_CARD
    </select>

    <delete id="deleteMeetiongRemark" >
    delete
    from
    TT_MEETING_REMARK
    where TO_DATE(END_TIME, 'yyyy-mm-dd hh24:mi:ss')
    &lt;
    LAST_DAY(trunc(add_months(sysdate,-2),'mm'))+23/24+2/48
    </delete>

    <select id="selectMailForCode"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingInquireInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIMeetingInquireOutput">
        SELECT JN_CARD as jn_card,USERNAME as user_name,START_TIME as start_time,TO_ID as to_id
        FROM TT_MEETING_REMARK
        WHERE ROOM_NO = #room_no#
        AND
        START_TIME = #start_time#
    </select>
    <select id="selectholiday"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        <!--  select HOLIDAYID,HOLIDAYNAME AS NAME,STARTHOLIDAYDATE,ENDHOLIDAYDATE  from TT_HOLIDAY_WRITE1 -->
         select  DISTINCT HOLIDAYNAME AS NAME
        from TT_HOLIDAY_WRITE1
        <!--select th.HOLIDAYID,th.HOLIDAYNAME as name,th.STARTHOLIDAYDATE,th.ENDHOLIDAYDATE,ths.DETAIL_DATE as detail_date
        from TT_HOLIDAY_WRITE1 th
        left   join TT_HOLIDAY_SWITCH ths
        on th.HOLIDAYID=ths.HOLIDAYID -->
    </select>
    <select id="selectholidayByName" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        select HOLIDAYID,HOLIDAYNAME AS NAME,STARTHOLIDAYDATE,ENDHOLIDAYDATE  from TT_HOLIDAY_WRITE1
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="name1">
                and HOLIDAYNAME = #name1#
            </isNotEmpty>
        </dynamic>
    </select>
    <select id="selectholidaycount" resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        select HOLIDAYNAME as name,STARTHOLIDAYDATE,ENDHOLIDAYDATE  from TT_HOLIDAY_WRITE1 where (STARTHOLIDAYDATE &lt;= #startyear# and ENDHOLIDAYDATE &gt; =#startyear#)or(STARTHOLIDAYDATE &lt; =#endyear#and ENDHOLIDAYDATE &gt; =#endyear#)
    </select>
    <select id="selectholidaynamecount" resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        select HOLIDAYNAME as name,
		   STARTHOLIDAYDATE,
		   ENDHOLIDAYDATE
	 from TT_HOLIDAY_WRITE1
	 Where
	         HOLIDAYNAME = #name2#
    </select>
     <select id="selectstartyear" resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
         select HOLIDAYNAME as name, STARTHOLIDAYDATE,
	         ENDHOLIDAYDATE,substr(STARTHOLIDAYDATE,1,4)as startyear
         from TT_HOLIDAY_WRITE1
         where  HOLIDAYNAME =#name2#
     </select>
     <select id="selectendyear" resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
         select HOLIDAYNAME as name, STARTHOLIDAYDATE,
	         ENDHOLIDAYDATE,substr(ENDHOLIDAYDATE,1,4) as endyear
         from TT_HOLIDAY_WRITE1
         where  HOLIDAYNAME = #name2#
     </select>
    <delete id="deleteholiday" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
    delete from TT_HOLIDAY_WRITE1 where HOLIDAYID=#holidayid#
    </delete>
    <delete id="deleteXDay" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
     delete from TT_HOLIDAY_SWITCH where HOLIDAYID=#holidayid#
     </delete>
    <select id="getholiday" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        select HOLIDAYNAME as name,STARTHOLIDAYDATE,ENDHOLIDAYDATE  from TT_HOLIDAY_WRITE1 where HOLIDAYID=#holidayid#
    </select>
    <update id="updateHolidayByID" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
       update TT_HOLIDAY_WRITE1 set HOLIDAYNAME=#name#,STARTHOLIDAYDATE=#startholidaydate#,ENDHOLIDAYDATE=#endholidaydate# where HOLIDAYID=#holidayid#
    </update>
    <select id="selectholidayTotalCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
        resultClass="java.lang.String">
        select COUNT(1) from TT_HOLIDAY_WRITE1
        <dynamic prepend="WHERE">
            1=1
            <isNotEmpty property="name1">
                and HOLIDAYNAME = #name1#
            </isNotEmpty>
        </dynamic>
    </select>
    <!-- ch end -->

    <delete id="deleteBusinessVerify" parameterClass="java.lang.String">
        DELETE FROM
        TT_EVECTION_DATA
        WHERE EVECTION_ID = #evectionId#
    </delete>

    <insert id="InsertWorkDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIImportDataInput">
        insert into TT_ATTENCE_MANAGER_TEMP(
        WORK_DATE,
        JN_CARD,
        CAR_DATE
        )values(
        #work_date#,
        #jn_card#,
        #car_date#

        )
    </insert>

    <select id="SelectCardDate"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceFileResultBean"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceResultBean">
        SELECT
              WORK_DATE as work_date,
              JN_CARD as jn_card,
             min(CAR_DATE) as start_date,
              max(CAR_DATE) as end_date
              FROM
        TT_ATTENCE_MANAGER_TEMP where WORK_DATE like '%'||#work_date# and JN_CARD = #jn_card#
            group by WORK_DATE,JN_CARD
    </select>

     <select id="SelectEmpNo"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIImportDataVO">
        SELECT distinct JN_CARD as jn_card FROM
        TT_ATTENCE_MANAGER_TEMP
        order by jn_card
    </select>


        <select id="SelectEmpDay"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIImportDataVO">
        SELECT work_date as work_date FROM
        TT_ATTENCE_MANAGER_TEMP
    </select>

<select id="SearchEmpInfo"
    parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceFileResultBean"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceResultBean">
    select USER_NAME as name,
    DEPT_ID as dept_id
    from tt_sys_user
    where user_id = #jn_card#
    </select>



<insert id="kaoqin"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceParamBean">
        INSERT INTO TT_ATTENCE_MANAGER (
        NAME,
        DEPT_ID,
        START_TIME,
        END_TIME,
         TIME_COUNT,
         IJYOU_FLAG,
         TOROKU_USER,
         TOROKU_TIMESTAMP,
         JN_CARD,
         HIDUKE,
         MONTH,
         COMELATE,
         LEAVE_EARLIER
        )VALUES(
        #name#,
        #dept_id#,
        #start_date#,
        #end_date#,
        #time_count#,
        #ijyou_flag#,
        #toroku_user#,
        #toroku_timestamp#,
        #jn_card#,
        #work_date#,
        #month#,
        #comelate#,
        #leave_earlier#
        )
    </insert>


        <select id="SelectAttenceInfoCount"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceParamBean"
        resultClass="java.lang.String">
        SELECT
             count(*)
              FROM
        TT_ATTENCE_MANAGER where HIDUKE = #work_date# and JN_CARD = #jn_card#
            group by HIDUKE,JN_CARD
    </select>
    <select id="selectmessage"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.form.JNTCIQueryFrom">
        SELECT
        attence.HIDUKE as work_date,
        attence.JN_CARD as jn_card,
        attence.NAME as name,
        code.kj_name as dept_id,
        attence.START_TIME as start_date,
        attence.END_TIME as end_date,
        attence.TIME_COUNT as time_count,
        attence.IJYOU_FLAG as ijyou_flag
        FROM
        TT_ATTENCE_MANAGER attence
        join
        tt_code code
        on attence.DEPT_ID = code.CD_CODE and code.CD_KUBUN = 'A1'
        order by jn_card asc，work_date asc
    </select>
    <select id="search001"
     parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOut">
        SELECT A.HIDUKE as work_date,
        A.JN_CARD as jn_card,
        A.NAME as name,
        A.DEPT_ID as dept_id,
        A.START_TIME as start_date,
        A.END_TIME as end_date,
        A.TIME_COUNT as time_count,
        A.IJYOU_FLAG as ijyou_flag
        ,B.EXTRA_TIME AS extra_time,
        B.EXTRA_TYPE as extra_type
         FROM
        TT_ATTENCE_MANAGER A LEFT JOIN TT_EXTRA_MANAGEMENT B ON A.JN_CARD = B.USER_ID
        WHERE A.JN_CARD=#JN_CARD#
    </select>

    <!--用来查询所有假期的SQL文-->
    <select id="holidaylist"
        resultClass="java.util.Date">
        SELECT to_date(DETAIL_DATE,'yyyy/MM/dd') as DETAIL_DATE
         FROM
         TT_HOLIDAY_SWITCH
    </select>

     <!-- 查询数据库中所有的节假日 -->
    <select id="detailDate" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
       SELECT  DISTINCT detail_date as detailDate
      FROM TT_HOLIDAY_SWITCH
    </select>
        <select id="detailDate1"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance03Dto">
       SELECT  DISTINCT detail_date as detailDate
      FROM TT_HOLIDAY_SWITCH
    </select>
    <insert id="addDay"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        INSERT INTO TT_HOLIDAY_SWITCH(
        HOLIDAYID,
       DETAIL_DATE
        )VALUES(
        #holidayid#,
        #xDay#
        )
    </insert>
       <delete id="deleteXDayByID" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        DELETE FROM
        TT_HOLIDAY_SWITCH
        WHERE HOLIDAYID = #holidayid#
    </delete>
    <select id="holidaytime"  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
        select holidayid,detail_date as xDay from TT_HOLIDAY_SWITCH where holidayid=#holidayid# order by detail_date
   </select>
   <select id="selectstartdate"  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
     resultClass="java.lang.String">
        select startholidaydate  from TT_HOLIDAY_WRITE1 where holidayid=#holidayid#
   </select>
   <select id="selectenddate"  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
   resultClass="java.lang.String">
        select endholidaydate  from TT_HOLIDAY_WRITE1 where holidayid=#holidayid#
   </select>
   <delete id="deleteholidaytime" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
     delete from TT_HOLIDAY_SWITCH where DETAIL_DATE=#xDay#
     </delete>
    <delete id="deleteholidaytime1" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput">
     delete from TT_HOLIDAY_WRITE1 where holidayid=#holidayid#
     </delete>
      <select id="selectxdaycount"  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.Winput"
     resultClass="java.lang.Integer">
       select count(1)  from TT_HOLIDAY_SWITCH  where holidayid=#holidayid#
   </select>

        <update id="CleanTemporaryTable">
      delete from TT_ATTENCE_MANAGER_TEMP
    </update>
    <update id="insertextraperson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_EXTRA_MANAGEMENT set
        EXAMINE_PERSON=#shencha#
        where EXTRA_ID=#extra_id#
    </update>
    <update id="updateextraperson"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_EXTRA_MANAGEMENT set
        EXAMINE_PERSON_GLB=#shencha#
        where EXTRA_ID=#extra_id#
    </update>
    <update id="updateextraperson1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput">
        update TT_EXTRA_MANAGEMENT set
        EXAMINE_PERSON_GLB=#userName#
        where EXTRA_ID=#extra_id#
    </update>
     <update id="updatemonth"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
        update TT_EXTRA_MANAGEMENT1 set
        IN_MONTH=#month#
        where EXTRA_ID=#extra_id#
    </update>
    <delete id="deletemonth" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCLOvertimeApplicationInput">
     delete from TT_EXTRA_MANAGEMENT1  where EXTRA_ID=#extra_id#
     </delete>
          <insert id="AddPower"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       insert into TT_CODE(CD_KUBUN,CD_CODE,KJ_NAME,TOROKU_USER,TOROKU_TIMESTAMP) values('A0',#quanxianid#,#quanxianname#,#userId#,#updatetime#)
    </insert>
    <select id="selectmax" resultClass="java.lang.String">
      select max(CD_CODE+1) from TT_CODE where CD_KUBUN='A0'
    </select>
    <insert id="AddProject"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       insert into TT_CODE(CD_KUBUN,CD_CODE,KJ_NAME,TOROKU_USER,TOROKU_TIMESTAMP) values('S1',#projectno#,#projectname#,#userId#,#updatetime#)
    </insert>

    <insert id="AddProjectfuzeren"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       insert into TT_CODE(CD_KUBUN,CD_CODE,KJ_NAME,TOROKU_USER,TOROKU_TIMESTAMP) values('SA',#projectno#,#projectdutyname#,#userId#,#updatetime#)
    </insert>

    <select id="selectprojectmax" resultClass="java.lang.String">
        select max(projectno) from
       (select TO_NUMBER(substr(CD_CODE,3)) AS projectno from TT_CODE where CD_KUBUN='S1')order
        by projectno desc
    </select>
        <select id="selectPower" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput" resultClass="java.lang.Integer">
       <!-- select KJ_NAME from JINANIMS.TT_CODE
       Where CD_KUBUN='A0' -->
       select count(1) from JINANIMS.TT_CODE
       Where KJ_NAME =#quanxianname#
       and CD_KUBUN ='A0'
    </select>
    <select id="selectProject" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput" resultClass="java.lang.Integer">
       <!-- select KJ_NAME from JINANIMS.TT_CODE
       Where CD_KUBUN='S1' -->
        select count(1) from JINANIMS.TT_CODE
       Where CD_KUBUN ='S1'
       and KJ_NAME = #projectname#
    </select>

          <select id="SerachPmCard"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select user_id  from tt_sys_user where user_name = #projectPm#
   </select>



      <select id="SerachPmEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select offic_mail  from tt_personal_basic_info where jn_Card = #jnCard#
   </select>

     <select id="SerachMyEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select offic_mail  from tt_personal_basic_info where jn_Card = #jnCard#
   </select>
<select id="selectusername" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
select
  TS.user_name as userName
  , TS.FL_FUNC_USE as power
  , TC.KJ_NAME as kj_name
  , TS.PROJECT_ID as projectId
  , TE.KJ_NAME as proname
from
  TT_SYS_USER TS
  left join TT_CODE TC
    on TS.FL_FUNC_USE = TC.CD_CODE  and tc.CD_KUBUN='A0'
  left join TT_CODE TE
    on TS.PROJECT_ID = TE.CD_CODE  and TE.CD_KUBUN='S1'
where
  (TC.CD_KUBUN = 'A0' and TS.USER_ID = #usersId#)
  or (TC.CD_KUBUN = 'S1' and TS.USER_ID = #usersId#)
</select>
    <select id="selectrolelist"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
      select CD_CODE as code_id,KJ_NAME as kj_name  from TT_CODE where CD_KUBUN='A0'
    </select>

    <!-- <select id="selectprojectlist"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
      select CD_CODE as pro,KJ_NAME as proname  from TT_CODE where CD_KUBUN='S1'
    </select> -->


     <select id="selectprojectlist"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
      <!--  select
  distinct  tc.CD_CODE as pro,tc.KJ_NAME as proname
   from TT_CODE tc
  where
   tc.CD_KUBUN='S1' -->


   select
  distinct  c1.CD_CODE as pro,(c1.KJ_NAME||'　　　'||c2.KJ_NAME) AS proname
   from TT_code c1 inner join TT_code c2
   on
   c1.CD_CODE = c2.CD_CODE
   where
   c1.CD_KUBUN = 'S1' and  c2.CD_KUBUN ='SA'
    </select>
     <select id="pmlist"
    resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       select
  user_id as userId,user_name as projectdutyname,concat(user_name,user_id) as concat
   from TT_SYS_USER order by userId


    </select>


<select id="selectid"  parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput"
   resultClass="java.lang.String">
      select count(1)  from TT_SYS_USER where USER_ID=#usersId#
    </select>

     <select id="SearchMyName"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select USER_NAME from TT_SYS_USER where USER_ID = #jnCard#
   </select>


<select id="SearchdaiyuzhenEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select OFFIC_MAIL from tt_personal_basic_info where jn_Card = '1070'
   </select>

<select id="SearchyuqiEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select OFFIC_MAIL from tt_personal_basic_info where jn_Card = '1072'
   </select>

<select id="SearchPlName"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select LEADER from TT_SYS_USER where USER_NAME = #examine_person#
   </select>

<select id="SearchPlId"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select USER_ID from TT_SYS_USER where USER_NAME = #plName#
   </select>

<select id="SearchPlEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select OFFIC_MAIL from tt_personal_basic_info where jn_Card = #plId#
   </select>

<select id="SearchManagerName"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
       select LEADER from TT_SYS_USER where USER_NAME = #plName#
   </select>
<select id="SearchManagerId"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
       select USER_ID from TT_SYS_USER where USER_NAME = #managerName#
   </select>
<select id="SearchManagerEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
       select OFFIC_MAIL from tt_personal_basic_info where jn_Card = #managerId#
   </select>
   <select id="SerachUserEmail"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select offic_mail  from tt_personal_basic_info where jn_Card = #userId#
   </select>
<insert id="leaveDetail" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIAttendanceVo">
        insert into TT_LEAVE_DETAIL(
        LEAVE_ID
        ,LEAVE_YMD
        ,LEAVE_START
        ,LEAVE_END
        ,LEAVE_COUNT
        ,LEAVE_TYPE
        )values(
        #LEAVE_ID#
        ,#LEAVE_YMD#
        ,#LEAVE_START#
        ,#LEAVE_END#
        ,#LEAVE_COUNT#
        ,#LEAVE_TYPE#
        )
   </insert>
   <!-- <insert id="newmessage"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
        INSERT INTO TT_SYS_USER( USER_NAME,USER_PASSWORD,USER_ID,PROJECT_ID,FL_FUNC_USE,PROJECT_PL)
        VALUES(#newaa#,
        #newaa#,
		 #newaa#,
        #newaa#,
		'6',
        #projectdutyname#)

    </insert>
 -->       <select id="SearchExamineCard"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select user_id  from TT_SYS_USER where user_name = #examine_person#
   </select>
   <select id="selecttype" parameterClass="java.lang.String"
        resultClass="java.lang.String" >
        select CD_CODE from TT_CODE WHERE KJ_NAME = #type# and CD_KUBUN = 'A5'
   </select>
   <delete id="deleteLeaveDetail" parameterClass="java.lang.String">
       delete from TT_LEAVE_DETAIL WHERE LEAVE_ID = #leave_id#
    </delete>
    <select id="SearchBossName"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select leader  from TT_SYS_USER where user_name = #leavePeopleName#
   </select>
   <!-- ============================================================================================ -->
     <select id="queryList"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryInput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOutput">
        SELECT
        D.TJ_CARD
        ,D.JN_CARD
        ,D.USERNAME
        ,TC.KJ_NAME AS KJ_NAME
        ,C.ENTRY_TIME
        ,C.OUT_TIME
        ,D.YM
        ,NVL(D.ACTUAL_DAYS,0) AS ACTUAL_DAYS
        ,NVL(D.EXTRA_TIME,0) AS EXTRA_TIME
        ,NVL(D.EXTRA_TIME_COUNT,0) AS EXTRA_TIME_COUNT
        ,NVL(D.WEEK_EXTRA_TIME,0) AS WEEK_EXTRA_TIME
        ,NVL(D.WEEK_EXTRA_TIME_COUNT,0) AS WEEK_EXTRA_TIME_COUNT
        ,NVL(D.HLD_EXTRA_TIME,0) AS HLD_EXTRA_TIME
        ,NVL(D.TIME_COUNT,0) AS TIME_COUNT
        ,NVL(D.KOJYO_TIME,0) AS KOJYO_TIME
        ,NVL(D.LEAVE_COUNT,0) AS LEAVE_COUNT
        ,NVL(D.LEAVE_COUNT1,0) AS LEAVE_COUNT1
        ,NVL(D.LEAVE_COUNT2,0) AS LEAVE_COUNT2
        ,NVL(D.LEAVE_COUNT3,0) AS LEAVE_COUNT3
        ,NVL(D.LEAVE_COUNT4,0) AS LEAVE_COUNT4
        ,NVL(D.LEAVE_COUNT5,0) AS LEAVE_COUNT5
        ,NVL(D.LEAVE_COUNT6,0) AS LEAVE_COUNT6
        ,NVL(D.LEAVE_COUNT7,0) AS LEAVE_COUNT7
        ,NVL(D.LEAVE_COUNT8,0) AS LEAVE_COUNT8
        ,NVL(D.LEAVE_COUNT9,0) AS LEAVE_COUNT9
        ,NVL(D.EVECTION_COUNT,0) AS EVECTION_COUNT
        ,NVL(D.IJYOU_FLAG,0) AS IJYOU_FLAG
        FROM TT_PERSONAL_BASIC_INFO C
        LEFT JOIN (
        SELECT
        TPB.TJ_CARD AS TJ_CARD
        ,TPB.JN_CARD AS JN_CARD
        ,TPB.USERNAME AS USERNAME
        ,TPB.YM AS YM
        ,TPB.ACTUAL_DAYS AS ACTUAL_DAYS
        ,TPB.EXTRA_TIME AS EXTRA_TIME
        ,TPB.EXTRA_TIME_COUNT AS EXTRA_TIME_COUNT
        ,TPB.WEEK_EXTRA_TIME AS WEEK_EXTRA_TIME
        ,TPB.WEEK_EXTRA_TIME_COUNT AS WEEK_EXTRA_TIME_COUNT
        ,TPB.HLD_EXTRA_TIME AS HLD_EXTRA_TIME
        ,TPB.TIME_COUNT AS TIME_COUNT
        ,TPB.KOJYO_TIME AS KOJYO_TIME
        ,TPB.LEAVE_COUNT AS LEAVE_COUNT
        ,TPB.LEAVE_COUNT1 AS LEAVE_COUNT1
        ,TPB.LEAVE_COUNT2 AS LEAVE_COUNT2
        ,TPB.LEAVE_COUNT3 AS LEAVE_COUNT3
        ,TPB.LEAVE_COUNT4 AS LEAVE_COUNT4
        ,TPB.LEAVE_COUNT5 AS LEAVE_COUNT5
        ,TPB.LEAVE_COUNT6 AS LEAVE_COUNT6
        ,TPB.LEAVE_COUNT7 AS LEAVE_COUNT7
        ,TPB.LEAVE_COUNT8 AS LEAVE_COUNT8
        ,TPB.LEAVE_COUNT9 AS LEAVE_COUNT9
        ,TPB.EVECTION_COUNT AS EVECTION_COUNT
        ,B.IJYOU_FLAG AS IJYOU_FLAG
        FROM(
        SELECT
        TPBIA.TJ_CARD AS TJ_CARD
        ,TPBIA.JN_CARD AS JN_CARD
        ,TPBIA.USERNAME AS USERNAME
        ,TPBIA.DEPARTMENT AS DEPARTMENT
        ,TPBIA.YM AS YM
        ,TPBIA.ACTUAL_DAYS AS ACTUAL_DAYS
        ,TPBIA.EXTRA_TIME AS EXTRA_TIME
        ,TPBIA.EXTRA_TIME_COUNT AS EXTRA_TIME_COUNT
        ,TPBIA.WEEK_EXTRA_TIME AS WEEK_EXTRA_TIME
        ,TPBIA.WEEK_EXTRA_TIME_COUNT AS WEEK_EXTRA_TIME_COUNT
        ,TPBIA.HLD_EXTRA_TIME AS HLD_EXTRA_TIME
        ,TPBIA.TIME_COUNT AS TIME_COUNT
        ,TPBIA.KOJYO_TIME AS KOJYO_TIME
        ,LEAVE.LEAVE_COUNT AS LEAVE_COUNT
        ,LEAVE1.LEAVE_COUNT AS LEAVE_COUNT1
        ,LEAVE2.LEAVE_COUNT AS LEAVE_COUNT2
        ,LEAVE3.LEAVE_COUNT AS LEAVE_COUNT3
        ,LEAVE4.LEAVE_COUNT AS LEAVE_COUNT4
        ,LEAVE5.LEAVE_COUNT AS LEAVE_COUNT5
        ,LEAVE6.LEAVE_COUNT AS LEAVE_COUNT6
        ,LEAVE7.LEAVE_COUNT AS LEAVE_COUNT7
        ,LEAVE8.LEAVE_COUNT AS LEAVE_COUNT8
        ,LEAVE9.LEAVE_COUNT AS LEAVE_COUNT9
        ,EVE.EVECTION_COUNT AS EVECTION_COUNT
        FROM
        (SELECT TPBI.TJ_CARD
        ,TPBI.JN_CARD
        ,TPBI.USERNAME
        ,TPBI.DEPARTMENT
        ,TA.ACTUAL_DAYS
        ,TA.EXTRA_TIME
        ,TA.EXTRA_TIME_COUNT
        ,TA.WEEK_EXTRA_TIME
        ,TA.WEEK_EXTRA_TIME_COUNT
        ,TA.HLD_EXTRA_TIME
        ,TA.YM
        ,TA.TIME_COUNT
        ,TA.KOJYO_TIME
        FROM TT_PERSONAL_BASIC_INFO TPBI
        LEFT JOIN
        ( SELECT * FROM (
        SELECT
        TAM.JN_CARD
        , COUNT(*) AS ACTUAL_DAYS
        ，SUM(TEM.EXTRA_TIME) AS
        EXTRA_TIME
        , COUNT(TEM1.EXTRA_TIME) AS EXTRA_TIME_COUNT
        ,
        SUM(TEM2.EXTRA_TIME) AS WEEK_EXTRA_TIME
        , COUNT(TEM3.EXTRA_TIME)
        AS WEEK_EXTRA_TIME_COUNT
        , SUM(TEM4.EXTRA_TIME) AS HLD_EXTRA_TIME
        , SUBSTR(TAM.HIDUKE,0,7) AS YM
        , SUM(TAM.TIME_COUNT) AS
        TIME_COUNT
        , SUM(TAI.KOJYO_TIME) AS KOJYO_TIME
        FROM
        TT_ATTENCE_MANAGER TAM
        LEFT JOIN TT_EXTRA_MANAGEMENT TEM
        ON
        TEM.USER_ID = TAM.JN_CARD
        AND TEM.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        TO_CHAR(EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &gt;= substr(TAM.START_TIME,0,16)
        AND TO_CHAR(EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &lt;= substr(TAM.END_TIME,0,16)
        AND TEM.EXTRA_TYPE = '1'
        LEFT JOIN
        TT_EXTRA_MANAGEMENT TEM1
        ON TEM1.USER_ID = TAM.JN_CARD
        AND
        TEM1.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(TEM1.EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        TO_CHAR(TEM1.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &gt;= substr(TAM.START_TIME,0,16)
        AND TO_CHAR(TEM1.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &lt;= substr(TAM.END_TIME,0,16)
        AND
        TO_NUMBER(TEM1.EXTRA_TIME) &gt;= 2.5
        AND TEM1.EXTRA_TYPE = '1'
        LEFT JOIN TT_EXTRA_MANAGEMENT TEM2
        ON TEM2.USER_ID = TAM.JN_CARD
        AND TEM2.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(TEM2.EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        TO_CHAR(TEM2.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &gt;= substr(TAM.START_TIME,0,16)
        AND TO_CHAR(TEM2.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &lt;= substr(TAM.END_TIME,0,16)
        AND TEM2.EXTRA_TYPE = '2'
        LEFT JOIN TT_EXTRA_MANAGEMENT TEM3
        ON TEM3.USER_ID = TAM.JN_CARD
        AND TEM3.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(TEM3.EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        TO_CHAR(TEM3.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &gt;= substr(TAM.START_TIME,0,16)
        AND TO_CHAR(TEM3.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &lt;= substr(TAM.END_TIME,0,16)
        AND
        TO_NUMBER(TEM3.EXTRA_TIME) &gt;= 5
        AND TEM3.EXTRA_TYPE IN
        ('2','3')
        LEFT JOIN TT_EXTRA_MANAGEMENT TEM4
        ON TEM4.USER_ID =
        TAM.JN_CARD
        AND TEM4.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(TEM4.EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        TO_CHAR(TEM4.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &gt;= substr(TAM.START_TIME,0,16)
        AND TO_CHAR(TEM4.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &lt;= substr(TAM.END_TIME,0,16)
        AND TEM4.EXTRA_TYPE = '3'
        LEFT JOIN TT_ADDSIGN_INFO TAI
        ON TAI.JN_CARD = TAM.JN_CARD
        AND
        (TO_CHAR(TAI.START_TIME_ADD,'YYYY/MM/DD') = TAM.HIDUKE or TO_CHAR(TAI.END_TIME_ADD,'YYYY/MM/DD') = TAM.HIDUKE)
        AND TAI.RETROACTIVE_STATUS = 'A06'
        GROUP BY TAM.JN_CARD
        ,SUBSTR(TAM.HIDUKE,0,7))
        WHERE YM = #ym# ) TA
        ON TPBI.JN_CARD =
        TA.JN_CARD) TPBIA
        LEFT JOIN (SELECT
        SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS
        LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN
        TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND
        TLM.LEAVE_STATUS IN ('A03','A10','A13')
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE
        ON LEAVE.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT
        SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS
        LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN
        TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND
        TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_TYPE IN
        ('AL1','AL10')
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE1
        ON LEAVE1.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT
        SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS
        LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN
        TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND
        TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_TYPE =
        'AL2'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE2
        ON LEAVE2.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS
        LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM
        TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON
        TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN
        ('A03','A10','A13')
        AND TLD.LEAVE_TYPE = 'AL3'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE3
        ON
        LEAVE3.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER
        TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_TYPE =
        'AL4'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE4
        ON LEAVE4.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS
        LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM
        TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON
        TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN
        ('A03','A10','A13')
        AND TLD.LEAVE_TYPE = 'AL5'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE5
        ON
        LEAVE5.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER
        TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_TYPE =
        'AL6'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE6
        ON LEAVE6.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS
        LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM
        TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON
        TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN
        ('A03','A10','A13')
        AND TLD.LEAVE_TYPE = 'AL7'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE7
        ON
        LEAVE7.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS LEAVE_YM,
        SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM TT_LEAVE_MANAGER
        TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_TYPE =
        'AL8'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE8
        ON LEAVE8.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN (SELECT SUBSTR(TLD.LEAVE_YMD,0,7) AS
        LEAVE_YM,SUM(TLD.LEAVE_COUNT) AS LEAVE_COUNT,TLM.JN_CARD
        FROM
        TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON
        TLM.LEAVE_ID = TLD.LEAVE_ID
        AND TLM.LEAVE_STATUS IN
        ('A03','A10','A13')
        AND TLD.LEAVE_TYPE = 'AL9'
        where SUBSTR(TLD.LEAVE_YMD,0,7) = #ym#
        GROUP BY SUBSTR(TLD.LEAVE_YMD,0,7), TLM.JN_CARD
        )LEAVE9
        ON
        LEAVE9.JN_CARD = TPBIA.JN_CARD
        LEFT JOIN(
        SELECT
        TED.USER_ID
        ,TEDT.EVECTION_YM
        ,SUM(TEDT.EVECTION_COUNT) AS EVECTION_COUNT
        FROM
        TT_EVECTION_DATA TED
        INNER JOIN
        TT_EVECTION_DETAIL TEDT
        ON
        TED.EVECTION_ID = TEDT.EVECTION_ID
        AND
        TED.EXAMINE_STATUS = 'A06'
        where TEDT.EVECTION_YM = #ym#
        GROUP BY TED.USER_ID,TEDT.EVECTION_YM
        )EVE
        ON EVE.USER_ID = TPBIA.JN_CARD
        )TPB
        LEFT JOIN (SELECT * FROM (
        SELECT JN_CARD, DECODE(COUNT(COUNT),0,0,1) AS IJYOU_FLAG, YM FROM(
        SELECT * FROM
        (SELECT A.JN_CARD, COUNT(A.COUNT) AS COUNT, A.YM
        FROM
        (SELECT TAM.JN_CARD, COUNT(*) AS COUNT, SUBSTR(HIDUKE,0,7) AS YM FROM
        TT_ATTENCE_MANAGER TAM
        LEFT JOIN TT_EXTRA_MANAGEMENT TEM5
        ON
        TEM5.USER_ID = TAM.JN_CARD
        WHERE TEM5.EXTRA_AUDITSS = 'A06'
        AND
        TO_CHAR(TEM5.EXTRA_ENDTIME,'YYYY/MM/DD') = TAM.HIDUKE
        AND
        (TO_CHAR(TEM5.EXTRA_STARTTIME,'YYYY/MM/DD HH24:MI') &lt;
        substr(TAM.START_TIME,0,16)
        OR TO_CHAR(TEM5.EXTRA_ENDTIME,'YYYY/MM/DD HH24:MI') &gt;
        substr(TAM.END_TIME,0,16))
        GROUP BY TAM.JN_CARD, SUBSTR(TAM.HIDUKE,0,7)

        ) A
        GROUP BY A.JN_CARD,A.YM
        )
        )
        GROUP BY JN_CARD,YM)
        WHERE YM = #ym#
        ) B
        ON TPB.JN_CARD = B.JN_CARD
        ) D
        ON C.JN_CARD = D.JN_CARD
        INNER JOIN TT_CODE TC
        ON TC.CD_KUBUN = 'A1'
        AND TC.CD_CODE = C.DEPARTMENT
        <dynamic prepend="WHERE ">
            <isGreaterThan prepend="and" property="ym" compareValue="0">
                SUBSTR(C.OUT_TIME,0,7) &gt;= #ym#
            </isGreaterThan>
            <isNotEmpty prepend="and" property="user_id">
                C.JN_CARD = #user_id#
            </isNotEmpty>
            <isNotEmpty property="user_name">
                and C.USERNAME like '%$user_name$%'
            </isNotEmpty>
        </dynamic>
        ORDER BY C.TJ_CARD
    </select>
    <select id="userListId" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOutput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOutput">
        SELECT * FROM(
        SELECT
            JN_CARD
            , HIDUKE AS YMD
        FROM TT_ATTENCE_MANAGER
        UNION
        SELECT JN_CARD
               ,LEAVE_YMD AS YMD
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        )
        <dynamic prepend="WHERE ">
            SUBSTR(YMD,0,7) = #ym#
            <isNotEmpty property="jn_card">
                and JN_CARD = #jn_card#
            </isNotEmpty>
        </dynamic>
        order by JN_CARD, YMD
    </select>
    <select id="timeListId" parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOutput"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIQueryOutput">
        <!-- SELECT * FROM(
        SELECT
            START_TIME AS STARTTIME
            , END_TIME AS ENDTIME
        FROM TT_ATTENCE_MANAGER
        WHERE JN_CARD = #jn_card#
        AND HIDUKE = #ymd#
        UNION ALL
        SELECT
            LEAVE_START AS STARTTIME
            , LEAVE_END AS ENDTIME
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        WHERE TLM.JN_CARD = #jn_card#
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_YMD = #ymd#
        )
        ORDER BY STARTTIME,ENDTIME -->
        SELECT * FROM (SELECT * FROM(
        SELECT
            START_TIME AS STARTTIME
            , END_TIME AS ENDTIME
        FROM TT_ATTENCE_MANAGER
        WHERE JN_CARD = #jn_card#
        AND HIDUKE = #ymd#
        UNION ALL
        SELECT
            LEAVE_START AS STARTTIME
            , LEAVE_END AS ENDTIME
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        WHERE TLM.JN_CARD = #jn_card#
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_YMD = #ymd#
        )
        ORDER BY STARTTIME,ENDTIME) A
        WHERE NOT EXISTS(
           SELECT * FROM (SELECT * FROM(
        SELECT
            START_TIME AS STARTTIME
            , END_TIME AS ENDTIME
        FROM TT_ATTENCE_MANAGER
        WHERE JN_CARD = #jn_card#
        AND HIDUKE = #ymd#
        UNION ALL
        SELECT
            LEAVE_START AS STARTTIME
            , LEAVE_END AS ENDTIME
        FROM TT_LEAVE_MANAGER TLM
        INNER JOIN TT_LEAVE_DETAIL TLD
        ON TLM.LEAVE_ID = TLD.LEAVE_ID
        WHERE TLM.JN_CARD = #jn_card#
        AND TLM.LEAVE_STATUS IN ('A03','A10','A13')
        AND TLD.LEAVE_YMD = #ymd#
        )
        ORDER BY STARTTIME,ENDTIME) B
           WHERE A.STARTTIME &gt; B.STARTTIME AND A.ENDTIME &lt; B.ENDTIME
        )
        ORDER BY STARTTIME,ENDTIME
    </select>
    <select id="vocationDetail" parameterClass="java.lang.String"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationVo" >
        SELECT
           NVL(JANUARY,0) AS JANUARY
           ,NVL(FEBRUARY,0) AS FEBRUARY
           ,NVL(MARCH,0) AS MARCH
           ,NVL(APRIL,0) AS APRIL
           ,NVL(MAY,0) AS MAY
           ,NVL(JUNE,0) AS JUNE
           ,NVL(JULY,0) AS JULY
           ,NVL(AUGUST,0) AS AUGUST
           ,NVL(SEPTEMBER,0) AS SEPTEMBER
           ,NVL(OCTORBER,0) AS OCTORBER
           ,NVL(NOVEMBER,0) AS NOVEMBER
           ,NVL(DECEMBER,0) AS DECEMBER
        FROM TT_VOCATION
        WHERE USER_ID = #userId#
    </select>
    <update id ="alterVocation" parameterClass ="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationVo">
        update
        TT_VOCATION
        set
        REMAIN_DAYS = #remain_days#,
        JANUARY = #january#,
        FEBRUARY = #february#,
        MARCH = #march#,
        APRIL = #april#,
        MAY = #may#,
        JUNE = #june#,
        JULY = #july#,
        AUGUST = #august#,
        SEPTEMBER = #september#,
        OCTORBER = #octorber#,
        NOVEMBER = #november#,
        DECEMBER = #december#
        where
        USER_ID = #USER_ID#
    </update>
     <select id="nianxiu"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.vo.JNTCIVocationVo" >
        SELECT
           USER_ID
           ,NVL(REMAIN_DAYS,0) AS REMAIN_DAYS
           ,NVL(JANUARY,0) AS JANUARY
           ,NVL(FEBRUARY,0) AS FEBRUARY
           ,NVL(MARCH,0) AS MARCH
           ,NVL(APRIL,0) AS APRIL
           ,NVL(MAY,0) AS MAY
           ,NVL(JUNE,0) AS JUNE
           ,NVL(JULY,0) AS JULY
           ,NVL(AUGUST,0) AS AUGUST
           ,NVL(SEPTEMBER,0) AS SEPTEMBER
           ,NVL(OCTORBER,0) AS OCTORBER
           ,NVL(NOVEMBER,0) AS NOVEMBER
           ,NVL(DECEMBER,0) AS DECEMBER
        FROM TT_VOCATION
    </select>
   <select id="over_work_select"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput" >
        select EXTRA_ID,
        USER_ID,
        USER_NAME,
        PROJECT,
        DEPT_ID,
        EXTRA_TYPE,
        EXTRA_TIME,
        to_char(EXTRA_STARTTIME,'yyyy-mm-dd hh24:mi') as EXTRA_STARTTIME,
        to_char(EXTRA_ENDTIME,'yyyy-mm-dd hh24:mi') as EXTRA_ENDTIME,
        EXTRA_REASON,
        LEADER,
        EXTRA_AUDITSS,
        EXAMINE_PERSON as examinePerson
        FROM TT_EXTRA_MANAGEMENT
        WHERE EXTRA_ID=#extra_id#
    </select>
    <select id="mailsearch"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIOverTimeVerifyResultInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         JN_CARD=#user_id#
    </select>
     <!--获取leave_id所对应的审查状态  -->
     <select id="admit_leader_es" parameterClass="java.lang.String"
        resultClass="java.lang.String" >
    SELECT
    EXAMINE_STATUS
    FROM
    TT_AUDIT_STATUS
    WHERE
    LEAVE_ID = #leave_id#
    </select>
     <!--获取leave_id所对应的审查状态  -->
     <select id="admit_leader_lt" parameterClass="java.lang.String"
        resultClass="java.lang.String" >
    SELECT
    LEAVE_TOTALTIME
    FROM
    TT_LEAVE_MANAGER
    WHERE
    LEAVE_ID = #leave_id#
    </select>
    <select id="admit_leader_ltT" parameterClass="java.lang.String"
        resultClass="java.lang.String" >
    SELECT
    LEAVE_TYPE
    FROM
    TT_LEAVE_MANAGER
    WHERE
    LEAVE_ID = #leave_id#
    </select>
    <!--更新审查状态到 TT_AUDIT_STATUS表 -->
      <update id="update_admit_leader_ttas"  >
    UPDATE TT_AUDIT_STATUS
    SET EXAMINE_STATUS = #examineStatus#,
    EXAMINE_TIME =
    TO_CHAR(SYSDATE,'yyyy/MM/DD'),
    EXAMINE_PERSON=#userName#
    WHERE
    LEAVE_ID = #leaveId#
    </update>
     <!--更新审查状态到 TT_LEAVE_MANAGER表 -->
     <update id="update_admit_leader_ttlm"  >
    UPDATE TT_LEAVE_MANAGER
    SET LEAVE_STATUS = #examineStatus#
    WHERE
    LEAVE_ID = #leaveId#
    </update>

<select id="selectbegintime" parameterClass="java.lang.String"  resultClass="java.lang.String" >
     SELECT
     to_char(LEAVE_STARTTIME,'yyyy-mm-dd hh24:mi') as LEAVE_STARTTIME
    FROM
    TT_LEAVE_MANAGER
    WHERE
    LEAVE_ID = #leave_id#
    </select>

<select id="selectendtime" parameterClass="java.lang.String"  resultClass="java.lang.String" >
     SELECT
      to_char(LEAVE_ENDTIME,'yyyy-mm-dd hh24:mi') as LEAVE_ENDTIME
    FROM
    TT_LEAVE_MANAGER
    WHERE
    LEAVE_ID = #leave_id#
    </select>
<update id="updateLeavemenageDetail" parameterClass="java.lang.String" >
    UPDATE TT_LEAVE_MANAGER
    SET LEAVE_STATUS = 'A04'

    WHERE
    LEAVE_ID = #leaveId#
    </update>

     <select id="AgreeExamineStatus"
        resultClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance04selectInfo">
    select * from TT_AUDIT_STATUS  join TT_CODE on TT_AUDIT_STATUS.EXAMINE_STATUS = TT_CODE.CD_CODE join TT_LEAVE_MANAGER on TT_LEAVE_MANAGER.LEAVE_ID =TT_AUDIT_STATUS.LEAVE_ID
     where  TT_CODE.CD_KUBUN = 'B2'
        AND (TT_CODE.CD_CODE='A03'  or TT_CODE.CD_CODE='A10'  or TT_CODE.CD_CODE='A13')
    </select>
    <select id="namename" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
SELECT count(*) FROM TT_ADDSIGN_INFO
where TENPU_PATH = #fileName#
    </select>

    <select id="evectionInfo"
    parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttenceParamBean"
    resultClass="java.lang.Integer">
   select
   count(1)
   from
    tt_evection_data
    where
    #work_date#
    between
    EVECTION_STARTTIME
    and  EVECTION_ENDTIME
    and
    USER_ID =#jn_card#
    and EXAMINE_STATUS ='A06'
    </select>
 <select id="emailMessage"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
    JN_CARD=#JN_CARD#
    </select>
    <select id="emailMessage1"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#leader#
    </select>
    <select id="emailMessage2"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAttendance06Input"
        resultClass="java.lang.String">
        SELECT  OFFIC_MAIL
        FROM
        TT_PERSONAL_BASIC_INFO  where
         USERNAME=#leader#
    </select>
 <select id="selectperson"   parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCIAddsignInfoInput"
            resultClass="java.lang.String">
       select LEADER
        FROM TT_SYS_USER
        where USER_NAME=#userName#
        </select>
        <select id="daiyuzhenName"  parameterClass="java.lang.String"
   resultClass="java.lang.String">
        select username from tt_personal_basic_info where jn_Card = '1070'
   </select>
<insert id="AddProjectdutyname"
        parameterClass="jp.terasoluna.thin.tutorial.web.transcosmos.dto.JNTCISuperButtonInput">
       update TT_SYS_USER set
        PROJECT_PL=#projectdutyname#
        where PROJECT_ID=(SELECT CD_CODE FROM TT_CODE WHERE KJ_NAME =#projectname# )
    </insert>
    <select id="codevaluelist" resultClass="java.lang.String">
      select cd_code from TT_CODE where CD_KUBUN='S1'
    </select>

</sqlMap>
